(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-e688","chunk-e347","chunk-e78f","chunk-3c8e","chunk-2cf3"],{"+2MK":function(t,e,i){},"+9np":function(t,e,i){"use strict";var a=i("Qf6f");i.n(a).a},"+9th":function(t,e,i){"use strict";i.d(e,"p",function(){return s}),i.d(e,"n",function(){return n}),i.d(e,"a",function(){return o}),i.d(e,"h",function(){return l}),i.d(e,"j",function(){return c}),i.d(e,"l",function(){return r}),i.d(e,"m",function(){return d}),i.d(e,"u",function(){return u}),i.d(e,"s",function(){return m}),i.d(e,"f",function(){return h}),i.d(e,"d",function(){return p}),i.d(e,"k",function(){return f}),i.d(e,"g",function(){return v}),i.d(e,"q",function(){return g}),i.d(e,"t",function(){return b}),i.d(e,"r",function(){return y}),i.d(e,"o",function(){return w}),i.d(e,"e",function(){return _}),i.d(e,"b",function(){return C}),i.d(e,"c",function(){return A}),i.d(e,"i",function(){return I});var a=i("t3Un");function s(t){return Object(a.a)({url:"oa/task/subTaskList",method:"post",data:t})}function n(t){return Object(a.a)({url:"oa/task/myTask",method:"post",data:t})}function o(t){return Object(a.a)({url:"oa/task/save",method:"post",data:t})}function l(t){return Object(a.a)({url:"oa/task/delete",method:"post",data:t})}function c(t){return Object(a.a)({url:"oa/task/read",method:"post",data:t})}function r(t){return Object(a.a)({url:"oa/task/update",method:"post",data:t})}function d(t){return Object(a.a)({url:"oa/task/updateName",method:"post",data:t})}function u(t){return Object(a.a)({url:"oa/task/updateStoptime",method:"post",data:t})}function m(t){return Object(a.a)({url:"oa/task/updateOwner",method:"post",data:t})}function h(t){return Object(a.a)({url:"oa/task/updateLable",method:"post",data:t})}function p(t){return Object(a.a)({url:"oa/tasklable/save",method:"post",data:t})}function f(t){return Object(a.a)({url:"oa/tasklable/update",method:"post",data:t})}function v(t){return Object(a.a)({url:"oa/tasklable/delete",method:"post",data:t})}function g(t){return Object(a.a)({url:"oa/tasklable/index",method:"post",data:t})}function b(t){return Object(a.a)({url:"oa/task/updatePriority",method:"post",data:t})}function y(t){return Object(a.a)({url:"oa/task/taskOver",method:"post",data:t})}function w(t){return Object(a.a)({url:"oa/task/readLoglist",method:"post",data:t})}function _(t){return Object(a.a)({url:"oa/task/delOwnerById",method:"post",data:t})}function C(t){return Object(a.a)({url:"oa/taskcomment/save",method:"post",data:t})}function A(t){return Object(a.a)({url:"oa/taskcomment/delete",method:"post",data:t})}function I(t){return Object(a.a)({url:"oa/task/delrelation",method:"post",data:t})}},"+NTD":function(t,e,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("ooHJ"),o=i("7Qib"),l={name:"RelativeReturnMoney",components:{CRMCreateView:s.default,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))}},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},detail:{type:Object,default:function(){return{}}},isSeas:{type:Boolean,default:!1}},data:function(){return{list:[],fieldList:[],tableHeight:"250px",showFullDetail:!1,showFullCrmType:"receivables",showFullId:"",createCrmType:"receivables_plan",isCreate:!1,palnList:[],planFieldList:[],createActionInfo:{}}},computed:{},watch:{id:function(t){this.list=[],this.palnList=[],this.getList(),this.getPlanList()}},mounted:function(){this.planFieldList=[{prop:"num",width:"200",label:"期数"},{prop:"customer_id",width:"200",label:"客户名称"},{prop:"contract_id",width:"200",label:"合同编号"},{prop:"money",width:"200",label:"计划回款金额"},{prop:"return_date",width:"200",label:"计划回款日期"},{prop:"return_type",width:"200",label:"计划回款方式"},{prop:"remind",width:"200",label:"提前几日提醒"},{prop:"remark",width:"200",label:"备注"}],this.getPlanList(),this.fieldList=[{prop:"number",width:"200",label:"回款编号"},{prop:"contract_id",width:"200",label:"合同名称"},{prop:"contract_money",width:"200",label:"合同金额"},{prop:"money",width:"200",label:"回款金额"},{prop:"plan_id",width:"200",label:"期数"},{prop:"owner_user_id",width:"200",label:"负责人"},{prop:"check_status",width:"200",label:"状态"},{prop:"return_time",width:"200",label:"回款日期"}],this.getList()},methods:{getPlanList:function(){var t=this;this.loading=!0,Object(n.e)(this.getParams()).then(function(e){t.loading=!1,t.palnList=e.data.list}).catch(function(){t.loading=!1})},getList:function(){var t=this;this.loading=!0,Object(n.c)(this.getParams()).then(function(e){t.loading=!1,t.list=e.data.list}).catch(function(){t.loading=!1})},getParams:function(){return"customer"===this.crmType?{customer_id:this.id,pageType:"all"}:"contract"===this.crmType?{contract_id:this.id,pageType:"all"}:{}},handleRowClick:function(t,e,i){this.showFullId=t.receivables_id,this.showFullCrmType="receivables",this.showFullDetail=!0},cellStyle:function(t){t.row,t.column,t.rowIndex;return 1==t.columnIndex?{color:"#3E84E9"}:{textAlign:"center"}},createClick:function(t){this.createActionInfo={type:"relative",crmType:this.crmType,data:{}},"money"==t?("contract"===this.crmType?(this.createActionInfo.data.customer=this.detail.customer_id_info,this.createActionInfo.data.contract=this.detail):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables",this.isCreate=!0):"plan"==t&&("contract"===this.crmType?(this.createActionInfo.data.customer=this.detail.customer_id_info,this.createActionInfo.data.contract=this.detail):"customer"===this.crmType&&(this.createActionInfo.data.customer=this.detail),this.createCrmType="receivables_plan",this.isCreate=!0)},saveSuccess:function(){"receivables"==this.createCrmType?this.getList():this.getPlanList()},handleFile:function(t,e){var i=this;"edit"==t?(this.createActionInfo={type:"update",id:e.row.plan_id},this.createCrmType="receivables_plan",this.isCreate=!0):"delete"==t&&this.$confirm("您确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)({id:e.row.plan_id}).then(function(t){i.palnList.splice(e.$index,1),i.$message.success(t.data)}).catch(function(){})}).catch(function(){i.$message({type:"info",message:"已取消操作"})})},fieldFormatter:function(t,e,i){return"contract_id"===e.property?t.contract_id_info.name:"customer_id"===e.property?t.customer_id_info.name:"create_time"===e.property?Object(o.n)(t.customer_id_info.create_time):"owner_user_id"===e.property?t.owner_user_id_info.realname:"plan_id"===e.property?t.plan_id_info:"check_status"===e.property?this.getStatusName(t.check_status):["contract_money","money",""].includes(e.property)?Object(o.h)(i):t[e.property]},getStatusName:function(t){return t>5?"":["待审核","审核中","审核通过","已拒绝","已撤回","未提交"][t]},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},c=(i("GE8g"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rc-cont"},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("plan")}}},[t._v("新建回款计划")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.palnList,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""}},[t._l(t.planFieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("flexbox",{attrs:{justify:"center"}},[i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("edit",e)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{type:"text"},nativeOn:{click:function(i){t.handleFile("delete",e)}}},[t._v("删除")])],1)]}}])})],2),t._v(" "),i("flexbox",{staticClass:"rc-head",staticStyle:{"margin-top":"15px"},attrs:{direction:"row-reverse"}},[t.isSeas?t._e():i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.createClick("money")}}},[t._v("新建回款")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.showFullCrmType,id:t.showFullId},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{"crm-type":t.createCrmType,action:t.createActionInfo},on:{"save-success":t.saveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"387dc8e0",null);r.options.__file="RelativeReturnMoney.vue";e.a=r.exports},"+gwU":function(t,e,i){"use strict";var a=i("rWf7");i.n(a).a},"+xXq":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJGMjBEQTUzNDE2NTExRTlBNTYyRkQzQzcyQzU1QTdEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJGMjBEQTU0NDE2NTExRTlBNTYyRkQzQzcyQzU1QTdEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkYyMERBNTE0MTY1MTFFOUE1NjJGRDNDNzJDNTVBN0QiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkYyMERBNTI0MTY1MTFFOUE1NjJGRDNDNzJDNTVBN0QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7hCk5DAAACAElEQVR42qSV20tUURTGv33GxgtjD0beGtBw8tKLoE/2VxiakC8i5IsYaFAm9qykE/qgIPog2JNKOhH9F0aUPoiNYGJOIEEQNjbmnL7NrMOc2+DkLPjBOXvv9Z211157HXUx0gsfC5JOoYPUkhQ5Ih/JJnkrYw4r8hG7T6ZIxOcjzcJDEiejZMO+yLA9B8hLWRDB5abXvBGfgF+EE+QZ/t8sn1F7hN0eseISqMFxGM+jXBXIR7TbEtS5mXFmKwjj0VOoyF0gVA7cqMzCD+WwWe2pt/yAhO0zqm8YaGjOvJSFYIxFna4HX5COvQYO9+2jt0iPIaXhMFVVm305SwLJ0yx/z4H6OzAGXzCMerdrp2IdHvChzjFcHabDOLd7Heb2FszlGUc6VM8AVNs9mLufYC5O2T2/6girPdn4foT0wiRw+guqpRW4FszOpVIwN1cyO7nd5PasKZJqL/aIHh8i/YpRlpQC564LEZBqM0343ZQEKfc9t58/vGMVN6G6+jN6e9vu2YQW/Ewa3TPGxBKjK8tdecnfMN+vuUe3tGDMKsq87M8ZI9uh2CpwknDPxvQp64zvu2vxCvaNNBhyKE9QuI3o+K27vE6mCxCbFg1H+xojc1cQmxdfTz+8II/lgOJ5CMWlDwyJb86OrZvmO1msu3e7XHwr8R/kF7Du9wv4J8AAdbF+5wQ+l40AAAAASUVORK5CYII="},"/4q4":function(t,e,i){},"/U9q":function(t,e,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("qbf4"),o=i("mkuN"),l={name:"RelativeContacts",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default,CrmRelative:o.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contactsId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customer_id:function(){return this.detail.customer_id},canRelation:function(){return"business"==this.crmType}},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(t){var e=this;if(t.data.length>0){var i={is_relation:1};i[this.crmType+"_id"]=this.id,i.contacts_id=t.data.map(function(t){return t.contacts_id}),Object(n.g)(i).then(function(t){e.getDetail(),e.$message.success(t.data)}).catch(function(){})}},unRelevanceHandleClick:function(){var t=this;0==this.selectionList.length?this.$message.error("请先勾选数据"):this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={is_relation:0};e[t.crmType+"_id"]=t.id,e.contacts_id=t.selectionList.map(function(t){return t.contacts_id}),Object(n.g)(e).then(function(e){t.getDetail(),t.$message.success(e.data)}).catch(function(){})}).catch(function(){t.$message.info("已取消操作")})},getFieldList:function(){this.fieldList.push({prop:"name",width:"200",label:"姓名"}),this.fieldList.push({prop:"mobile",width:"200",label:"手机"}),this.fieldList.push({prop:"post",width:"200",label:"职务"})},getDetail:function(){var t=this;this.loading=!0;var e={pageType:"all"};e[this.crmType+"_id"]=this.id,Object(n.e)(e).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},handleRowClick:function(t,e,i){this.contactsId=t.contacts_id,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"customer"==this.crmType?this.createActionInfo.data.customer=this.detail:"business"==this.crmType&&(this.createActionInfo.data.customer=this.detail.customer_id_info),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},c=(i("ixqQ"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("新建联系人")]),t._v(" "),t.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.unRelevanceHandleClick(e)}}},[t._v("解除关联")]):t._e(),t._v(" "),t.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:t.showRelativeView,radio:!1,action:{type:"condition",data:{form_type:"customer",customer_id:t.customer_id}},"selected-data":{contacts:t.list},"crm-type":"contacts"},on:{close:function(e){t.showRelativeView=!1},changeCheckout:t.checkRelativeInfos},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}}),t._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(e){t.showRelativeView=!0}},slot:"reference"},[t._v("关联")])],1):t._e()],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":function(e){t.selectionList=e}}},[t.canRelation&&t.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):t._e(),t._v(" "),t._l(t.fieldList,function(t,e){return i("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,"show-overflow-tooltip":""}})})],2),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.contactsId,"crm-type":"contacts"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"contacts"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"eb29b296",null);r.options.__file="RelativeContacts.vue";e.a=r.exports},"/tO9":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjYxNjIwRDQ3REQ3QjExRTg4NjM2OTZBMUM0RjRERUZEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjYxNjIwRDQ4REQ3QjExRTg4NjM2OTZBMUM0RjRERUZEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NjE2MjBENDVERDdCMTFFODg2MzY5NkExQzRGNERFRkQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjE2MjBENDZERDdCMTFFODg2MzY5NkExQzRGNERFRkQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7EGosnAAAEw0lEQVR42uxY3WtcRRQ/M3e/stlsdpPtbrPZfGzaFyUmaUsFBfuiiGCxIhUp/gelvkkLheJLIPbBB18EH1TwQdQHQasIivSlSiOkNEJKGs1HU5M0n93dbDa72Xtn/M3czTbdJO3GZNcgHbjcy8y9M785v3N+58xlUkraj43TPm37FpijtGPlwtn/BEjt5Y/+B1Qa7YfaeCh8g7ncJjEmmdeb5ZGmK0b8sLf4TlvHEVbnTxDnkgcbJzDWsHGMNzV/YcRaL+yayg2gWsTszG25mnGv98lMxo3rJPP5ZwDgkDX+14JMp76Uy6l6NS7uL7Zxt/szPJ4CqGPW9N3fKZ9Xmz+DDb2A+U7uGphML3+rQLFaHzmeeoaYr47E0iJZt4cwlvJLj+dHvHZc5k3bQk4XUX6NyLLC+vtc7rwGVeiXycTLe0KlTCW7NPKnu4j5YRDOiYcOkKOzW4+LZOKonsDv/xA026CcLslqvO+pfuYwbugXVb9qbs+iZqK1/TTmuQkL/mS0d0R2brH8mqEXgMU2NtBoP1im3pT192Sv0Rb/VZrmi8xT87k1OjJS6L+MxU9ggy+Ry5XkgeBrFAx2ov9rMk2m5wo0DOAW2xEwVlOTUz4llhZgqXCxX9ybtse9tWnQbWO8M34Vt6ulc8CnXtUPqxmykoiP5pY+DWqd3lSiecdUsrr6n/WiI7eUf2AVi8T0XTL/HLbH/YGPNwdMRwRBE0dg+Lec0+H8gbhRpBfWX9gxlbDIGXw4pRw9P3D94d2EwgPM7b4IC/RSdvVNOHpU5rK11sQYsz9myuJ5uMEt5vVdsibHr9iWHbtmxNrOyZX0eTKMOYy/baUSW69fmsQ3Kj92HgZd34vE0jFEG4djp1l98BPmcn4q5mb7ZWbF87DJYA3GtXVJCFoHyRtDg2DgBOQlVa7yOx4VsphoDrdniwGxktYXb2gcVaBgFeLRFuLBBljIa0uGflEquSExM0XQMhIL890st6bEtxVzpnelY9sKb/wwBzVx/XHPcRvQJh5AZZ2fDFxQfjIHB0guJ4PS7b6G0Z5KVRch0MoUbVuC2hREfnJ0HdFgxeJ8t9Eaf6UiwBS9yJ0WwGlay2mIYOIHozbFmfT7FavHYAVbRCdGy3eB5hbb/ZZTnZUD5vO9o6iEgBKUvszNIK05nSqHGtC7nooAg9L/wiPRD5TfQJvI/AOZxcw/Bhl74JOWOFqx0hpZ4F3QcxFWkJADyg/0P0jY22EryIkUormiNT8Scp8RjT2PLJFVgWAOD5XtchU/jIDW6zwceY4cDinmZx8ZqbJAN1hdrcopCTnyJvcHdIiqamTbli/4Iedj1Tu+OZ139H1tGz9TGpbNFlY1fqseMCE8xUS+Fa7lpE7uiMwc9G+qasBQ8XbYBebWaUrM3qNCRTxc3ZN4JhMuCmkp6LWcrjLsOs/bVzVg6iyJxQ11YMHCpRSTNTSoTk+qxp+2Jie+qhowJPYlcjilBoFMgFpNZwIVoar6FfeXVHAIXh94Y9fnyh0f6UMHvsNB5ZTKnaX5k7k9Jo8cfAug+6v+twegXjdirZdYIDit6n1lQTj6ivqlwJuiMVD4zZ78IviXKaoXt96NSl9uzfbYw8iTH3dPgO1x+0eAAQCRmhBZ73XjTwAAAABJRU5ErkJggg=="},"1RnH":function(t,e,i){"use strict";var a=i("QbLZ"),s=i.n(a),n=i("+9th"),o=i("mkuN"),l=i("Er7M"),c=i("7Qib"),r=i("L2JU"),d={components:{CrmRelative:o.a,RelatedBusinessCell:l.a},props:{marginLeft:{type:String,default:"20px"},allData:{type:Object,default:function(){return{contacts:[],customer:[],business:[],contract:[]}}},isTask:{type:Boolean,default:!1},taskID:Number,alterable:{type:Boolean,default:!0},alterableColor:{type:String,default:"#999"}},data:function(){return{showTypes:["customer","contacts","business","contract"],showPopover:!1,relevanceAll:{customer_ids:[],contract_ids:[],contacts_ids:[],business_ids:[]},relatedListData:{},showRelative:!1,showTaskRelative:!1}},computed:s()({},Object(r.b)(["crm"]),{showCRMPermission:function(){return this.crm}}),watch:{allData:function(){this.relatedListData=this.allData}},mounted:function(){this.relatedListData=this.allData},methods:{crmrelativeClose:function(){this.showPopover=!1},checkInfos:function(t){var e=this;this.showPopover=!1,this.relatedListData=t.data;var i=function(i){var a=t.data[i];e.relevanceAll[i+"_ids"]=a.map(function(t,e,a){return t[i+"_id"]})};for(var a in t.data)i(a);this.$emit("checkInfos",this.relevanceAll)},delRelevance:function(t,e,i){var a=this;this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"is-particulars"}).then(function(){Object(n.i)({task_id:a.taskID,type:{customer:1,contacts:2,business:3,contract:4}[t],id:i[t+"_id"]}).then(function(i){a.relatedListData[t].splice(e,1),a.relatedListData=Object(c.i)(a.relatedListData),a.$message.success("关联取消成功")}).catch(function(){})}).catch(function(){a.$message.info("已取消操作")})},checkRelatedDetail:function(t,e){e.key=e[t+"_id"],this.$emit("checkRelatedDetail",t,e)}}},u=(i("GsUu"),i("KHd+")),m=Object(u.a)(d,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"related-business",style:{"margin-left":t.marginLeft}},[!t.isTask&&t.alterable?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showRelative?a("crm-relative",{ref:"crmrelative",attrs:{show:t.showPopover,radio:!1,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")]):t._e()],1):t._e(),t._v(" "),t.alterable?t._e():a("p",{staticClass:"alterable-p",style:{color:t.alterableColor}},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,i){return a("div",{key:i},t._l(e,function(e,s){return a("related-business-cell",{key:s,attrs:{data:e,"cell-index":s,type:i,"show-foot":t.isTask},on:{unbind:t.delRelevance,detail:function(a){t.checkRelatedDetail(i,e)}}})}))}),t._v(" "),t.isTask?a("el-popover",{attrs:{placement:"bottom",width:"800","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showPopover,callback:function(e){t.showPopover=e},expression:"showPopover"}},[t.showTaskRelative?a("crm-relative",{ref:"crmrelative",attrs:{radio:!1,show:t.showPopover,"selected-data":t.relatedListData,"show-types":t.showTypes},on:{close:t.crmrelativeClose,changeCheckout:t.checkInfos}}):t._e(),t._v(" "),t.showCRMPermission?a("p",{staticClass:"add-file",attrs:{slot:"reference"},on:{click:function(e){t.showTaskRelative=!0}},slot:"reference"},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n      关联业务\n    ")]):t._e()],1):t._e()],2)},[],!1,null,"8253b738",null);m.options.__file="relatedBusiness.vue";e.a=m.exports},"1Vnm":function(t,e,i){"use strict";var a=i("ODyT");i.n(a).a},"23D1":function(t,e,i){"use strict";var a=i("n9Qq");i.n(a).a},"2NmU":function(t,e,i){"use strict";var a=i("l7zd");i.n(a).a},"2P4K":function(t,e,i){"use strict";var a=i("zxr/");i.n(a).a},"2vYz":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjNGQzI4NEZEQzBBNDExRThCOEZCQjgxQUFBQ0UzMDQ4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjNGQzI4NEZFQzBBNDExRThCOEZCQjgxQUFBQ0UzMDQ4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6M0ZDMjg0RkJDMEE0MTFFOEI4RkJCODFBQUFDRTMwNDgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0ZDMjg0RkNDMEE0MTFFOEI4RkJCODFBQUFDRTMwNDgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5ChnG8AAABt0lEQVR42pyUTShEURTH7wghmfKxE0LJSjIINTZsyHIQNiRTUiglWU8opYSFj2zQGCsLC8mCUIySpQXNWKMoalD8j/6vntt9DKd+nXvfued/P9491/Xh9yuD5YN20ASKQTa4A9dgBwRBVE9yaWKpIAAGQJJytjcwD8bBi/UxwTYgBxyDYQqdgyHgYdzD/jnj0j5i3reVJYNDUA2eQC/Ysk0U5dYt84FlkAFOQT2IWSubotAj8GpCShNSjHs5XvImrW3m8YzE+sClis8uOV4xv0DEekAiCIPQD8lyFJvcomUh5kl+t4g1MLD2i1CQfluLrdM3ilghO2EHoQDPphS0gVctfkJfImJZto9Rg9gISAG5BiEZf8Z2pojds1Nr+Gti0+AZzDpUShXbDyJ2w06lwzbllqfTm6yG/krE9tnpVP+zLvo9EVsB71yu749CrdyR5K+K2C2YY3AJlMUpJOMW2Zaij1jlNMoac4MDwwr1v+xjLbuZJ/lfN1fxl7eAXVDOmy2DNviSSMlVgDrQwXoUu2BezPSepYEJ0G+byGRyRgtgzP6e6QkSGAQzfGmbQZHDSxvRZ/gUYAD7ZmLtfixnRgAAAABJRU5ErkJggg=="},"3biH":function(t,e,i){"use strict";var a=i("KzkL"),s=i("Ktth"),n=i.n(s),o=i("QhmF"),l={name:"CheckFlow",components:{},filters:{statusIcon:function(t){return 0==t?i("migV"):1==t?i("y4JV"):2==t?i("+xXq"):3==t?i("wu/m"):4==t||5==t?i("6pZM"):""},detailName:function(t){return 2==t.status?t.user_id_info.length+"人或签":3==t.status?t.user_id_info.length+"人会签":1==t.status?"负责人主管":4==t.status?"上一级审批人主管":void 0},stepName:function(t){return"第"+n.a.encodeS(t)+"级"}},props:{examineType:{type:String,default:""},id:[String,Number]},data:function(){return{loading:!1,list:[]}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},methods:{getDetail:function(){var t=this;this.loading=!0,Object(a.b)({types:this.examineType,types_id:this.id}).then(function(e){t.loading=!1,t.list=e.data,t.$emit("value-change",{config:e.data.config,value:[]})}).catch(function(){t.loading=!1})},getStatusName:function(t){return 0==t?"拒绝":1==t?"通过":2==t?"撤回":3==t?"创建":4==t?"待审核":5==t?"待提交":""},close:function(){this.$emit("close")}}},c=(i("1Vnm"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"},{name:"empty",rawName:"v-empty",value:t.list,expression:"list"}],attrs:{"xs-empty-icon":"none","xs-empty-text":"暂无记录"}},[a("flexbox",{staticClass:"flow-head"},[a("div",{staticClass:"flow-head-name"},[t._v("审批流程")]),t._v(" "),a("img",{staticClass:"flow-head-close",attrs:{src:i("cjwK")},on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"flow-body"},t._l(t.list,function(e,i){return a("flexbox",{key:i,staticClass:"cf-flow-item",attrs:{align:"stretch",justify:"flex-start"}},[a("img",{staticClass:"cf-flow-item-img",attrs:{src:t._f("statusIcon")(e.status)}}),t._v(" "),a("div",[a("flexbox",{staticClass:"cf-flow-item-head"},[a("div",{staticClass:"cf-flow-item-des"},[t._v(t._s(t._f("stepName")(e.order_id)))]),t._v(" "),a("div",[t._v(t._s(t._f("filterTimestampToFormatTime")(e.check_time)))])]),t._v(" "),a("flexbox",{staticClass:"cf-flow-item-info"},[a("div",{staticClass:"cf-flow-item-name"},[t._v(t._s(e.check_user_id_info.realname))]),t._v(" "),a("div",[a("span",[t._v(t._s(t.getStatusName(e.status)))]),t._v("了此申请")])]),t._v(" "),e.content?a("div",{staticClass:"cf-flow-item-content"},[t._v(t._s(e.content)+"\n          "),a("div",{staticClass:"cf-flow-item-content-arrow"})]):t._e()],1),t._v(" "),a("div",{staticClass:"cf-flow-item-line"})])}))],1)},[],!1,null,"4a3ada9c",null);r.options.__file="CheckFlow.vue";var d=r.exports,u={name:"ExamineInfo",components:{ExamineHandle:o.default,CheckFlow:d},filters:{statusIcon:function(t){return 0==t?i("migV"):1==t?i("y4JV"):2==t?i("+xXq"):3==t?i("wu/m"):4==t||5==t?i("6pZM"):""},detailName:function(t){return 2==t.status?t.user_id_info.length+"人或签":3==t.status?t.user_id_info.length+"人会签":1==t.status?"负责人主管":4==t.status?"上一级审批人主管":3==t.type?"创建人":void 0},stepName:function(t){return"第"+n.a.encodeS(t)+"级"}},props:{examineType:{type:String,default:""},refresh:{type:Boolean,default:!0},id:[String,Number],flow_id:[String,Number]},data:function(){return{loading:!1,examineInfo:{},showFlowPopover:!1,examineHandleInfo:{status:0},showExamineHandle:!1}},computed:{},watch:{id:{handler:function(t){t&&(this.examineInfo={},this.getFlowStepList())},deep:!0,immediate:!0},refresh:function(){this.getFlowStepList()},flow_id:{handler:function(t){t&&(this.examineInfo={},this.getFlowStepList())},deep:!0,immediate:!0}},mounted:function(){},methods:{getFlowStepList:function(){var t=this;this.flow_id&&this.id&&(this.loading=!0,Object(a.c)({types:this.examineType,flow_id:this.flow_id,types_id:this.id,action:"view"}).then(function(e){t.loading=!1,t.examineInfo=e.data,t.$emit("value-change",{config:e.data.config,value:[]})}).catch(function(){t.loading=!1}))},examineHandle:function(t){this.examineHandleInfo.status=t,this.showExamineHandle=!0},getStatusName:function(t){return 0==t?"拒绝":1==t?"通过":2==t?"撤回":3==t?"创建":4==t?"待审核":5==t?"待提交":""},getContentFilters:function(t){for(var e="",i=0;i<t.length;i++){var a=t[i];e=i==t.length-1?e+a.realname+"："+this.getStatusName(a.check_type):e+a.realname+"："+this.getStatusName(a.check_type)+"、"}return e},examineHandleClick:function(t){this.getFlowStepList(),console.log(t,"==data=="),this.$emit("on-handle",t)}}},m=(i("LXjn"),Object(c.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"contract-flow-box"},[a("flexbox",{staticStyle:{position:"relative"},attrs:{direction:"row-reverse"}},[a("el-popover",{attrs:{placement:"bottom",width:"300",trigger:"click"},model:{value:t.showFlowPopover,callback:function(e){t.showFlowPopover=e},expression:"showFlowPopover"}},[a("check-flow",{attrs:{id:t.id,"examine-type":t.examineType},on:{close:function(e){t.showFlowPopover=!1}}}),t._v(" "),a("el-button",{staticClass:"check-flow-button",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("查看审批历史")])],1),t._v(" "),a("div",{staticStyle:{"min-height":"40px"}},[1==t.examineInfo.is_recheck?a("el-button",{staticClass:"flow-button white",on:{click:function(e){t.examineHandle(2)}}},[t._v("撤回审批")]):t._e(),t._v(" "),1==t.examineInfo.is_check?a("el-button",{staticClass:"flow-button red",on:{click:function(e){t.examineHandle(0)}}},[t._v("拒绝")]):t._e(),t._v(" "),1==t.examineInfo.is_check?a("el-button",{staticClass:"flow-button blue",on:{click:function(e){t.examineHandle(1)}}},[t._v("通过")]):t._e()],1)],1),t._v(" "),0==t.examineInfo.config?a("flexbox",{staticClass:"check-items"},t._l(t.examineInfo.stepList,function(e,i){return a("flexbox",{key:i,staticClass:"check-item"},[a("div",[a("flexbox",{staticClass:"check-item-user",staticStyle:{width:"auto"}},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.userInfo,expression:"item.userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.userInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(item.userInfo.thumb_img)",arg:"background-image"}],key:e.userInfo.thumb_img,staticClass:"div-photo check-item-img"}),t._v(" "),a("div",{staticClass:"check-item-name"},[t._v(t._s(e.userInfo.realname))])]),t._v(" "),a("flexbox",{staticClass:"check-item-info"},[a("img",{staticClass:"check-item-img",attrs:{src:t._f("statusIcon")(e.type)}}),t._v(" "),a("div",{staticClass:"check-item-name"},[t._v(t._s(t.getStatusName(e.type)))])])],1),t._v(" "),t.examineInfo.stepList.length-1!=i?a("i",{staticClass:"el-icon-arrow-right check-item-arrow"}):t._e()])})):1==t.examineInfo.config?a("flexbox",{staticClass:"check-items",attrs:{wrap:"wrap"}},t._l(t.examineInfo.stepList,function(e,s){return a("el-popover",{key:s,attrs:{disabled:0==e.user_id_info.length,placement:"bottom",trigger:"hover"}},[a("div",{staticClass:"popover-detail"},t._l(e.user_id_info,function(e,i){return a("flexbox",{key:i,staticClass:"popover-detail-item",attrs:{align:"stretch"}},[a("img",{staticClass:"popover-detail-item-img",attrs:{src:t._f("statusIcon")(e.check_type)}}),t._v(" "),a("div",[a("div",{staticClass:"popover-detail-item-time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(e.check_time)))]),t._v(" "),a("flexbox",{staticClass:"popover-detail-item-examine"},[a("div",{staticClass:"examine-name"},[t._v(t._s(e.realname))]),t._v(" "),a("div",{staticClass:"examine-info"},[t._v(t._s(t.getStatusName(e.check_type))+"此申请")])])],1)])})),t._v(" "),a("flexbox",{staticClass:"fixed-examine-item",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"fixed-examine-info"},[a("img",{attrs:{src:i("dZj0")}}),t._v(" "),a("div",{staticClass:"detail"},[t._v(t._s(t._f("detailName")(e)))]),t._v(" "),a("flexbox",{staticClass:"check-item-info"},[a("img",{staticClass:"check-item-img",attrs:{src:t._f("statusIcon")(e.type)}}),t._v(" "),a("div",{staticClass:"check-item-name"},[t._v(t._s(t.getStatusName(e.type)))])])],1),t._v(" "),t.examineInfo.stepList.length-1!=s?a("i",{staticClass:"el-icon-arrow-right check-item-arrow"}):t._e()])],1)})):t._e(),t._v(" "),a("examine-handle",{attrs:{show:t.showExamineHandle,id:t.id,"examine-type":t.examineType,detail:t.examineInfo,status:t.examineHandleInfo.status},on:{close:function(e){t.showExamineHandle=!1},save:t.examineHandleClick}})],1)},[],!1,null,"3ee53ee0",null));m.options.__file="ExamineInfo.vue";e.a=m.exports},"3hkp":function(t,e,i){},"3yi6":function(t,e,i){"use strict";var a=i("7Qib"),s=i("KzkL"),n={name:"FollowRecordCell",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-66f9"),i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-e78f"),i.e("chunk-f93ad")]).then(i.bind(null,"uMjE"))}},props:{item:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},index:[String,Number]},data:function(){return{showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{},mounted:function(){},methods:{previewImg:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return t.url=t.file_path,t})})},downloadFile:function(t){Object(a.a)({path:t.file_path,name:t.name})},handleCommand:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.j)({id:e.item.record_id}).then(function(i){e.$emit("on-handle",{type:t,data:{item:e.item,index:e.index}}),e.$message.success(i.data)}).catch(function(){})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t,this.showFullDetail=!0}}},o=(i("+9np"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.item.create_user_info,expression:"item.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.item.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(item.create_user_info.thumb_img)",arg:"background-image"}],key:t.item.create_user_info.thumb_img,staticClass:"div-photo fl-h-img"}),t._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[t._v(t._s(t.item.create_user_info.realname))]),t._v(" "),a("div",{staticClass:"fl-h-time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.item.create_time,"YYYY-MM-DD HH:mm")))])]),t._v(" "),a("flexbox",{staticClass:"fl-h-mark"},[a("img",{staticClass:"fl-h-mark-img",attrs:{src:i("N0PQ")}}),t._v(" "),a("div",{staticClass:"fl-h-mark-name"},[t._v("跟进记录")])]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD","margin-left":"8px"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")])],1)],1)],1),t._v(" "),a("div",{staticClass:"fl-b"},[a("div",{staticClass:"fl-b-content"},[t._v(t._s(t.item.content))]),t._v(" "),t.item.dataInfo.imgList&&t.item.dataInfo.imgList.length>0?a("flexbox",{staticClass:"fl-b-images",attrs:{wrap:"wrap"}},t._l(t.item.dataInfo.imgList,function(e,i){return a("div",{directives:[{name:"lazy",rawName:"v-lazy:background-image",value:e.file_path_thumb,expression:"file.file_path_thumb",arg:"background-image"}],key:e.file_path_thumb,staticClass:"fl-b-img-item",on:{click:function(e){t.previewImg(t.item.dataInfo.imgList,i)}}})})):t._e(),t._v(" "),t.item.dataInfo.fileList&&t.item.dataInfo.fileList.length>0?a("div",{staticClass:"fl-b-files"},t._l(t.item.dataInfo.fileList,function(e,s){return a("flexbox",{key:s,staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE")}}),t._v(" "),a("div",{staticClass:"cell-body"},[t._v(t._s(e.name)),a("span",{staticStyle:{color:"#ccc"}},[t._v("（"+t._s(e.size)+"）")])]),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:function(i){t.downloadFile(e)}}},[t._v("下载")])],1)})):t._e(),t._v(" "),t.item.category||t.item.next_time?a("div",{staticClass:"follow"},[t.item.category?a("span",{staticClass:"follow-info"},[t._v(t._s(t.item.category))]):t._e(),t._v(" "),t.item.next_time?a("span",{staticClass:"follow-info"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.item.next_time,"YYYY-MM-DD HH:mm:ss")))]):t._e()]):t._e(),t._v(" "),t.item.dataInfo.contactsList&&t.item.dataInfo.contactsList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("关联联系人")]),t._v(" "),a("div",t._l(t.item.dataInfo.contactsList,function(e,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){t.checkRelationDetail("contacts",e.contacts_id)}}},[a("i",{staticClass:"wukong wukong-contacts cell-head crm-type",style:{opacity:0==i?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t.item.dataInfo.businessList&&t.item.dataInfo.businessList.length>0?a("div",{staticClass:"fl-b-other"},[a("div",{staticClass:"fl-b-other-name"},[t._v("关联商机")]),t._v(" "),a("div",t._l(t.item.dataInfo.businessList,function(e,i){return a("flexbox",{key:i,staticClass:"cell",nativeOn:{click:function(i){t.checkRelationDetail("business",e.business_id)}}},[a("i",{staticClass:"wukong wukong-business cell-head crm-type",style:{opacity:0==i?1:0}}),t._v(" "),a("div",{staticClass:"cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.name))])])}))]):t._e(),t._v(" "),t._t("default")],2),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"e92cd6c6",null);l.options.__file="FollowRecordCell.vue";e.a=l.exports},"5Og4":function(t,e,i){},"5j45":function(t,e,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("UcQx"),o=i("qbf4"),l=i("mkuN"),c=i("7Qib"),r={name:"RelativeBusiness",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default,CrmRelative:l.a},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,businessId:"",formatterRules:{},createActionInfo:{type:"relative",crmType:this.crmType,data:{}},showRelativeView:!1,selectionList:[]}},computed:{customer_id:function(){return this.detail.customer_id},canRelation:function(){return"contacts"==this.crmType}},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{checkRelativeInfos:function(t){var e=this;if(t.data.length>0){var i={is_relation:1};i[this.crmType+"_id"]=this.id,i.business_id=t.data.map(function(t){return t.business_id}),Object(o.g)(i).then(function(t){e.getDetail(),e.$message.success(t.data)}).catch(function(){})}},unRelevanceHandleClick:function(){var t=this;0==this.selectionList.length?this.$message.error("请先勾选数据"):this.$confirm("确认取消关联?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e={is_relation:0};e[t.crmType+"_id"]=t.id,e.business_id=t.selectionList.map(function(t){return t.business_id}),Object(o.g)(e).then(function(e){t.getDetail(),t.$message.success(e.data)}).catch(function(){})}).catch(function(){t.$message.info("已取消操作")})},getFieldList:function(){function t(t){return t||""}this.fieldList.push({prop:"name",width:"200",label:"商机名称"}),this.fieldList.push({prop:"money",width:"200",label:"商机金额"}),this.fieldList.push({prop:"customer_id",width:"200",label:"客户名称"}),this.fieldList.push({prop:"type_id",width:"200",label:"商机状态组"}),this.fieldList.push({prop:"status_id",width:"200",label:"状态"}),this.formatterRules.customer_id={type:"crm",formatter:function(t){return t?t.name:""}},this.formatterRules.type_id={type:"crm",formatter:t},this.formatterRules.status_id={type:"crm",formatter:t}},getDetail:function(){var t=this;this.loading=!0;var e={pageType:"all"};e[this.crmType+"_id"]=this.id,Object(n.d)(e).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},fieldFormatter:function(t,e,i){if(["money"].includes(e.property))return Object(c.h)(i);var a=this.formatterRules[e.property];return a?"crm"===a.type?e.property?a.formatter(t[e.property+"_info"]):"":a.formatter(t[e.property]):t[e.property]},handleRowClick:function(t,e,i){this.businessId=t.business_id,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"contacts"==this.crmType?this.createActionInfo.data.customer=this.detail.customer_id_info:"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.canRelation?this.$refs.crmrelative.refreshList():this.getDetail()}}},d=(i("toL5"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("新建商机")]),t._v(" "),t.canRelation?i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.unRelevanceHandleClick(e)}}},[t._v("解除关联")]):t._e(),t._v(" "),t.canRelation?i("el-popover",{staticStyle:{"margin-right":"20px"},attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}},[i("crm-relative",{ref:"crmrelative",attrs:{show:t.showRelativeView,radio:!1,action:{type:"condition",data:{form_type:"customer",customer_id:t.customer_id}},"selected-data":{business:t.list},"crm-type":"business"},on:{close:function(e){t.showRelativeView=!1},changeCheckout:t.checkRelativeInfos},model:{value:t.showRelativeView,callback:function(e){t.showRelativeView=e},expression:"showRelativeView"}}),t._v(" "),i("el-button",{staticClass:"rc-head-item",staticStyle:{"margin-right":"0"},attrs:{slot:"reference",type:"primary"},nativeOn:{click:function(e){t.showRelativeView=!0}},slot:"reference"},[t._v("关联")])],1):t._e()],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":function(e){t.selectionList=e}}},[t.canRelation&&t.fieldList.length>0?i("el-table-column",{attrs:{"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}):t._e(),t._v(" "),t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})],2),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.businessId,"crm-type":"business"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"business"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"36adb30f",null);u.options.__file="RelativeBusiness.vue";e.a=u.exports},"6ENb":function(t,e,i){"use strict";var a=i("JHu1");i.n(a).a},"6jE7":function(t,e,i){"use strict";var a=i("p46I");i.n(a).a},"6pZM":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjAyMzg4NTNCNDE2NjExRTk4MkE1QUI2Q0I2MDkxQ0RDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjAyMzg4NTNDNDE2NjExRTk4MkE1QUI2Q0I2MDkxQ0RDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDIzODg1Mzk0MTY2MTFFOTgyQTVBQjZDQjYwOTFDREMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDIzODg1M0E0MTY2MTFFOTgyQTVBQjZDQjYwOTFDREMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7hsdBeAAABLklEQVR42mL8WxjFgAWwAXEAFFsCsRQQ/wLiJ0B8HojXA/FGqBgKYMFiWCAQdwGxChZLNKA4EojvAHE5EK9DVsSExGYG4k6oAhUGwgCkZi1UDzM2F7YBcRkD6QCmpxzZhSH4DGPKrQNjAoaGwAwEhU0/XjcoqkMwfjABZBbIwFAglmGgHEgDcRgTNGlQCwSADDSlooEmIAMlqGigJAs0tbMTo5qpbymm4P2bDP8mN6Ek7OcETQJqwg0YkTnPQS68BMRq+MxDdgEBcAbkwg1UDMMNIANXQ0sRSsFTkFlM0EgpooKBhUD8E5aXQa7spsCwbqgZKMVXJRBPIcOwqVC9GOXhXyDOhZYad4gw6A60HMiB6sVZYoMKzc1QxaDS2xia8WEBfxZaBazGVgUABBgAnqU8Wz9MmZkAAAAASUVORK5CYII="},"7FIu":function(t,e,i){},"7JKO":function(t,e,i){"use strict";var a=i("/4q4");i.n(a).a},"8KPp":function(t,e,i){"use strict";var a=i("FyfS"),s=i.n(a),n=i("Qldq"),o=i("Iae0"),l=i("KzkL"),c={name:"JournalLog",components:{JournalCell:o.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},NewDialog:function(){return i.e("chunk-39d7").then(i.bind(null,"kFvY"))}},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showFullDetail:!1,detailCRMType:"",showNewDialog:!1,formData:{},dialogTitle:"",imgFileList:[],accessoryFileList:[],newLoading:!1}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(l.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"log"}).then(function(e){var i=!0,a=!1,n=void 0;try{for(var o,l=s()(e.data.list);!(i=(o=l.next()).done);i=!0){var c=o.value;c.dataInfo.allData={},c.dataInfo.allData.business=c.dataInfo.businessList,c.dataInfo.allData.contacts=c.dataInfo.contactsList,c.dataInfo.allData.contract=c.dataInfo.contractList,c.dataInfo.allData.customer=c.dataInfo.customerList,0!=c.dataInfo.businessList.length||0!=c.dataInfo.contactsList.length||0!=c.dataInfo.contractList.length||0!=c.dataInfo.customerList.length?c.dataInfo.allDataShow=!0:c.dataInfo.allDataShow=!1}}catch(t){a=!0,n=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw n}}t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},jourecallCellHandle:function(t){var e=this;if("edit"==t.type){var i=t.data.item;if(this.showNewDialog=!0,this.dialogTitle="编辑日志",this.formData=i,this.imgFileList=[],i.imgList){var a=!0,o=!1,l=void 0;try{for(var c,r=s()(i.imgList);!(a=(c=r.next()).done);a=!0){var d=c.value;d.url=d.file_path_thumb,this.imgFileList.push(d)}}catch(t){o=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(o)throw l}}}if(this.accessoryFileList=[],i.fileList){var u=!0,m=!1,h=void 0;try{for(var p,f=s()(i.fileList);!(u=(p=f.next()).done);u=!0){var v=p.value;v.url=v.file_path_thumb,this.accessoryFileList.push(v)}}catch(t){m=!0,h=t}finally{try{!u&&f.return&&f.return()}finally{if(m)throw h}}}this.formData.depData=i.sendStructList?i.sendStructList:[],this.formData.sentWhoList=i.sendUserList?i.sendUserList:[]}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.d)({log_id:t.data.item.log_id}).then(function(i){for(var a in e.$message({type:"success",message:"删除成功!"}),e.list)if(e.list[a].log_id==t.data.item.log_id){e.list.splice(a,1);break}})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item.key,this.detailCRMType=t.data.type,this.showFullDetail=!0)},submitBtn:function(t,e,i,a){var o=this;this.newLoading=!0;var l=[],c=[],r=[];if(this.formData.depData){var d=!0,u=!1,m=void 0;try{for(var h,p=s()(this.formData.depData);!(d=(h=p.next()).done);d=!0){var f=h.value;r.push(f.id)}}catch(t){u=!0,m=t}finally{try{!d&&p.return&&p.return()}finally{if(u)throw m}}}var v=[];if(this.formData.sentWhoList){var g=!0,b=!1,y=void 0;try{for(var w,_=s()(this.formData.sentWhoList);!(g=(w=_.next()).done);g=!0){var C=w.value;v.push(C.id)}}catch(t){b=!0,y=t}finally{try{!g&&_.return&&_.return()}finally{if(b)throw y}}}var A=!0,I=!1,D=void 0;try{for(var x,k=s()(this.imgFileList);!(A=(x=k.next()).done);A=!0){var R=x.value;l.push(R.file_id)}}catch(t){I=!0,D=t}finally{try{!A&&k.return&&k.return()}finally{if(I)throw D}}var T=!0,E=!1,N=void 0;try{for(var M,L=s()(this.accessoryFileList);!(T=(M=L.next()).done);T=!0){var j=M.value;c.push(j.file_id)}}catch(t){E=!0,N=t}finally{try{!T&&L.return&&L.return()}finally{if(E)throw N}}var S={id:this.formData.log_id,category_id:t,content:this.formData.content,tomorrow:this.formData.tomorrow,question:this.formData.question,file:c.concat(l),send_user_ids:v,send_structure_ids:r,customer_ids:a.customer_ids,contacts_ids:a.contacts_ids,business_ids:a.business_ids,contract_ids:a.contract_ids};Object(n.e)(S).then(function(t){o.refreshList(),o.showNewDialog=!1,o.$message.success("编辑成功"),o.newLoading=!1}).catch(function(){o.newLoading=!1,o.$message.error("编辑失败")})}}},r=(i("bmHb"),i("KHd+")),d=Object(r.a)(c,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("journal-cell",{key:a,staticClass:"list-cell",attrs:{data:e.dataInfo},on:{"on-handle":t.jourecallCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showNewDialog?i("new-dialog",{attrs:{"form-data":t.formData,"dialog-title":t.dialogTitle,"img-file-list":t.imgFileList,"accessory-file-list":t.accessoryFileList,"new-loading":t.newLoading},on:{close:function(e){t.showNewDialog=!1},submitBtn:t.submitBtn}}):t._e()],1)},[],!1,null,"7297ab6e",null);d.options.__file="JournalLog.vue";e.a=d.exports},"8gwX":function(t,e,i){"use strict";var a=i("YrMO"),s=i("Ew9n"),n=i("F03V"),o=i("U05J"),l=i("C+sD"),c=i("8DbX"),r=i("EgJF"),d=i("4+0Q"),u={name:"ProductDetail",components:{SlideView:s.a,CRMDetailHead:n.a,CRMBaseInfo:o.a,RelativeFiles:l.a,RelativeHandle:c.a,CRMCreateView:r.default},mixins:[d.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"product",detailData:{},headDetails:[{title:"产品类别",value:""},{title:"产品单位",value:""},{title:"产品价格",value:""},{title:"产品编码",value:""}],tabnames:[{label:"基本信息",name:"basicinfo"},{label:"附件",name:"file"},{label:"操作记录",name:"operationlog"}],tabCurrentName:"basicinfo",isCreate:!1}},computed:{tabName:function(){return"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(a.f)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.category_id_info,t.headDetails[1].value=e.data.unit,t.headDetails[2].value=t.moneyFormat(e.data.price),t.headDetails[3].value=e.data.num}).catch(function(e){e&&102==e.code&&(t.hasRequestAuth=!1),t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},m=(i("2NmU"),i("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"},on:{"side-close":t.hideView}},[t.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{detail:t.detailData,"head-details":t.headDetails,id:t.id,"crm-type":"product"},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return i("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),i("div",{staticClass:"t-loading-content"},[i("keep-alive",[i(t.tabName,{tag:"component",attrs:{id:t.id,"crm-type":"product"}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:t.id},"crm-type":"product"},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"c8bca8ee",null);h.options.__file="ProductDetail.vue";e.a=h.exports},"9Aba":function(t,e,i){"use strict";var a=i("N3zo");i.n(a).a},AV3D:function(t,e,i){"use strict";var a=i("QV+c");i.n(a).a},AWtP:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC4AAAAuCAYAAABXuSs3AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkNDODZFRTdCMzMyMTExRTk4NEQwRTM3OTJDOUE2QjJDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkNDODZFRTdDMzMyMTExRTk4NEQwRTM3OTJDOUE2QjJDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Q0M4NkVFNzkzMzIxMTFFOTg0RDBFMzc5MkM5QTZCMkMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6Q0M4NkVFN0EzMzIxMTFFOTg0RDBFMzc5MkM5QTZCMkMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5WLaVZAAAFbElEQVR42sxZ+W9UVRQ+dzqlq7RQmNJSaqdstrhEgkpwIRGN0II1EWOMVjTWhYQYA3+GCm6p0WhQq/EHaWIwVBK2oDZukVSRFi20lK201lJIV2zn+p337kynb6Yz977ptD3Jl8y8d+8537vv3LPcJ8b2vEYJSi7wgMLtQDHgA7LU/QGgGzgP/AF8DxwH+hIxKlwSTwO2As8ADwMphvPHgMNAHbAPGDEl4DEcnwHsBM4CnwMbXZAmNecRpaNN6cxIFvFNwEngTWAxTZ0UKp0nlY0pI54O1AINwFJKnixVNmqVzYSI56vNtJ2mT9hWo7Ltingp8AOwhqZfVivbflPiRcARYBnNnLDto4qLFvFMYD9QQjMvJYpLpg7xt4A7afYIc3k7HvEK4EWafVKjuIXE6wh77ySUhm9eSbT8DhJLVhBl59oX+/tIXmglam0i2fFXIurfVT4/7CS+3XWczisgzwZUAIWlkfdy8kgAdOtaEpfbKHAEGf7fTjdWShXHPeG1SppKvYXGq1xSRqLyOaLUOXoT/rtB8sAnJM+1uCHfqR5gOOjjW92QpgUFIL1NnzQLxorNeFBfkRviBcDj4Zuz2liFx0OeimdBJM3cvHcOeTY+belwIdVB4ryLHjJ2kZVIbvMXud9qmGvpMBfmmsvE1xuXpumoQMumoBJgHekZprOY63omfp8+4UwSVS8RjY6SiBZBTN9aod/WxTrTM02m3s/Ey7R9+tEaEryp0hDyvamJrzh8nXUJ32LofsHE58t45HKt1Vm1FnHHn4SkKFQ7UQob92gXYExca4eJ8rtC7kIjSF6BschB/deIrvVEXu/tIroRpa0MBKBrKOQmovxu7UDMxOdqDV2o4m4K9sa8hejbL0UMkZeQGb96j+SZ3y3fpZFBkr8ds691dUTq7L4IXT7o9IbygqZke03fqPXTv4okag+xqNgRIlHIZd1EsrEB2fEzxPhUK7N6ntiB8BfZ0Fg6/OXutgdwXWvVeXUK7BJdoO4IfLmbxJoN6M2zJpIvWkbiyVfjWx4eINn8C3me2jl+rUe7hulnV7miM1I2/zr+Z+58y+flsXrXW1Ierbd9Grqi2ogtPUy8VcvQqZ+ILrePr+y6SpLXe0n+eNCcNObwXLEurMSGbsuGnpxh4qe1hiICBPZ/RPL832qTeslTVYMqr5nkwTo7OsQTjOGxsv2UNTe4KVkn67aijJ60cFlbhR9fm8Rd3lBiy/NIGClW9Ag0fIqCs51ExTY0EdHTAjcTkscV+FGcVdvJByFVfrMXD9LMI0xe2mO84sfVWZ7uiybZfcEmbW1vr10sDQ3Y8T3GavMYcctqm7SVjVNsXWakmet3TLxPHUDqr3n+Esf/IvtN5E1+hiPy7DwnHHW4U5eG8LHJ1WBxUGc01ecwlp1jJ6acBZPP4Xvs0zx2gi7jhqIuvJGoV22RnuQ7jPX+Y2fAWEUS3+OMy2NjLUL81m1fOHF2zte1XcVhTPZ2hlwh5jw01Tw2AVd5I1qX/z6wQzWjMXKtl2TLxEQhz50mUbxC4zQgn+SfP9vF2ITWADTGRuPN5ma+NvTAji8SnBEOuCtNJSVZNodzczoln09/7CKBJ5v0XueCRttNXCE1zaLjtyblwnEPPQeBLUDHLCDdobgM6hBnQQ1LD6oNMVPSpjhcjBpd40y8FzgxA6RPKNuTLly8tvqKUvDhNJL+QNmM2SfonAdwwH8ZqCT7+2ay5KwKx68Ek0yixMND5W3ALqPyQC+N71K6v9WdZHrqyN3CbrK/hvHn8ENmJfGE0vSQ0uFXOodMFHhdrhIfknyhME+dP7JflquSgevb7GBjC3SpjcYdQ6PqAa4m8pr+F2AABbdq5hapDDAAAAAASUVORK5CYII="},AnnZ:function(t,e,i){"use strict";var a=i("BirF");i.n(a).a},BirF:function(t,e,i){},Bs8Y:function(t,e,i){},BuGm:function(t,e,i){"use strict";i.r(e);var a=i("gDS+"),s=i.n(a),n=i("FyfS"),o=i.n(n),l=i("Dh/N"),c=i("1RnH"),r=i("0hym"),d=i("7Qib"),u={components:{relatedBusiness:c.a,XhUser:r.a},props:{formData:{type:Object,default:function(){return{color:""}}},text:{type:String,default:"创建日程"},appendToBody:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,i,a){t.formData.start_time&&t.formData.end_time&&t.formData.start_time.getTime()>=t.formData.end_time.getTime()&&a(new Error("开始时间必须小于结束时间")),a()};return{zIndex:Object(d.g)(),formList:[{label:"主题",field:"title",type:"color"},{label:"开始时间",field:"start_time",type:"time"},{label:"结束时间",field:"end_time",type:"time"},{label:"参与人",field:"owner_user_ids",type:"participant"},{label:"备注",field:"remark",type:"textarea",width:"100%"}],options:[{value:0,label:"无"},{value:1,label:"准时提醒"},{value:2,label:"5分钟前"},{value:3,label:"15分钟前"},{value:4,label:"30分钟前"},{value:5,label:"一个小时前"},{value:6,label:"二个小时前"},{value:7,label:"一天前"},{value:8,label:"二天前"},{value:9,label:"一周前"}],fileList:[],loading:!1,colorList:["#3E8EF7","#11C06C","#0BB2D4","#EB6709","#FF4C52","#526069","#9262F4"],rules:{title:[{required:!0,message:"主题不能为空",trigger:"blur"},{max:50,message:"主题长度最多为50个字符",trigger:"blur"}],start_time:[{required:!0,message:"开始时间不能为空",trigger:"blur"},{validator:e,trigger:"blur"}],end_time:[{required:!0,message:"结束时间不能为空",trigger:"blur"},{validator:e,trigger:"blur"}]},relevanceAll:{},allData:{},colleaguesList:[]}},created:function(){},mounted:function(){this.appendToBody&&document.body.appendChild(this.$el),this.allData.business=this.formData.businessList?this.formData.businessList:[],this.allData.contacts=this.formData.contactsList?this.formData.contactsList:[],this.allData.contract=this.formData.contractList?this.formData.contractList:[],this.allData.customer=this.formData.customerList?this.formData.customerList:[],this.formData.ownerList&&(this.colleaguesList=[].concat(this.formData.ownerList)),"创建日程"==this.text&&this.$set(this.formData,"color","#3E8EF7")},beforeDestroy:function(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{close:function(){1==this.$route.query.routerKey?this.$router.go(-1):this.$emit("closeDialog")},checkInfos:function(t){this.relevanceAll=t},onSubmit:function(){var t=this;this.$refs.form.validate(function(e){if(!e)return!1;t.loading=!0;var i=t.formData,a=[],n=!0,c=!1,r=void 0;try{for(var d,u=o()(t.colleaguesList);!(n=(d=u.next()).done);n=!0){var m=d.value;a.push(m.id)}}catch(t){c=!0,r=t}finally{try{!n&&u.return&&u.return()}finally{if(c)throw r}}if("创建日程"==t.text)Object(l.a)({title:i.title,start_time:i.start_time.getTime()/1e3,end_time:i.end_time.getTime()/1e3,owner_user_ids:a,remark:i.remark,color:i.color,customer_ids:t.relevanceAll.customer_ids,contacts_ids:t.relevanceAll.contacts_ids,business_ids:t.relevanceAll.business_ids,contract_ids:t.relevanceAll.contract_ids}).then(function(e){1==t.$route.query.routerKey?t.$router.push("schedule"):t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1});else{var h={customer_ids:[],contract_ids:[],contacts_ids:[],business_ids:[]};if(t.allData.customer){var p=!0,f=!1,v=void 0;try{for(var g,b=o()(t.allData.customer);!(p=(g=b.next()).done);p=!0){var y=g.value;h.customer_ids.push(y.customer_id)}}catch(t){f=!0,v=t}finally{try{!p&&b.return&&b.return()}finally{if(f)throw v}}}if(t.allData.contract){var w=!0,_=!1,C=void 0;try{for(var A,I=o()(t.allData.contract);!(w=(A=I.next()).done);w=!0){var D=A.value;h.contract_ids.push(D.contract_id)}}catch(t){_=!0,C=t}finally{try{!w&&I.return&&I.return()}finally{if(_)throw C}}}if(t.allData.contacts){var x=!0,k=!1,R=void 0;try{for(var T,E=o()(t.allData.contacts);!(x=(T=E.next()).done);x=!0){var N=T.value;h.contacts_ids.push(N.contacts_id)}}catch(t){k=!0,R=t}finally{try{!x&&E.return&&E.return()}finally{if(k)throw R}}}if(t.allData.business){var M=!0,L=!1,j=void 0;try{for(var S,G=o()(t.allData.business);!(M=(S=G.next()).done);M=!0){var Z=S.value;h.business_ids.push(Z.business_id)}}catch(t){L=!0,j=t}finally{try{!M&&G.return&&G.return()}finally{if(L)throw j}}}var Y="{}"==s()(t.relevanceAll)?h:t.relevanceAll;Object(l.c)({event_id:i.event_id,title:i.title,start_time:new Date(i.start_time).getTime()/1e3,end_time:new Date(i.end_time).getTime()/1e3,owner_user_ids:a,remark:i.remark,color:i.color,customer_ids:Y.customer_ids,contacts_ids:Y.contacts_ids,business_ids:Y.business_ids,contract_ids:Y.contract_ids}).then(function(e){t.$emit("onSubmit"),t.loading=!1}).catch(function(){t.loading=!1})}})},httpRequest:function(t){this.fileList.push(t.file)},onRemove:function(t){for(var e in this.fileList)this.fileList[e].uid==t.uid&&this.fileList.splice(e,1)},changeColor:function(t){this.$set(this.formData,"color",t)},changeCheckout:function(t){this.colleaguesList=t.data},selectDelect:function(t,e){this.$refs.xhuser[0].cancelCheckItem(t),this.colleaguesList.splice(e,1)}}},m=(i("tgh5"),i("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"create-schedule",style:{"z-index":t.zIndex}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"add-schedule"},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("span",{staticClass:"text"},[t._v(t._s(t.text))]),t._v(" "),a("img",{staticClass:"el-icon-close rt",attrs:{src:i("cjwK"),alt:""},on:{click:t.close}})]),t._v(" "),a("div",{staticClass:"content"},[a("el-form",{ref:"form",attrs:{model:t.formData,rules:t.rules}},t._l(t.formList,function(e,i){return a("el-form-item",{key:i,class:"el-form-item-"+e.field,style:{width:e.width},attrs:{prop:e.field,label:e.label}},["time"==e.type?[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]:"textarea"==e.type?[a("el-input",{attrs:{autosize:{minRows:6},type:"textarea",placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})]:"participant"==e.type?[a("el-popover",{attrs:{placement:"bottom-end",width:"280",trigger:"click"}},[a("xh-user",{ref:"xhuser",refInFor:!0,attrs:{"selected-data":t.colleaguesList},on:{changeCheckout:t.changeCheckout}}),t._v(" "),a("div",{staticClass:"select-box",attrs:{slot:"reference"},slot:"reference"},[t._l(t.colleaguesList,function(e,i){return a("span",{key:i,staticClass:"select-box-span"},[t._v("\n                  "+t._s(e.realname)+"\n                  "),a("span",{staticClass:"el-icon-close",on:{click:function(a){a.stopPropagation(),t.selectDelect(e,i)}}})])}),t._v(" "),a("span",{staticClass:"el-icon-plus"})],2)],1)]:"select"==e.type?[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))]:"color"==e.type?[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}},[a("i",{staticClass:"el-input__icon",attrs:{slot:"prefix"},slot:"prefix"},[a("span",{staticClass:"bg-color",style:{background:t.formData.color}})])]),t._v(" "),a("div",{staticClass:"color-box"},t._l(t.colorList,function(e,i){return a("span",{key:i,style:{background:e},on:{click:function(i){t.changeColor(e)}}})}))]:a("el-input",{model:{value:t.formData[e.field],callback:function(i){t.$set(t.formData,e.field,i)},expression:"formData[item.field]"}})],2)})),t._v(" "),a("related-business",{attrs:{"all-data":t.allData},on:{checkInfos:t.checkInfos}})],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.close}},[t._v("取消")])],1)])])},[],!1,null,"8e8c2aa8",null);h.options.__file="createSchedule.vue";e.default=h.exports},DUlf:function(t,e,i){"use strict";var a=i("KzkL"),s=i("mX3o"),n={name:"RelativeTeam",components:{TeamsHandle:i("eOzp").a},mixins:[s.a],props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{list:[],fieldList:[],tableHeight:"400px",teamsDialogShow:!1,handleType:1,editPermissionShow:!1,selectionList:[]}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.fieldList.push({prop:"realname",width:"200",label:"姓名"}),this.fieldList.push({prop:"structure_name",width:"200",label:"职位"}),this.fieldList.push({prop:"group_name",width:"200",label:"团队角色"}),this.fieldList.push({prop:"authority",width:"200",label:"权限"}),this.getDetail()},activated:function(){},deactivated:function(){},methods:{getDetail:function(){var t=this;this.loading=!0,Object(a.t)({types:"crm_"+this.crmType,types_id:this.id}).then(function(e){t.loading=!1,t.list=e.data}).catch(function(){t.loading=!1})},handleSelectionChange:function(t){this.selectionList=t},handleClick:function(t){var e=this;"add"==t?this.teamsDialogShow=!0:0==this.selectionList.length?this.$message.error("请勾选需要操作的团队成员"):"edit"==t?this.editPermissionShow=!0:"remove"==t&&this.$confirm("此操作将移除这些团队成员是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t=e.selectionList.map(function(t,e,i){return t.id}),i={types:"crm_"+e.crmType,types_id:[e.detail[e.crmType+"_id"]],user_id:t,is_del:1};e.loading=!0,Object(a.u)(i).then(function(t){e.$message({type:"success",message:t.data}),e.loading=!1,e.getDetail()}).catch(function(){e.loading=!1})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleCallBack:function(t){this.getDetail()},handleEditConfirm:function(){var t=this,e=this.selectionList.map(function(t,e,i){return t.id});this.loading=!0,Object(a.u)({types:"crm_"+this.crmType,types_id:[this.detail[this.crmType+"_id"]],user_id:e,type:this.handleType}).then(function(e){t.editPermissionShow=!1,t.$message({type:"success",message:e.data}),t.loading=!1,t.getDetail()}).catch(function(){t.loading=!1})},handleSelectable:function(t,e){return 0!=t.type},handleRowClick:function(t,e,i){},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},o=(i("zBZy"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"rc-cont"},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("remove")}}},[t._v("移除")]),t._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("edit")}}},[t._v("编辑")]),t._v(" "),i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){t.handleClick("add")}}},[t._v("添加团队成员")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick,"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{selectable:t.handleSelectable,"show-overflow-tooltip":"",type:"selection",align:"center",width:"55"}}),t._v(" "),t._l(t.fieldList,function(t,e){return i("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,"show-overflow-tooltip":""}})})],2),t._v(" "),i("teams-handle",{attrs:{"crm-type":t.crmType,"selection-list":[t.detail],"dialog-visible":t.teamsDialogShow,title:"添加团队成员"},on:{"update:dialogVisible":function(e){t.teamsDialogShow=e},handle:t.handleCallBack}}),t._v(" "),i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.editPermissionShow,"append-to-body":!0,title:"编辑权限",width:"400px"},on:{"update:visible":function(e){t.editPermissionShow=e}}},[i("div",{staticClass:"handle-box"},[i("flexbox",{staticClass:"handle-item"},[i("div",{staticClass:"handle-item-name"},[t._v("权限：")]),t._v(" "),i("el-radio-group",{model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[i("el-radio",{attrs:{label:1}},[t._v("只读")]),t._v(" "),i("el-radio",{attrs:{label:2}},[t._v("读写")])],1)],1)],1),t._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(e){t.editPermissionShow=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.handleEditConfirm(e)}}},[t._v("保存")])],1)])],1)},[],!1,null,"a8be9566",null);l.options.__file="RelativeTeam.vue";e.a=l.exports},Dd9w:function(t,e,i){},DfqB:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQ1REZGQ0ZDREQ3QjExRThBRDRFRTZEM0E5QzY4QzIyIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQ1REZGQ0ZEREQ3QjExRThBRDRFRTZEM0E5QzY4QzIyIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDVERkZDRkFERDdCMTFFOEFENEVFNkQzQTlDNjhDMjIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDVERkZDRkJERDdCMTFFOEFENEVFNkQzQTlDNjhDMjIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6FxyN3AAADGklEQVR42uxYS08TURS+06GFvqnY0gZSaIoRFIImxsQNCxcsXJiof4MY3Lo2Jqx04cL/oMbEhQsX7FoThKBCIg1tKAWkD6WWvqYPOp6vnTGpFftwWitykpvbzjnfma/nPs455URRZN0oKtal0vM75f3Fx2178cPr8/9mxFomNjF8zuAadD6ymgeCWk1fQcWpxB4VX9L36XJ4Bh1s2rKUxwleGozuzGXzQhW+JDKuKGQ0aSEzEkt8nSfCc2T7ZCsSutdWYhQBTTz9bZVedAHf+zS9bMw+yuz9VmbUVoKTFNIsHI8yfzjIQJxs5+0W66xF33/50+5mvi3E4unEcjgeK5Ny20fYpHOc9fB8lY1ZZywPNxFeD22wQHibVTDcCqmnFN9jWD6KRNnx9OgEu+S6WEOq6heTDjawhRB2Ej4UJYZNvB+PzsmRGnO4Go4ybIGBwEejB6IhYkJBeCDQfqHNzKZGxps+LMAACx/wpRixlJC5JUeLV/FNEwNGjprsSxFidPwdmAfp9LUqdgkr+1KEWK6QV2Omy7NlYjoJmyvk1IoRkysQFce1nmIkbKPVTEPENGpNEXMik2yZ2GEmJfnqLSpGzKTV72IOxT63TGznSwVrlHwpQ0xnXMC8FQ2xRPqwaVLABCLbcmZYUIyYfz/4lE6kr1QqMc/GMk5Ww6Rg6/WtMGDhA74UTUlnDP1XBoyWGCVmtrjm+bE09ZYPtplclgELH4rnSqoMUjbzWafDYvuYLxbY0ub7uhjYwBYYwg7DR1uqC3IsIIfj1DeDoxw5TeM/aEbqyYu3r7uT2J1rN9pG/OR1Sad7rCkQz4vFoyPu5tVZpuZ/7aJwVGSvlt5AL+JzR5bSpDUelO+ng8jxd5ekM2j18Y7tMUrqzzGvh3zoHWv0eLZGukrSNj3rGDFqLO5SlZCq5E0vlUN75aXDqORHLxoPVBIp2HZsj6GjPj/knimJoieZTWnf+T/U2FBnnrVbbDPNdN+KXBe+vcDq8IDD5rQOvTTpDGl0Qhj4jGfQweavXBdStXD75xJaLqP/RLjTvzpPCrHvAgwAWXdfzZzldn8AAAAASUVORK5CYII="},"Dh/N":function(t,e,i){"use strict";i.d(e,"d",function(){return s}),i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o}),i.d(e,"c",function(){return l});var a=i("t3Un");function s(t){return Object(a.a)({url:"oa/event/index",method:"post",data:t})}function n(t){return Object(a.a)({url:"oa/event/save",method:"post",data:t})}function o(t){return Object(a.a)({url:"oa/event/delete",method:"post",data:t})}function l(t){return Object(a.a)({url:"oa/event/update",method:"post",data:t})}},F1nN:function(t,e,i){"use strict";var a=i("Dd9w");i.n(a).a},FGFj:function(t,e,i){"use strict";i.r(e);var a=i("QbLZ"),s=i.n(a),n=i("uKQN"),o=i("MT78"),l=i.n(o),c=i("t3Un");function r(t){return Object(c.a)({url:"crm/index/indexList",method:"post",data:t})}var d=i("UcQx"),u=i("KzkL"),m=i("7Qib"),h=i("L2JU"),p=i("4peS"),f=i.n(p),v=i("wd/R"),g=i.n(v),b=i("JXju"),y=i("3yi6"),w=i("Ew9n"),_={name:"RecordList",components:{FollowRecordCell:y.a,SlideView:w.a,CRMFullScreenDetail:function(){return i.e("chunk-f93ad28").then(i.bind(null,"uMjE"))}},filters:{crmIconClass:function(t){return t&&t.replace("crm_","wukong-")}},props:{crmType:String,params:Object,listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,relationID:"",relationCrmType:""}},computed:{crmIcon:function(){return"customer"===this.crmType?i("xEAD"):"leads"===this.crmType?i("tJsa"):"business"===this.crmType?i("b66W"):"contacts"===this.crmType?i("lY9J"):"contract"===this.crmType?i("zKg5"):"receivables"===this.crmType?i("E1kK"):"product"===this.crmType?i("tmLs"):""}},watch:{params:function(){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},methods:{refreshList:function(){this.page=1,this.list=[],this.getList()},getList:function(){var t=this;this.loading=!0,function(t){return Object(c.a)({url:"crm/index/getRecordList",method:"post",data:t})}(s()({page:this.page,limit:15},this.params)).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<15?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.isPost=!1,t.loading=!1}).catch(function(){t.isPost=!1,t.loading=!1})},cellHandle:function(t){"delete"==t.type&&(this.list.splice(t.data.index,1),this.$emit("handle"))},checkRelationDetail:function(t,e){this.relationID=e,this.relationCrmType=t.replace("crm_",""),this.showFullDetail=!0},hideView:function(){this.$emit("hide")}}},C=(i("rNzn"),i("KHd+")),A=Object(C.a)(_,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("slide-view",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-view",attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"}},on:{"side-close":t.hideView}},[a("flexbox",{staticClass:"t-section"},[a("img",{staticClass:"t-img",attrs:{src:t.crmIcon}}),t._v(" "),a("div",{staticClass:"t-name"},[t._v("跟进记录")]),t._v(" "),a("img",{staticClass:"t-close",attrs:{src:i("cjwK")},on:{click:t.hideView}})]),t._v(" "),a("div",{staticClass:"t-content",attrs:{id:"follow-log-content"}},[t._l(t.list,function(e,i){return a("follow-record-cell",{key:i,attrs:{item:e,"crm-type":t.crmType,index:i},on:{"on-handle":t.cellHandle}},[a("flexbox",{staticClass:"relate-cell",nativeOn:{click:function(i){t.checkRelationDetail(e.types,e.types_id)}}},[a("i",{staticClass:"wukong relate-cell-head crm-type",class:t._f("crmIconClass")(e.types)}),t._v(" "),a("div",{staticClass:"relate-cell-body",staticStyle:{color:"#6394E5",cursor:"pointer"}},[t._v(t._s(e.types_name))])])],1)}),t._v(" "),a("div",{staticClass:"load"},[a("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2),t._v(" "),a("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.relationCrmType,id:t.relationID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"14a5157c",null);A.options.__file="recordList.vue";var I=A.exports,D={name:"ReportList",components:{CRMAllDetail:b.a,RecordList:I},props:{padding:{type:String,default:"0"},title:String,placeholder:{type:String,default:"请输入搜索内容"},crmType:String,fieldList:Array,request:{type:Function,required:!0},params:Object},data:function(){return{zIndex:Object(m.g)(),inputContent:"",loading:!1,tableHeight:document.documentElement.clientHeight-115,list:[],showFieldList:[],sortData:{},currentPage:1,pageSize:f.a.get("crmPageSizes")||15,pageSizes:[15,30,60,100],total:0,rowID:"",rowType:"",showDview:!1,formatterRules:{},recordParams:{},recordShow:!1}},computed:s()({},Object(h.b)(["crm","CRMConfig"]),{showPoolDayField:function(){return"customer"==this.crmType&&1==this.CRMConfig.config},showExamineStatus:function(){return"contract"==this.crmType&&"receivables"==this.crmType},sortable:function(){return(!this.fieldList||!this.fieldList.length)&&"custom"},showFillColumn:function(){return!this.fieldList||!this.fieldList.length},showPagination:function(){return!this.fieldList||!this.fieldList.length}}),mounted:function(){document.body.appendChild(this.$el),window.onresize=function(){self.tableHeight=document.documentElement.clientHeight-115},this.fieldList?(this.showFieldList=this.fieldList,this.getList()):this.getFieldList()},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{searchInput:function(){this.currentPage=1,this.getList()},getList:function(){var t=this;this.loading=!0;var e={page:this.currentPage,limit:this.pageSize,search:this.inputContent,types:"crm_"+this.crmType};this.sortData.order&&(e.order_field=this.sortData.prop,e.order_type="ascending"==this.sortData.order?"asc":"desc"),this.request(s()({},e,this.params)).then(function(e){e.data.list?(t.list=e.data.list,t.total=e.data.dataCount):t.list=e.data,t.loading=!1}).catch(function(){t.loading=!1})},getFieldList:function(){var t=this;if(0==this.showFieldList.length){this.loading=!0;var e="business_status"==this.crmType?"business":this.crmType,i={types:"crm_"+e,module:"crm",action:"index"};i.controller=e,Object(u.v)(i).then(function(e){for(var i=0;i<e.data.length;i++){var a=e.data[i];"date"===a.form_type?t.formatterRules[a.field]={formatter:function(t){return"0000-00-00"==t&&(t=""),t}}:"datetime"===a.form_type?t.formatterRules[a.field]={formatter:function(t){return 0!=t&&t?g()(Object(m.e)(t)).format("YYYY-MM-DD HH:mm:ss"):""}}:"create_user_id"===a.field||"owner_user_id"===a.field?t.formatterRules[a.field]={type:"crm",formatter:function(t){return t?t.realname:""}}:"user"===a.form_type?t.formatterRules[a.field]={type:"crm",formatter:function(t){if(t){for(var e="",i=0;i<t.length;i++){e=e+t[i].realname+(i===t.length-1?"":",")}return e}return""}}:"structure"===a.form_type?t.formatterRules[a.field]={type:"crm",formatter:function(t){if(t){for(var e="",i=0;i<t.length;i++){e=e+t[i].name+(i===t.length-1?"":",")}return e}return""}}:"contacts_id"===a.field||"customer_id"===a.field||"business_id"===a.field||"contract_id"===a.field?t.formatterRules[a.field]={type:"crm",formatter:function(t){return t?t.name:""}}:"status_id"!==a.field&&"type_id"!==a.field&&"category_id"!==a.field||(t.formatterRules[a.field]={type:"crm",formatter:function(t){return t||""}});var s=0;s=a.width?a.width:a.name&&a.name.length<=6?15*a.name.length+45:140,t.showFieldList.push({prop:a.field,label:a.name,width:s})}t.getList()}).catch(function(){t.loading=!1})}else this.getList()},fieldFormatter:function(t,e){var i=this.formatterRules[e.property];return i?"crm"===i.type?e.property?i.formatter(t[e.property+"_info"])||"--":"":i.formatter(t[e.property])||"--":this.fieldList&&this.fieldList.length&&"types"==e.property?{crm_leads:"线索",crm_customer:"客户",crm_contacts:"联系人",crm_business:"商机",crm_contract:"合同"}[t[e.property]]:t[e.property]||"--"},sortChange:function(t,e,i){this.sortData=t,this.getList()},handleSizeChange:function(t){f.a.set("crmPageSizes",t),this.pageSize=t,this.getList()},handleCurrentChange:function(t){this.currentPage=t,this.getList()},getStatusStyle:function(t){return 0==t?{"border-color":"#E6A23C","background-color":"#FDF6EC",color:"#E6A23C"}:1==t?{"border-color":"#409EFF","background-color":"#ECF5FF",color:"#409EFF"}:2==t?{"border-color":"#67C23A","background-color":"#F0F9EB",color:"#67C23A"}:3==t?{"border-color":"#F56C6B","background-color":"#FEF0F0",color:"#F56C6B"}:4==t?{"background-color":"#FFFFFF"}:void 0},handleRowClick:function(t,e,i){"leads"===this.crmType?"name"===e.property?(this.rowID=t.leads_id,this.showDview=!0):this.showDview=!1:"customer"===this.crmType?"name"===e.property?(this.rowID=t.customer_id,this.rowType="customer",this.showDview=!0):this.showDview=!1:"contacts"===this.crmType?"customer_id"===e.property?(this.rowID=t.customer_id_info.customer_id,this.rowType="customer",this.showDview=!0):"name"===e.property?(this.rowID=t.contacts_id,this.rowType="contacts",this.showDview=!0):this.showDview=!1:"business"===this.crmType||"business_status"===this.crmType?"customer_id"===e.property?(this.rowID=t.customer_id_info.customer_id,this.rowType="customer",this.showDview=!0):"name"===e.property?(this.rowID=t.business_id,this.rowType="business",this.showDview=!0):this.showDview=!1:"contract"===this.crmType?"customer_id"===e.property?(this.rowID=t.customer_id_info.customer_id,this.rowType="customer",this.showDview=!0):"business_id"===e.property?(this.rowID=t.business_id_info.business_id,this.rowType="business",this.showDview=!0):"contacts_id"===e.property?(this.rowID=t.contacts_id_info.contacts_id,this.rowType="contacts",this.showDview=!0):"num"===e.property?(this.rowID=t.contract_id,this.rowType="contract",this.showDview=!0):this.showDview=!1:"product"===this.crmType?"name"===e.property?(this.rowID=t.product_id,this.showDview=!0):this.showDview=!1:"receivables"===this.crmType?"customer_id"===e.property?(this.rowID=t.customer_id_info.customer_id,this.rowType="customer",this.showDview=!0):"contract_id"===e.property?(this.rowID=t.contract_id,this.rowType="contract",this.showDview=!0):"number"===e.property?(this.rowID=t.receivables_id,this.rowType="receivables",this.showDview=!0):this.showDview=!1:"record"===this.crmType&&("dataCount"===e.property&&t.dataCount?(this.rowType=t.types.replace("crm_",""),this.recordParams=t,this.recordShow=!0):this.recordShow=!1)},handleHandle:function(t){"alloc"!==t.type&&"get"!==t.type&&"transfer"!==t.type&&"transform"!==t.type&&"delete"!==t.type&&"put_seas"!==t.type||(this.showDview=!1),"edit"!==t.type&&this.getList()},cellStyle:function(t){var e=t.row,i=t.column;t.rowIndex,t.columnIndex;return"name"!==i.property&&"num"!==i.property&&"number"!==i.property&&"customer_id"!==i.property&&"business_id"!==i.property&&"contacts_id"!==i.property&&"dataCount"!==i.property||!e[i.property]?"":{color:"#3E84E9",cursor:"pointer"}},hideView:function(){this.$emit("hide")}}},x=(i("+gwU"),Object(C.a)(D,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("transition",{attrs:{name:"opacity-fade"}},[a("div",{staticClass:"container",style:{padding:t.padding+" 0","z-index":t.zIndex}},[a("div",{staticClass:"content"},[a("div",{staticClass:"header",on:{click:function(e){t.showDview=!1}}},[a("span",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),t.placeholder?a("el-input",{staticClass:"search-input",attrs:{placeholder:t.placeholder},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.searchInput(e):null}},model:{value:t.inputContent,callback:function(e){t.inputContent=e},expression:"inputContent"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},nativeOn:{click:function(e){return t.searchInput(e)}},slot:"append"})],1):t._e(),t._v(" "),a("img",{staticClass:"close",attrs:{src:i("cjwK")},on:{click:t.hideView}})],1),t._v(" "),a("div",{staticClass:"list-body"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"crm-table",data:t.list,height:t.tableHeight,"cell-style":t.cellStyle,stripe:"",border:"","highlight-current-row":""},on:{"row-click":t.handleRowClick,"sort-change":t.sortChange}},[t._l(t.showFieldList,function(e,i){return a("el-table-column",{key:i,attrs:{sortable:t.sortable,fixed:0==i,prop:e.prop,label:e.label,width:e.width,formatter:t.fieldFormatter,"show-overflow-tooltip":""},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}}])})}),t._v(" "),t.showPoolDayField?a("el-table-column",{attrs:{resizable:!1,prop:"pool_day","show-overflow-tooltip":"",label:"距进入公海天数",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.is_pool?a("div",[t._v("--")]):-1!=e.row.pool_day?a("div",[t._v(t._s(e.row.pool_day))]):a("i",{staticClass:"wukong wukong-lock customer-lock"})]}}])}):t._e(),t._v(" "),t.showExamineStatus?a("el-table-column",{attrs:{resizable:!1,"show-overflow-tooltip":"",prop:"check_status_info",label:"状态",width:"100",align:"center",fixed:"right"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("div",{staticClass:"table-head-name"},[t._v(t._s(e.column.label))])]}},{key:"default",fn:function(e){return[a("div",{staticClass:"status_button",style:t.getStatusStyle(e.row.check_status)},[t._v("\n                "+t._s(e.row.check_status_info)+"\n              ")])]}}])}):t._e(),t._v(" "),t.showFillColumn?a("el-table-column"):t._e()],2),t._v(" "),t.showPagination?a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":t.currentPage,"page-sizes":t.pageSizes,"page-size":t.pageSize,total:t.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(e){t.pageSize=e},"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)]),t._v(" "),a("c-r-m-all-detail",{staticClass:"d-view",attrs:{visible:t.showDview,"crm-type":t.rowType,id:t.rowID},on:{"update:visible":function(e){t.showDview=e},handle:t.handleHandle}}),t._v(" "),t.recordShow?a("record-list",{attrs:{"crm-type":t.rowType,params:t.recordParams},on:{handle:t.getList,hide:function(e){t.recordShow=!1}}}):t._e()],1)])},[],!1,null,"3a14569e",null));x.options.__file="index.vue";var k={name:"CustomerDash",components:{ReportList:x.exports},props:{data:Object},data:function(){return{jianbaoLoading:!1,jianbaoItems:[{title:"新增客户",icon:i("gKxd"),field:"customerNum",type:"customer",value:0},{title:"新增联系人",icon:i("dcF1"),field:"contactsNum",type:"contacts",value:0},{title:"新增商机",icon:i("DfqB"),field:"businessNum",type:"business",value:0},{title:"阶段变化的商机",icon:i("wzRw"),field:"businessStatusNum",type:"business_status",value:0},{title:"新增合同",icon:i("ZmKI"),field:"contractNum",type:"contract",value:0},{title:"新增跟进记录",icon:i("/tO9"),field:"recordNum",type:"record",value:0},{title:"新增回款",icon:i("YIul"),field:"receivablesNum",type:"receivables",value:0}],showReportList:!1,fieldReportList:null,reportData:{title:"",placeholder:"",crmType:"",request:null,params:null},gaugeLoading:!1,gaugeSelectValue:2,gaugeData:{contractMoney:0,receivablesMoney:0,achievementMoney:0},funnelLoading:!1,businessOptions:[],businessStatusValue:"",funnelData:{sum_ying:0,sum_shu:0},trendLoading:!1,trendData:{totlaContractMoney:0,totlaReceivablesMoney:0},gaugeChart:null,gaugeOption:null,funnelChart:null,funnelOption:null,axisChart:null,axisOption:null}},computed:{gaugeOptions:function(){return[{label:"回款金额",value:2},{label:"合同金额",value:1}]}},watch:{data:function(t){this.getCrmIndexIndex(),this.getBusinessStatusList(),this.getCrmIndexAchievementData(),this.getCrmIndexSaletrend()}},mounted:function(){this.initGauge(),this.initFunnel(),this.initAxis(),(this.data.users.length>0||this.data.users.strucs>0)&&(this.getCrmIndexIndex(),this.getBusinessStatusList(),this.getCrmIndexAchievementData(),this.getCrmIndexSaletrend())},methods:{getCrmIndexIndex:function(){var t=this;this.jianbaoLoading=!0,function(t){return Object(c.a)({url:"crm/index/index",method:"post",data:t})}(this.getBaseParams()).then(function(e){for(var i=0;i<t.jianbaoItems.length;i++){var a=t.jianbaoItems[i];a.value=e.data[a.field]?e.data[a.field]:0}t.jianbaoLoading=!1}).catch(function(){t.jianbaoLoading=!1})},reportClick:function(t){t.type&&(this.reportData.title="销售简报-"+t.title,this.reportData.placeholder={customer:"请输入客户名称/手机/电话",contacts:"请输入联系人姓名/手机/电话",business:"请输入商机名称",business_status:"请输入商机名称",contract:"请输入合同名称",receivables:"请输入回款编号",record:""}[t.type],"record"==t.type?this.fieldReportList=[{label:"模块",prop:"types",width:300},{label:"新增跟进记录数",prop:"dataCount"}]:this.fieldReportList=null,this.reportData.crmType=t.type,this.reportData.request=r,this.reportData.params=this.getBaseParams(),this.showReportList=!0)},getBaseParams:function(){var t={user_id:this.data.users.map(function(t,e,i){return t.id}),structure_id:this.data.strucs.map(function(t,e,i){return t.id})};return this.data.timeTypeValue.type&&("custom"==this.data.timeTypeValue.type?(t.start_time=this.data.timeTypeValue.startTime,t.end_time=this.data.timeTypeValue.endTime):t.type=this.data.timeTypeValue.value||""),t},getCrmIndexAchievementData:function(){var t=this;this.gaugeLoading=!0;var e=this.getBaseParams();e.status=this.gaugeSelectValue,function(t){return Object(c.a)({url:"crm/index/achievementData",method:"post",data:t})}(e).then(function(e){t.gaugeData=e.data,t.gaugeOption.series[0].data[0].value=e.data.rate,t.gaugeChart.setOption(t.gaugeOption,!0),t.gaugeLoading=!1}).catch(function(){t.gaugeLoading=!1})},initGauge:function(){var t=l.a.init(document.getElementById("gaugemain")),e={tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[{type:"gauge",detail:{formatter:"{value}%",fontSize:20,fontWeight:"bold",color:"#5F879D"},data:[{value:0,name:"完成率"}],axisLine:{lineStyle:{width:15,color:[[.2,"#FF7474"],[.8,"#FECD51"],[1,"#48E78D"]]}},splitLine:{length:13,lineStyle:{width:0}},axisTick:{show:!1},axisLabel:{fontSize:9},pointer:{length:"70%",width:4},itemStyle:{color:"#5F879D"},title:{fontSize:13,color:"#666"}}]};t.setOption(e,!0),this.gaugeOption=e,this.gaugeChart=t},getBusinessStatusList:function(){var t=this;this.funnelLoading=!0,Object(d.h)({}).then(function(e){t.funnelLoading=!1,t.businessOptions=e.data,e.data.length>0&&(t.businessStatusValue=e.data[0].type_id,t.getBusinessStatustatistics())}).catch(function(){t.funnelLoading=!1})},getBusinessStatustatistics:function(){var t=this;if(this.businessStatusValue){this.funnelLoading=!0;var e=this.getBaseParams();e.type_id=this.businessStatusValue,function(t){return Object(c.a)({url:"crm/index/funnel",method:"post",data:t})}(e).then(function(e){t.funnelLoading=!1;for(var i=[],a=0;a<e.data.list.length;a++){var s=e.data.list[a];i.push({name:s.status_name+"("+s.count+")",value:s.money})}t.funnelData=e.data,t.funnelOption.series[0].data=i,t.funnelOption.series[0].max=e.data.sum_money<1?1:e.data.sum_money,t.funnelChart.setOption(t.funnelOption,!0)}).catch(function(){t.funnelLoading=!1})}else this.getBusinessStatusList()},initFunnel:function(){var t=l.a.init(document.getElementById("funnelmain")),e={tooltip:{trigger:"item",formatter:"{b} <br/> 预测金额: {c}元"},calculable:!0,grid:{left:0,right:0,bottom:0,top:0},series:[{type:"funnel",left:"35%",width:"45%",sort:"none",gap:2,min:0,max:100,label:{normal:{show:!0,position:"right"},emphasis:{textStyle:{fontSize:20}}},labelLine:{normal:{length:20,lineStyle:{width:1,type:"solid"}}},itemStyle:{color:function(t){return["#6CA2FF","#6AC9D7","#72DCA2","#DBB375","#E164F7","#FF7474","#FFB270","#FECD51"][t.dataIndex%8]}},data:[]}]};t.setOption(e,!0),this.funnelOption=e,this.funnelChart=t},getCrmIndexSaletrend:function(){var t=this;this.trendLoading=!0,function(t){return Object(c.a)({url:"crm/index/saletrend",method:"post",data:t})}(this.getBaseParams()).then(function(e){t.trendData=e.data;for(var i=e.data.list||[],a=[],s=[],n=[],o=0;o<i.length;o++){var l=i[o];a.push(l.contractMoney),s.push(l.receivablesMoney),n.push(l.type)}t.axisOption.xAxis[0].data=n,t.axisOption.series[0].data=a,t.axisOption.series[1].data=s,t.axisChart.setOption(t.axisOption,!0),t.trendLoading=!1}).catch(function(){t.trendLoading=!1})},initAxis:function(){var t=l.a.init(document.getElementById("axismain")),e={color:["#6ca2ff","#ff7474"],tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{top:"5px",left:"20px",right:"20px",bottom:"20px",containLabel:!0,borderColor:"#fff"},xAxis:[{type:"category",data:[],axisTick:{alignWithLabel:!0,lineStyle:{width:0}},axisLabel:{color:"#BDBDBD"},axisLine:{lineStyle:{color:"#BDBDBD"}},splitLine:{show:!1}}],yAxis:[{type:"value",axisTick:{alignWithLabel:!0,lineStyle:{width:0}},axisLabel:{color:"#BDBDBD"},axisLine:{lineStyle:{color:"#BDBDBD"}},splitLine:{show:!1}}],series:[{name:"合同金额",type:"bar",stack:"one",barWidth:10,data:[]},{name:"回款金额",type:"bar",stack:"one",barWidth:10,data:[]}]};t.setOption(e,!0),this.axisOption=e,this.axisChart=t}}},R=(i("kHDV"),Object(C.a)(k,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-bottom":"20px","min-width":"800px"}},[a("flexbox",{attrs:{gutter:0,wrap:"wrap"}},[a("flexbox-item",{directives:[{name:"loading",rawName:"v-loading",value:t.jianbaoLoading,expression:"jianbaoLoading"}],staticStyle:{"padding-right":"10px","padding-bottom":"20px"},attrs:{span:.5}},[a("div",{staticClass:"card",staticStyle:{height:"350px"}},[a("flexbox",{staticClass:"mark-header"},[a("img",{staticClass:"img-mark",attrs:{src:i("Ty3d")}}),t._v("销售简报")]),t._v(" "),a("flexbox",{attrs:{gutter:0,wrap:"wrap"}},t._l(t.jianbaoItems,function(e,i){return a("flexbox-item",{key:i,staticClass:"jianbao-icon-container",attrs:{span:.5},nativeOn:{click:function(i){t.reportClick(e)}}},[a("flexbox",{staticClass:"jianbao-icon-content",style:{cursor:e.type?"pointer":"auto"}},[a("img",{staticClass:"jianbao-icon",attrs:{src:e.icon}}),t._v(" "),a("div",{staticClass:"jianbao-title"},[t._v(t._s(e.title))]),t._v(" "),a("div",{staticClass:"jianbao-value"},[t._v(t._s(e.value))])])],1)}))],1)]),t._v(" "),a("flexbox-item",{directives:[{name:"loading",rawName:"v-loading",value:t.gaugeLoading,expression:"gaugeLoading"}],staticStyle:{"padding-left":"10px","padding-bottom":"20px"},attrs:{span:.5}},[a("div",{staticClass:"card",staticStyle:{height:"350px"}},[a("flexbox",{staticClass:"mark-header"},[a("img",{staticClass:"img-mark",attrs:{src:i("2vYz")}}),t._v("业绩指标")]),t._v(" "),a("flexbox",{staticClass:"gaugeSelect"},[a("el-select",{staticStyle:{display:"block",width:"100px"},attrs:{placeholder:"请选择"},on:{change:t.getCrmIndexAchievementData},model:{value:t.gaugeSelectValue,callback:function(e){t.gaugeSelectValue=e},expression:"gaugeSelectValue"}},t._l(t.gaugeOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("div",{staticClass:"gauge",attrs:{id:"gaugemain"}}),t._v(" "),a("flexbox",{staticClass:"target-items",attrs:{justify:"center"}},[a("div",{staticClass:"target-item"},[a("div",{staticClass:"name"},[t._v("目标")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.gaugeData.achievementMoney)+"元")])]),t._v(" "),a("div",{staticClass:"target-item"},[a("div",{staticClass:"name"},[t._v("合同金额")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.gaugeData.contractMoney)+"元")])]),t._v(" "),a("div",{staticClass:"target-item"},[a("div",{staticClass:"name"},[t._v("回款金额")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.gaugeData.receivablesMoney)+"元")])])])],1)]),t._v(" "),a("flexbox-item",{directives:[{name:"loading",rawName:"v-loading",value:t.funnelLoading,expression:"funnelLoading"}],staticStyle:{"padding-right":"10px","padding-bottom":"20px"},attrs:{span:.5}},[a("div",{staticClass:"card",staticStyle:{height:"400px"}},[a("flexbox",{staticClass:"mark-header"},[a("img",{staticClass:"img-mark",attrs:{src:i("Z4QE")}}),t._v("销售漏斗\n        ")]),t._v(" "),a("flexbox",{staticClass:"funnelSelect"},[a("el-select",{attrs:{placeholder:"商机组"},on:{change:t.getBusinessStatustatistics},model:{value:t.businessStatusValue,callback:function(e){t.businessStatusValue=e},expression:"businessStatusValue"}},t._l(t.businessOptions,function(t){return a("el-option",{key:t.type_id,attrs:{label:t.name,value:t.type_id}})}))],1),t._v(" "),a("div",{staticClass:"funnel",attrs:{id:"funnelmain"}}),t._v(" "),a("div",{staticClass:"funnel-label"},[a("div",[t._v("赢单："+t._s(t.funnelData.sum_ying)+"元")]),t._v(" "),a("div",[t._v("输单："+t._s(t.funnelData.sum_shu)+"元")])])],1)]),t._v(" "),a("flexbox-item",{directives:[{name:"loading",rawName:"v-loading",value:t.trendLoading,expression:"trendLoading"}],staticStyle:{"padding-left":"10px","padding-bottom":"20px"},attrs:{span:.5}},[a("div",{staticClass:"card",staticStyle:{height:"400px"}},[a("flexbox",{staticClass:"mark-header"},[a("img",{staticClass:"img-mark",attrs:{src:i("cXmQ")}}),t._v("销售趋势")]),t._v(" "),a("flexbox",{staticStyle:{position:"relative"}},[a("div",{staticClass:"trend-target-item"},[a("div",{staticClass:"name"},[t._v("合同金额")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.trendData.totlaContractMoney)+"元")])]),t._v(" "),a("div",{staticClass:"trend-target-item"},[a("div",{staticClass:"name"},[t._v("回款金额")]),t._v(" "),a("div",{staticClass:"value"},[t._v(t._s(t.trendData.totlaReceivablesMoney)+"元")])])]),t._v(" "),a("div",{staticClass:"trend-label"},[a("flexbox",{staticClass:"label-item"},[a("div",{staticClass:"label-item-mark",staticStyle:{"background-color":"#6ca2ff"}}),t._v(" "),a("div",{staticClass:"label-item-name"},[t._v("合同金额")])]),t._v(" "),a("flexbox",{staticClass:"label-item",staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"label-item-mark",staticStyle:{"background-color":"#ff7474"}}),t._v(" "),a("div",{staticClass:"label-item-name"},[t._v("回款金额")])])],1),t._v(" "),a("div",{staticClass:"axismain-content"},[a("div",{attrs:{id:"axismain"}})])],1)])],1),t._v(" "),t.showReportList?a("report-list",{attrs:{title:t.reportData.title,placeholder:t.reportData.placeholder,"crm-type":t.reportData.crmType,request:t.reportData.request,params:t.reportData.params,"field-list":t.fieldReportList},on:{hide:function(e){t.showReportList=!1}}}):t._e()],1)},[],!1,null,"530a2920",null));R.options.__file="CustomerDash.vue";var T=R.exports,E=i("ViDN"),N={name:"CheckContent",components:{XhInput:i("8GhS").g,CRMAllDetail:b.a},props:{type:{required:!0,type:String}},data:function(){return{conditionList:this.getConditionList(),currentPage:1,total:1,loading:!1,list:[],rowID:"",rowType:"",showDview:!1}},computed:{fieldList:function(){return"customer"==this.type?[{name:"客户名称",field:"name"},{name:"负责人",field:"owner_user_id"}]:"contacts"==this.type?[{name:"姓名",field:"name"},{name:"客户名称",field:"customer_name"},{name:"负责人",field:"owner_user_id"}]:"leads"==this.type?[{name:"线索名称",field:"name"},{name:"负责人",field:"owner_user_id"}]:[]}},watch:{},mounted:function(){},destroyed:function(){},methods:{getList:function(){var t=this;this.loading=!0;for(var e={page:this.currentPage,limit:10,types:"crm_"+this.type},i=!1,a=0;a<this.conditionList.length;a++){var s=this.conditionList[a];e[s.field]=s.value,s.value&&(i=!0)}i?Object(u.i)(e).then(function(e){t.list=e.data.dataList,t.total=e.data.dataCount,t.loading=!1}).catch(function(){t.loading=!1}):this.$message.error("查询条件不能为空")},fieldFormatter:function(t,e){return"owner_user_id"==e.property?t[e.property+"_info"].realname:t[e.property]},getPaddingLeft:function(t,e){return e%2==0?"0":"30px"},getPaddingRight:function(t,e){return e%2==0?"30px":"0"},getConditionList:function(){var t="为确保客户信息安全性，客户名称字段增加了防作弊机制，以<br />\n                下关键词为禁搜关键词：<br />\n                1.省、市名；<br />\n                2.中国、公司、有限公司、有限责任公司、股份有限公司；";return"customer"==this.type?[{name:"客户名称",field:"name",value:"",showTips:!0,tips:t},{name:"手机",field:"mobile",value:""},{name:"电话",field:"telephone",value:""}]:"contacts"==this.type?[{name:"联系人",field:"name",value:""},{name:"客户名称",field:"customer_name",value:"",showTips:!0,tips:t},{name:"手机",field:"mobile",value:""},{name:"电话",field:"telephone",value:""}]:"leads"==this.type?[{name:"线索名称",field:"name",value:"",showTips:!0,tips:"为确保客户信息安全性，线索名称字段增加了防作弊机制，以<br />\n                下关键词为禁搜关键词：<br />\n                1.省、市名；<br />\n                2.中国、公司、有限公司、有限责任公司、股份有限公司；"},{name:"手机",field:"mobile",value:""},{name:"电话",field:"telephone",value:""}]:[]},handleRowClick:function(t,e,i){"name"==e.property?(this.rowID=t[this.type+"_id"],this.rowType=this.type,this.showDview=!0):"customer_name"==e.property&&(this.rowID=t.customer_id,this.rowType="customer",this.showDview=!0)},cellStyle:function(t){t.row;var e=t.column;t.rowIndex,t.columnIndex;return"name"===e.property||"customer_name"===e.property?{color:"#3E84E9",cursor:"pointer"}:""}}},M=(i("LNGP"),Object(C.a)(N,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"check-container"},[i("div",{staticClass:"condition-content"},[i("el-form",{staticClass:"condition-items",attrs:{"label-position":"top"}},t._l(t.conditionList,function(e,a){return i("el-form-item",{key:e.field,staticClass:"condition-item",style:{"padding-left":t.getPaddingLeft(e,a),"padding-right":t.getPaddingRight(e,a)}},[i("div",{staticClass:"form-label",attrs:{slot:"label"},slot:"label"},[t._v("\n          "+t._s(e.name)+"\n          "),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[i("div",{staticStyle:{"line-height":"20px"},attrs:{slot:"content"},domProps:{innerHTML:t._s(e.tips)},slot:"content"}),t._v(" "),e.showTips?i("i",{staticClass:"wukong wukong-help_tips"}):t._e()])],1),t._v(" "),i("el-input",{attrs:{type:"text"},model:{value:e.value,callback:function(i){t.$set(e,"value",i)},expression:"item.value"}})],1)})),t._v(" "),i("el-button",{staticClass:"condition-button",attrs:{type:"primary"},on:{click:t.getList}},[t._v("查询")])],1),t._v(" "),i("div",{staticClass:"table-content"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{id:"crm-table",data:t.list,"cell-style":t.cellStyle,height:"400",stripe:"",border:"","highlight-current-row":""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.field,label:e.name,formatter:t.fieldFormatter,"show-overflow-tooltip":""}})})),t._v(" "),i("div",{staticClass:"p-contianer"},[i("el-pagination",{attrs:{"current-page":t.currentPage,total:t.total,layout:"prev, pager, next"},on:{"update:currentPage":function(e){t.currentPage=e},"current-change":t.getList}})],1)],1),t._v(" "),i("c-r-m-all-detail",{attrs:{visible:t.showDview,"crm-type":t.rowType,id:t.rowID,"listener-ids":["duplicate-check-container"]},on:{"update:visible":function(e){t.showDview=e}}})],1)},[],!1,null,"8e29fcac",null));M.options.__file="checkContent.vue";var L=M.exports,j={name:"DuplicateCheck",components:{CreateView:E.a,CheckContent:L},props:{},data:function(){return{tabActiveName:"customer",tabList:[{label:"客户",name:"customer"},{label:"联系人",name:"contacts"},{label:"线索",name:"leads"}]}},computed:{},watch:{},mounted:function(){document.body.appendChild(this.$el)},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hidenView:function(){this.$emit("hiden-view")}}},S=(i("23D1"),Object(C.a)(j,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("create-view",{attrs:{id:"duplicate-check-container","body-style":{height:"100%"}}},[a("div",{staticClass:"container"},[a("div",{staticClass:"header"},[t._v("\n      查重工具\n      "),a("img",{staticClass:"close",attrs:{src:i("cjwK")},on:{click:t.hidenView}})]),t._v(" "),a("el-tabs",{staticClass:"content",model:{value:t.tabActiveName,callback:function(e){t.tabActiveName=e},expression:"tabActiveName"}},t._l(t.tabList,function(t,e){return a("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}},[a("check-content",{attrs:{type:t.name}})],1)}))],1)])},[],!1,null,"0e393748",null));S.options.__file="index.vue";var G=S.exports,Z=i("utuE"),Y=i("KTTK"),B={name:"CustomerWorkbench",components:{CustomerDash:T,DuplicateCheck:G,membersDep:Z.a,timeTypeSelect:n.a},filters:{},data:function(){return{users:[],strucs:[],dashData:{users:[],strucs:[],timeTypeValue:{}},filtersInfo:{realname:"",thumb_img:""},timeTypeValue:{label:"本季度",value:"quarter"},showDuplicateCheck:!1}},computed:s()({},Object(h.b)(["userInfo"])),mounted:function(){this.users.push(this.userInfo),this.dashData={users:[],strucs:[],timeTypeValue:this.timeTypeValue},this.filtersInfo={realname:"本人及下属",thumb_img:i("AWtP")},this.getUserList()},methods:{getUserList:function(){var t=this;Object(Y.o)({by:"sub"}).then(function(e){t.users=e.data}).catch(function(){})},timeTypeChange:function(t){this.timeTypeValue=t,this.dashData={users:this.users,strucs:this.strucs,timeTypeValue:this.timeTypeValue}},popoverSubmit:function(t,e){if(this.users=t,this.strucs=e,1===this.users.length&&0===this.strucs.length)this.dashData={users:this.users,strucs:this.strucs,timeTypeValue:this.timeTypeValue},this.filtersInfo={realname:this.users[0].realname,thumb_img:this.users[0].thumb_img};else if(0===this.users.length&&0===this.strucs.length)this.users=[this.userInfo],this.dashData={users:this.users,strucs:this.strucs,timeTypeValue:this.timeTypeValue},this.filtersInfo={realname:this.userInfo.realname,thumb_img:this.userInfo.thumb_img};else{this.dashData={users:this.users,strucs:this.strucs,timeTypeValue:this.timeTypeValue};var a="";this.users.length>0&&(a=this.users.length+"个员工"),this.strucs.length>0&&(this.users.length>0&&(a+=","),a=a+this.strucs.length+"个部门"),this.filtersInfo={realname:a,thumb_img:i("AWtP")}}}}},O=(i("7JKO"),Object(C.a)(B,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("flexbox",{staticClass:"user-container"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.filtersInfo,expression:"filtersInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.filtersInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(filtersInfo.thumb_img)",arg:"background-image"}],key:t.filtersInfo.thumb_img,staticClass:"div-photo user-img"}),t._v(" "),i("div",[i("flexbox",{staticClass:"user-info"},[i("div",{staticClass:"user-name"},[t._v(t._s(t.filtersInfo.realname))]),t._v(" "),i("div",{staticClass:"user-line"}),t._v(" "),i("members-dep",{attrs:{"popover-display":"block","user-checked-data":t.users,"dep-checked-data":t.strucs},on:{popoverSubmit:t.popoverSubmit}},[i("el-button",{staticClass:"user-switch",attrs:{slot:"membersDep",type:"text"},slot:"membersDep"},[t._v("切换")])],1),t._v(" "),i("time-type-select",{on:{change:t.timeTypeChange}})],1)],1),t._v(" "),i("el-button",{staticClass:"check",attrs:{type:"primary",icon:"wukong wukong-check"},on:{click:function(e){t.showDuplicateCheck=!0}}},[t._v("数据查重")])],1),t._v(" "),i("customer-dash",{attrs:{data:t.dashData}}),t._v(" "),t.showDuplicateCheck?i("duplicate-check",{on:{"hiden-view":function(e){t.showDuplicateCheck=!1}}}):t._e()],1)},[],!1,null,"4c8ceead",null));O.options.__file="workbench.vue";e.default=O.exports},Fpl1:function(t,e,i){"use strict";var a=i("Er7M"),s=i("O1Uw"),n={name:"ExamineCell",components:{RelatedBusinessCell:a.a,FileCell:s.a},mixins:[],props:{data:Object},data:function(){return{}},computed:{relatedListData:function(){return{contacts:this.data.contactsList||[],customer:this.data.customerList||[],business:this.data.businessList||[],contract:this.data.contractList||[]}}},watch:{},mounted:function(){},methods:{getStatusName:function(t){return 0==t?"待审":1==t?"审批中":2==t?"通过":3==t?"拒绝":4==t?"撤回":""},getStatusColor:function(t){return 0==t?"#F3A633":1==t?"#F3A633":2==t?"#93E06D":3==t?"#FF0000":4==t?"#FF0000":""},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return{url:t.file_path,name:t.name}})})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkDetail:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})}}},o=(i("ZlMj"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"list"},[i("div",{staticClass:"list-content"},[i("flexbox",{staticClass:"header"},[i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],key:t.data.create_user_info.thumb_img,staticClass:"div-photo head-img"}),t._v(" "),i("div",{staticClass:"name-time"},[i("span",{staticClass:"name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),i("span",{staticClass:"time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.data.create_time)))])]),t._v(" "),i("div",{staticClass:"rt-setting"},[i("span",{staticClass:"bg-color",style:{"background-color":t.getStatusColor(t.data.check_status)}}),t._v(" "),i("span",{staticClass:"dep"},[i("span",[t._v(t._s(t.data.category_name)+" - ")]),t._v(" "),i("span",[t._v(t._s(t.getStatusName(t.data.check_status)))])]),t._v(" "),t.data.permission&&(t.data.permission.is_recheck||t.data.permission.is_update||t.data.permission.is_delete)?i("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[i("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission&&t.data.permission.is_recheck?i("el-dropdown-item",{attrs:{command:"withdraw"}},[t._v("撤回")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.is_update?i("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission&&t.data.permission.is_delete?i("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1):t._e()],1)]),t._v(" "),i("div",{staticClass:"row",on:{click:function(e){t.checkDetail(t.data)}}},[t.data.content?i("p",{staticClass:"text"},[t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.causeTitle?i("p",{staticClass:"title"},[t._v(t._s(t.data.causeTitle))]):t._e()]),t._v(" "),t.data.fileList.length>0||t.data.imgList.length>0?i("div",{staticClass:"accessory"},[i("div",{staticClass:"upload-img-box"},t._l(t.data.imgList,function(e,a){return i("div",{key:a,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.imgList,a)}}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.file_path_thumb,expression:"imgItem.file_path_thumb"}]})])})),t._v(" "),i("div",{staticClass:"accessory-box"},t._l(t.data.fileList,function(t,e){return i("file-cell",{key:e,attrs:{data:t,"cell-index":e}})}))]):t._e(),t._v(" "),t.relatedListData.contacts.length>0||t.relatedListData.customer.length>0||t.relatedListData.business.length>0||t.relatedListData.contract.length>0?i("div",{staticClass:"related-business"},[i("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.relatedListData,function(e,a){return i("div",{key:a},t._l(e,function(e,s){return i("related-business-cell",{key:s,attrs:{data:e,"cell-index":s,type:a,"show-foot":!1},nativeOn:{click:function(i){t.checkRelatedDetail(a,e)}}})}))})],2):t._e()],1)])},[],!1,null,"ebcab814",null);l.options.__file="examineCell.vue";e.a=l.exports},GE8g:function(t,e,i){"use strict";var a=i("+2MK");i.n(a).a},"GJP/":function(t,e,i){},GsUu:function(t,e,i){"use strict";var a=i("SvQs");i.n(a).a},GynS:function(t,e,i){"use strict";var a=i("fmM0");i.n(a).a},Iae0:function(t,e,i){"use strict";var a=i("QbLZ"),s=i.n(a),n=i("S3Kq"),o=i("Qldq"),l=i("1RnH"),c=i("Xjjk"),r=i.n(c),d=i("L2JU"),u=i("O1Uw"),m={name:"JournalCell",components:{emoji:n.a,relatedBusiness:l.a,FileCell:u.a},mixins:[],props:{data:Object,logIndex:{type:Number,default:0},showWorkbench:{type:Boolean,default:!1}},data:function(){return{commentsTextarea:"",childCommentsTextarea:"",commentsPopover:!1,replyChildComment:null,replyChildIndex:-1,childCommentsPopover:!1,blurIndex:0,contentLoading:!1,parentTarget:null,awaitMoment:!1}},computed:s()({},Object(d.b)(["userInfo"]),{allData:function(){var t={};return t.business=this.data.businessList||[],t.contacts=this.data.contactsList||[],t.contract=this.data.contractList||[],t.customer=this.data.customerList||[],t},allDataShow:function(){return!this.showWorkbench&&!!(this.data.businessList&&0!=this.data.businessList.length||this.data.contactsList&&0!=this.data.contactsList.length||this.data.contractList&&0!=this.data.contractList.length||this.data.customerList&&0!=this.data.customerList.length)}}),watch:{},mounted:function(){var t=this;0!=this.data.is_read||this.showWorkbench||(this.$bus.on("journal-list-box-scroll",function(e){t.observePreview(e)}),this.observePreview(document.getElementById("journal-cell"+this.logIndex).parentNode))},beforeDestroy:function(){this.$bus.off("journal-list-box-scroll")},methods:{observePreview:function(t){var e=this;if(0==this.data.is_read){t&&(this.parentTarget=t);var i=this.whetherPreview();!this.awaitMoment&&i&&(this.awaitMoment=!0,setTimeout(function(){e.awaitMoment=!1,e.whetherPreview()&&e.submiteIsRead()},3e3))}},whetherPreview:function(){var t=this.parentTarget.children[this.logIndex];if(this.parentTarget.getBoundingClientRect()){var e=this.parentTarget.getBoundingClientRect().top-t.getBoundingClientRect().top,i=!1;return e<=0&&Math.abs(e)<this.parentTarget.clientHeight?i=!0:e>0&&e<t.clientHeight&&(i=!0),i}return!1},submiteIsRead:function(){var t=this;Object(o.g)({log_id:this.showWorkbench?this.data.action_id:this.data.log_id}).then(function(e){t.data.is_read=1,t.$store.dispatch("GetOAMessageNum","log")}).catch(function(){})},verifyAwaitInfo:function(){},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})},checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},discussDelete:function(t,e,i){var a=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.b)({comment_id:t.comment_id,log_id:t.type_id}).then(function(t){a.$message({type:"success",message:"删除成功!"}),e.splice(i,1),a.$emit("on-handle",{type:"discuss-delete",data:{item:a.data}})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},discussBtn:function(t,e){t.show?(this.$set(t,"show",!1),this.replyChildComment=null):(this.$set(t,"show",!0),this.$set(t,"showComment",!1),this.replyChildComment=t,this.replyChildIndex=e)},childCommentSubmit:function(){var t=this;if(this.replyChildComment&&this.childCommentsTextarea){var e=-1==this.replyChildIndex?this.replyChildComment:this.replyChildComment.replyList[this.replyChildIndex];this.contentLoading=!0,Object(o.c)({reply_fid:this.replyChildComment.comment_id,log_id:e.type_id,content:r()(this.childCommentsTextarea),reply_content:e.content,reply_comment_id:e.comment_id,reply_user_id:e.userInfo.id,reply_name:e.userInfo.realname}).then(function(i){t.replyChildComment.replyList.push({comment_id:i.data,type_id:e.type_id,userInfo:t.userInfo,create_time:parseInt((new Date).getTime()/1e3),content:r()(t.childCommentsTextarea),reply_content:e.content,replyuserInfo:e.userInfo}),t.$message.success("回复成功"),t.replyChildComment.show=!1,t.replyChildComment=null,t.contentLoading=!1,t.childCommentsTextarea="",t.$emit("on-handle",{type:"discuss-submit",data:{item:t.data}})}).catch(function(){t.$message.error("回复失败"),t.contentLoading=!1})}},commentSubmit:function(t){var e=this;this.commentsTextarea&&(this.contentLoading=!0,Object(o.c)({log_id:this.showWorkbench?this.data.action_id:this.data.log_id,content:r()(this.commentsTextarea)}).then(function(i){t.showComment=!1,t.replyList.push({comment_id:i.data,type_id:e.showWorkbench?e.data.action_id:e.data.log_id,userInfo:e.userInfo,create_time:parseInt((new Date).getTime()/1e3),content:r()(e.commentsTextarea),replyList:[],show:!1}),e.commentsTextarea="",e.$message.success("回复成功"),e.contentLoading=!1}).catch(function(){e.$message.error("回复失败"),e.contentLoading=!1}))},commentBtn:function(t){t.showComment?this.$set(t,"showComment",!1):(this.replyChildComment&&(this.replyChildComment.show=!1),this.$set(t,"showComment",!0))},selectEmoji:function(t){var e=this.commentsTextarea.split("");e.splice(this.blurIndex,0,t),this.commentsTextarea=e.join(""),this.commentsPopover=!1},childSelectEmoji:function(t){var e=this.childCommentsTextarea.split("");e.splice(this.blurIndex,0,t),this.childCommentsTextarea=e.join(""),this.childCommentsPopover=!1},blurFun:function(t){this.blurIndex=t.target.selectionEnd},imgZoom:function(t,e){this.$bus.emit("preview-image-bus",{index:e,data:t.map(function(t,e,i){return{url:t.file_path,name:t.name}})})}}},h=(i("F1nN"),i("KHd+")),p=Object(h.a)(m,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"list",attrs:{id:"journal-cell"+t.logIndex}},[a("div",{staticClass:"list-content"},[a("div",{staticClass:"header"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],key:t.data.create_user_info.thumb_img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("div",{staticClass:"row"},[a("p",{staticClass:"row-title"},[a("span",{staticClass:"name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),t.showWorkbench?a("span",{staticClass:"item-content"},[t._v(t._s(t.data.action_content))]):a("span",{staticClass:"read",style:{color:0==t.data.is_read?"#3E84E9":"#ccc"}},[t._v(t._s(0==t.data.is_read?"未读":"已读"))])]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(t.data.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),a("el-tooltip",{attrs:{disabled:!(t.data.sendUserList.length>0||t.data.sendStructList.length>0),placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"members-dep-title"},[t.data.sendUserList?a("span",t._l(t.data.sendUserList,function(e,i){return a("span",{key:i},[t._v("\n                  "+t._s(0==t.data.sendStructList.length&&i==t.data.sendUserList.length-1?e.realname:e.realname+"，")+"\n                ")])})):t._e(),t._v(" "),0!=t.data.sendStructList.legnth?a("span",t._l(t.data.sendStructList,function(e,i){return a("span",{key:i},[t._v("\n                  "+t._s(i==t.data.sendStructList.length-1?e.name:e.name+"，")+"\n                ")])})):t._e()])]),t._v(" "),a("p",{staticClass:"row-title",staticStyle:{display:"inline-block"}},[t.data.sendStructList?a("span",[t._v(t._s(t.data.sendStructList.length)+" 个部门，")]):t._e(),t._v(" "),t.data.sendUserList?a("span",[t._v(t._s(t.data.sendUserList.length)+"个同事")]):t._e()])])],1),t._v(" "),!t.showWorkbench&&t.data.permission&&(t.data.permission.is_update||t.data.permission.is_delete)?a("div",{staticClass:"rt-setting"},[a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD",cursor:"pointer"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t.data.permission.is_update?a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]):t._e(),t._v(" "),t.data.permission.is_delete?a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")]):t._e()],1)],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"text"},[t.data.content?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v(t._s(1==t.data.category_id?"今日工作内容":2==t.data.category_id?"本周工作内容":"本月工作内容")+"：")]),t._v(t._s(t.data.content))]):t._e(),t._v(" "),t.data.tomorrow?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v(t._s(1==t.data.category_id?"明日工作内容":2==t.data.category_id?"下周工作内容":"下月工作内容")+"：")]),t._v(t._s(t.data.tomorrow))]):t._e(),t._v(" "),t.data.question?a("p",{staticClass:"row"},[a("span",{staticClass:"title"},[t._v("遇到的问题：")]),t._v(t._s(t.data.question))]):t._e()]),t._v(" "),a("div",{staticClass:"accessory"},[0!=t.data.imgList.length?a("div",{staticClass:"upload-img-box"},t._l(t.data.imgList,function(e,i){return a("div",{key:i,staticClass:"img-list",on:{click:function(e){t.imgZoom(t.data.imgList,i)}}},[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.file_path,expression:"imgItem.file_path"}],key:e.file_path})])})):t._e(),t._v(" "),0!=t.data.fileList.length?a("div",{staticClass:"accessory-box"},t._l(t.data.fileList,function(t,e){return a("file-cell",{key:e,attrs:{data:t,"cell-index":e}})})):t._e()]),t._v(" "),t.allDataShow?a("related-business",{attrs:{"margin-left":"0",alterable:!1,"all-data":t.allData},on:{checkRelatedDetail:t.checkRelatedDetail}}):t._e(),t._v(" "),0!=t.data.replyList.length?a("div",{staticClass:"discuss"},[a("div",{staticClass:"border"}),t._v(" "),t._l(t.data.replyList,function(e,s){return a("div",{key:s,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:e.userInfo,expression:"discussItem.userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.userInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(discussItem.userInfo.thumb_img)",arg:"background-image"}],key:e.userInfo.thumb_img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(e.userInfo.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(e.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),a("p",{staticClass:"reply-title"},[a("span",{domProps:{innerHTML:t._s(t.emoji(e.content))}}),t._v(" "),a("i",{staticClass:"wukong wukong-log-reply log-handle",on:{click:function(i){t.discussBtn(e,-1)}}}),t._v(" "),a("i",{staticClass:"wukong wukong-log-delete log-handle",on:{click:function(i){t.discussDelete(e,t.data.replyList,s)}}})]),t._v(" "),a("p",{staticClass:"discuss-content",domProps:{innerHTML:t._s(t.emoji(e.reply_content))}}),t._v(" "),e.replyList&&e.replyList.length>0?a("div",{staticClass:"children-reply"},t._l(e.replyList,function(i,s){return a("div",{key:s,staticClass:"discuss-list"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:i.userInfo,expression:"childDiscussItem.userInfo"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(i.userInfo.thumb_img),expression:"$options.filters.filterUserLazyImg(childDiscussItem.userInfo.thumb_img)",arg:"background-image"}],key:i.userInfo.thumb_img,staticClass:"div-photo head-img header-circle"}),t._v(" "),a("span",{staticClass:"name"},[t._v(t._s(i.userInfo.realname))]),t._v(" "),a("span",{staticClass:"time"},[t._v(t._s(t._f("moment")(i.create_time,"YYYY-MM-DD HH:mm")))]),t._v(" "),a("p",{staticClass:"reply-title"},[[a("span",[t._v("回复")]),t._v(" "),a("span",{staticClass:"reply"},[t._v("@"+t._s(i.replyuserInfo.realname)+"：")])],t._v(" "),a("span",{domProps:{innerHTML:t._s(t.emoji(i.content))}}),t._v(" "),a("i",{staticClass:"wukong wukong-log-reply log-handle",on:{click:function(i){t.discussBtn(e,s)}}}),t._v(" "),a("i",{staticClass:"wukong wukong-log-delete log-handle",on:{click:function(a){t.discussDelete(i,e.replyList,s)}}})],2)])})):t._e(),t._v(" "),e.show?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:2,type:"textarea",placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.childCommentsTextarea,callback:function(e){t.childCommentsTextarea=e},expression:"childCommentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.childCommentsPopover,callback:function(e){t.childCommentsPopover=e},expression:"childCommentsPopover"}},[a("emoji",{on:{select:t.childSelectEmoji}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:t.contentLoading,type:"primary"},on:{click:function(e){t.childCommentSubmit()}}},[t._v("回复")]),t._v(" "),a("el-button",{on:{click:function(t){e.show=!1}}},[t._v("取消")])],1)],1)],1):t._e(),t._v(" "),a("div",{staticClass:"border"})])})],2):t._e()],1),t._v(" "),a("div",{staticClass:"footer"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-chat-line-round"},on:{click:function(e){t.commentBtn(t.data)}}},[t._v("回复")])],1),t._v(" "),t.data.showComment?a("div",{staticClass:"comment-box"},[a("el-input",{attrs:{rows:3,type:"textarea",placeholder:"请输入内容"},on:{blur:t.blurFun},model:{value:t.commentsTextarea,callback:function(e){t.commentsTextarea=e},expression:"commentsTextarea"}}),t._v(" "),a("div",{staticClass:"btn-group"},[a("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"},model:{value:t.commentsPopover,callback:function(e){t.commentsPopover=e},expression:"commentsPopover"}},[a("emoji",{on:{select:t.selectEmoji}}),t._v(" "),a("img",{staticClass:"smiling-img",attrs:{slot:"reference",src:i("woiz")},slot:"reference"})],1),t._v(" "),a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{loading:t.contentLoading,type:"primary"},on:{click:function(e){t.commentSubmit(t.data)}}},[t._v("回复")]),t._v(" "),a("el-button",{on:{click:function(e){t.data.showComment=!1}}},[t._v("取消")])],1)],1)],1):t._e()])},[],!1,null,"1b7b786c",null);p.options.__file="journalCell.vue";e.a=p.exports},JHu1:function(t,e,i){},JXju:function(t,e,i){"use strict";var a=i("7Qib"),s=i("mqlf"),n=i("ppJE"),o=i("PS1M"),l=i("n1dw"),c=i("xfX+"),r=i("8gwX"),d=i("K6D0"),u={name:"CRMAllDetail",components:{ClueDetail:s.a,CustomerDetail:n.a,ContactsDetail:o.a,BusinessDetail:l.a,ContractDetail:c.a,ProductDetail:r.a,MoneyDetail:d.a},props:{id:[String,Number],crmType:{type:String,default:""},visible:{type:Boolean,default:!1},listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{tabName:""}},computed:{},watch:{crmType:function(t){"leads"==this.crmType?this.tabName="clue-detail":"customer"==this.crmType?this.tabName="customer-detail":"contacts"==this.crmType?this.tabName="contacts-detail":"business"==this.crmType?this.tabName="business-detail":"contract"==this.crmType?this.tabName="contract-detail":"product"==this.crmType?this.tabName="product-detail":"receivables"==this.crmType&&(this.tabName="money-detail")}},mounted:function(){this.visible&&(document.body.appendChild(this.$el),this.$el.style.zIndex=Object(a.g)())},destroyed:function(){this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)},methods:{hiddenView:function(){this.$emit("update:visible",!1)},detailHandle:function(t){this.$emit("handle",t)}}},m=(i("AnnZ"),i("KHd+")),h=Object(m.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.id&&t.visible?i(t.tabName,{tag:"component",staticClass:"d-view",attrs:{"crm-type":t.crmType,id:t.id,"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs},on:{handle:t.detailHandle,"hide-view":t.hiddenView}}):t._e()},[],!1,null,"30fef6ca",null);h.options.__file="CRMAllDetail.vue";e.a=h.exports},KgBu:function(t,e,i){},LNGP:function(t,e,i){"use strict";var a=i("fjtK");i.n(a).a},LXjn:function(t,e,i){"use strict";var a=i("cHM3");i.n(a).a},N0PQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjZGRjBCRTYxRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjZGRjBCRTYyRTBBNzExRTg5QkREOEQxRjlDMkUxOUExIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkZGMEJFNUZFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkZGMEJFNjBFMEE3MTFFODlCREQ4RDFGOUMyRTE5QTEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz704RrgAAABwUlEQVR42uSXz0sCQRTH36h1sGNlaHjpVJoHC0KCOnVJOwSdqmM/6NZ/EF071rluQaduGQWd9BZEqWBhQQQmHYIQikDU6bs6G8Oy4q7sskYPPuzOzFu+++a9mZ1lnHNywlzkkDkm7JEb7/m8rWIDoVBHEc+DEuAaSmLMtqk+An6dfr8Ys0T4BHxJUbUzJq6q/yc47kR4CXg1fevgTcf3Faxp+vrAsuHikqxH054A5y2mWvYxnEaPwZTc/Kl1zJPJBt27gbR667YlnUjYMNWMORMxi8edETZhH+AZ9IIx4LZb+A5sieskGALfYMWW4hIFdQtmwJyIVt5gruEziucfrF5OVbAKZsGpzq42BVIQH+6suFovlRRQojnTzWethl73IO52wYaVEd+DcTDSaFUqRPV6c6RYJJ5ON8WJFqwuLkWl/7cWMhmE4SLm8xHP5YhFIkrEJPsYibhqQDgKCur3moXDROUy8Wy2KRoMqn5PZoQLBoSnxTf7otHyeonFYsSiUVlUsUMzwttAOfnV2my3e2ATvKjiFAjIPpdg30yOr0DYRL6VpbMDFoEPPIpz2EGrl2fyn0S3Hm8tNfbv/p1+BBgA+Vdv2Iz9D6cAAAAASUVORK5CYII="},N3zo:function(t,e,i){},NOHc:function(t,e,i){"use strict";var a=i("7FIu");i.n(a).a},NUF6:function(t,e,i){},NiH4:function(t,e,i){},O1Uw:function(t,e,i){"use strict";var a=i("7Qib"),s=i("KTTK"),n={name:"FileCell",props:{cellIndex:Number,data:Object,showFoot:{type:Boolean,default:!0},cursorPointer:{type:Boolean,default:!1},showDelete:{type:Boolean,default:!1},module_id:[String,Number]},data:function(){return{}},computed:{},watch:{},mounted:function(){},beforeDestroy:function(){},methods:{downloadClick:function(){Object(a.a)({path:this.data.file_path,name:this.data.name})},deleteClick:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.d)({module:"work_task",module_id:t.module_id,save_name:t.data.save_name}).then(function(e){t.$message.success(e.data),t.$emit("delete",t.cellIndex,t.data)}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})}}},o=(i("wktz"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("flexbox",{staticClass:"cell"},[a("img",{staticClass:"cell-head",attrs:{src:i("6KEE"),alt:""}}),t._v(" "),a("div",{staticClass:"cell-body",class:{"cursor-pointer":t.cursorPointer}},[a("span",[t._v(t._s(t.data.name.length>20?t.data.name.substring(0,20)+"...":t.data.name))]),t._v(" "),a("span",{staticClass:"size"},[t._v("("+t._s(t.data.size)+")")])]),t._v(" "),a("div",{staticClass:"cell-foot"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.downloadClick}},[t._v("下载")]),t._v(" "),t.showDelete?a("i",{staticClass:"el-icon-delete",on:{click:t.deleteClick}}):t._e()],1)])},[],!1,null,"327643c8",null);l.options.__file="index.vue";e.a=l.exports},ODyT:function(t,e,i){},OPCT:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVENDNERTkxRTA5QjExRThBQkRDQjRERjVBMjY3MzE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVENDNERTkyRTA5QjExRThBQkRDQjRERjVBMjY3MzE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQ0M0RFOEZFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQ0M0RFOTBFMDlCMTFFOEFCRENCNERGNUEyNjczMTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7c1/V2AAABIElEQVR42mL8//8/AwicPXuWgVxgbGwMZzMRUBsGxBeB+AXITigfL2DBIxcCxHlA7AnEz4CYB4gnQ+VW4dKEz4UNQBwNNQwEvgBxBhAn4XMhPgMFgPghmthPIP5NroF/cYgzkmsgMw7x/+Qa+AGIZbBEIgu5BjYC8VIgloLyQbE8E4gXkJtsVkMt3Ak1DOTiDiBeSa6BDFDNK0nJNdi8rArEa4H4IzQC0PFHqLwqMQaqA/ERID4IxIrQJIKOFaDyR6Dq8Xq5DYon4fHVe6g8J1RtMD4XugDxYiKDazYQu5GSbMgC6AbuAeJYIvWmAPEuQmFYDQ3w/1Cvv8dikCDU0mIgtifkwhtAbAdV+BBHsnkIlbeDqieYsG+ixxwpACDAAIZEQR7SM/O0AAAAAElFTkSuQmCC"},Op00:function(t,e,i){"use strict";var a=i("+9th"),s={name:"TaskCell",components:{},mixins:[],props:{data:Object,dataIndex:Number},data:function(){return{}},computed:{},watch:{},mounted:function(){},methods:{taskOverClick:function(t){var e=this;Object(a.r)({task_id:t.task_id,type:t.checked?1:2}).then(function(t){e.$store.dispatch("GetOAMessageNum","task")}).catch(function(){t.checked=!1})},rowFun:function(t){this.$emit("on-handle",{type:"view",data:{item:this.data,index:this.dataIndex}})},onmouseoverFun:function(t){this.$refs.itemSpan.offsetWidth>this.$refs.listLeft.offsetWidth-21?this.$set(t,"show",!0):this.$set(t,"show",!1)}}},n=(i("cr3f"),i("KHd+")),o=Object(n.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"taskRow",staticClass:"list",style:{"border-left-color":1==t.data.priority?"#8bb5f0":2==t.data.priority?"#FF9668":3==t.data.priority?"#ED6363":"transparent"},on:{click:function(e){t.rowFun(t.data)}}},[i("div",{ref:"listLeft",staticClass:"list-left"},[i("div",{class:t.data.checked?"title title-active":"title",on:{click:function(t){t.stopPropagation()}}},[i("el-checkbox",{on:{change:function(e){t.taskOverClick(t.data)}},model:{value:t.data.checked,callback:function(e){t.$set(t.data,"checked",e)},expression:"data.checked"}})],1),t._v(" "),i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"task-tooltip tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[t._v(t._s(t.data.task_name))])]),t._v(" "),i("span",{ref:"itemSpan",class:t.data.checked?"item-name-active":"item-name"},[t._v("\n        "+t._s(t.data.task_name)+"\n      ")])])],1),t._v(" "),i("div",{staticClass:"list-right"},[t.data.lableList?i("div",{staticClass:"tag-box"},[t.data.lableList.length<=2?t._l(t.data.lableList,function(e,a){return i("div",{key:a,staticClass:"item-label"},[i("span",{staticClass:"k-name",style:{background:e.color}},[t._v(t._s(e.name))])])}):[i("span",{staticClass:"k-name",style:{background:t.data.lableList[0].color}},[t._v(t._s(t.data.lableList[0].name))]),t._v(" "),i("span",{staticClass:"k-name",style:{background:t.data.lableList[1].color}},[t._v(t._s(t.data.lableList[1].name))]),t._v(" "),i("el-tooltip",{attrs:{placement:"top",effect:"light","popper-class":"tooltip-change-border task-tooltip"}},[i("div",{staticClass:"tooltip-content",staticStyle:{margin:"10px 10px 10px 0"},attrs:{slot:"content"},slot:"content"},t._l(t.data.lableList,function(e,a){return i("div",{key:a,staticClass:"item-label",staticStyle:{display:"inline-block","margin-right":"10px"}},[a>=2?i("span",{staticClass:"k-name",staticStyle:{"border-radius":"3px",color:"#FFF",padding:"3px 10px"},style:{background:e.color?e.color:"#ccc"}},[t._v(t._s(e.name))]):t._e()])})),t._v(" "),i("span",{staticClass:"color-label-more"},[i("i",[t._v("...")])])])]],2):t._e(),t._v(" "),i("div",{staticClass:"img-group"},[t.data.relationCount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-relevance"}),t._v(" "),i("span",[t._v(t._s(t.data.relationCount))])]):t._e(),t._v(" "),t.data.subcount+t.data.subdonecount!=0?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-sub-task"}),t._v(" "),i("span",[t._v(t._s(t.data.subdonecount)+"/"+t._s(t.data.subcount+t.data.subdonecount))])]):t._e(),t._v(" "),t.data.filecount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-file"}),t._v(" "),i("span",[t._v(t._s(t.data.filecount))])]):t._e(),t._v(" "),t.data.commentcount?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-comment-task"}),t._v(" "),i("span",[t._v(t._s(t.data.commentcount))])]):t._e(),t._v(" "),t.data.stop_time?i("div",{staticClass:"img-box"},[i("i",{staticClass:"wukong wukong-time-task",style:{color:1!=t.data.is_end||t.data.checked?"#999":"red"}}),t._v(" "),i("span",{style:{color:1!=t.data.is_end||t.data.checked?"#999":"red"}},[t._v(t._s(t._f("moment")(t.data.stop_time,"MM-DD"))+" 截止")])]):t._e()]),t._v(" "),i("div",{staticClass:"item-own-box"},[t.data.main_user&&t.data.main_user.id?i("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("span",[t._v(t._s(t.data.main_user.realname))])]),t._v(" "),i("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.main_user,expression:"data.main_user"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.main_user.thumb_img),expression:"$options.filters.filterUserLazyImg(data.main_user.thumb_img)",arg:"background-image"}],key:t.data.main_user.thumb_img,staticClass:"div-photo"})]):t._e()],1)])])},[],!1,null,"829cdce6",null);o.options.__file="taskCell.vue";e.a=o.exports},QJC7:function(t,e,i){"use strict";var a=i("3yi6"),s=i("KzkL"),n={name:"RecordLog",components:{FollowRecordCell:a.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this;this.$bus.on("follow-log-refresh",function(e){"record-log"==e.type&&t.refreshList()});var e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},beforeDestroy:function(){this.$bus.off("follow-log-refresh")},methods:{getList:function(){var t=this;this.loading=!0,Object(s.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"record"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},cellHandle:function(t){"delete"==t.type&&this.list.splice(t.data.index,1)}}},o=(i("GynS"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("follow-record-cell",{key:a,attrs:{item:e,"crm-type":t.crmType,index:a},on:{"on-handle":t.cellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)])])},[],!1,null,"6a287ea5",null);l.options.__file="RecordLog.vue";e.a=l.exports},QUdC:function(t,e,i){},"QV+c":function(t,e,i){},Qf6f:function(t,e,i){},QhmF:function(t,e,i){"use strict";i.r(e);var a=i("6zBA"),s=i("ooHJ"),n=i("ExMk"),o={name:"ExamineHandle",components:{XhUserCell:i("8GhS").p},props:{show:{type:Boolean,default:!1},status:{type:[String,Number],default:1},id:[String,Number],detail:{type:Object,default:function(){return{}}},examineType:{type:String,default:""}},data:function(){return{loading:!1,showDialog:!1,handleType:1,selectUsers:[],content:""}},computed:{title:function(){return 1==this.status?"审批通过":0==this.status?"审批拒绝":2==this.status?"撤回审批":""},placeholder:function(){return 1==this.status?"请输入审批意见（选填）":0==this.status?"请输入审批意见（必填）":2==this.status?"请输入撤回理由（必填）":""}},watch:{show:{handler:function(t){this.showDialog=t},deep:!0,immediate:!0}},mounted:function(){},methods:{submitInfo:function(){0!=this.status&&2!=this.status||this.content?0==this.status||1==this.status?this.handlePassAndReject():2==this.status&&this.handleRevoke():this.$message.error(this.placeholder)},handleRevoke:function(){var t=this;this.loading=!0,this.getExamineRevokeRequest()({id:this.id,content:this.content}).then(function(e){t.loading=!1,t.$message.success(e.data),t.$emit("save"),t.hiddenView()}).catch(function(){t.loading=!1})},getExamineRevokeRequest:function(){return"crm_contract"==this.examineType?a.h:"crm_receivables"==this.examineType?s.g:"oa_examine"==this.examineType?n.f:void 0},handlePassAndReject:function(){var t=this;this.loading=!0;var e={id:this.id,status:this.status,content:this.content,flow_id:this.detail.flow_id};1==this.status&&0==this.detail.config&&(1==this.handleType?e.is_end=1:e.check_user_id=this.selectUsers[0].id),this.getExamineRequest()(e).then(function(e){t.loading=!1,t.$message.success(e.data),t.$emit("save",{type:t.status}),t.hiddenView()}).catch(function(){t.loading=!1})},getExamineRequest:function(){return"crm_contract"==this.examineType?a.b:"crm_receivables"==this.examineType?s.a:"oa_examine"==this.examineType?n.b:void 0},handleClick:function(t){"cancel"==t?this.hiddenView():"confirm"==t&&this.submitInfo()},selectUserFocus:function(){this.handleType=2},selectExamineUser:function(t){this.selectUsers=t.value},hiddenView:function(){this.$emit("close")}}},l=(i("AV3D"),i("KHd+")),c=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{title:t.title,"append-to-body":!0,visible:t.showDialog,width:"400px"},on:{"update:visible":function(e){t.showDialog=e},close:t.hiddenView}},[1==t.status&&0==t.detail.config?i("div",{staticClass:"handle-type"},[i("flexbox",{staticClass:"handle-item"},[i("el-radio",{attrs:{label:1},model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[i("span")]),t._v(" "),i("div",{staticStyle:{"font-size":"12px"},nativeOn:{click:function(e){t.handleType=1}}},[t._v("审核结束")])],1),t._v(" "),i("flexbox",{staticClass:"handle-item",attrs:{id:"selectUser"}},[i("el-radio",{attrs:{label:2},model:{value:t.handleType,callback:function(e){t.handleType=e},expression:"handleType"}},[i("span")]),t._v(" "),i("xh-user-cell",{staticClass:"select-user",attrs:{placeholder:"选择下一审批人"},on:{focus:t.selectUserFocus,"value-change":t.selectExamineUser}})],1)],1):t._e(),t._v(" "),1==t.status&&0==t.detail.config?i("div",{staticClass:"title"},[t._v("意见")]):t._e(),t._v(" "),i("el-input",{attrs:{rows:5,placeholder:t.placeholder,type:"textarea",resize:"none"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.handleClick("cancel")}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.handleClick("confirm")}}},[t._v("确 定")])],1)],1)},[],!1,null,"55ac0ffa",null);c.options.__file="ExamineHandle.vue";e.default=c.exports},Qldq:function(t,e,i){"use strict";i.d(e,"f",function(){return s}),i.d(e,"a",function(){return n}),i.d(e,"e",function(){return o}),i.d(e,"c",function(){return l}),i.d(e,"d",function(){return c}),i.d(e,"b",function(){return r}),i.d(e,"g",function(){return d});var a=i("t3Un");function s(t){return Object(a.a)({url:"oa/log/index",method:"post",data:t})}function n(t){return Object(a.a)({url:"oa/log/save",method:"post",data:t})}function o(t){return Object(a.a)({url:"oa/log/update",method:"post",data:t})}function l(t){return Object(a.a)({url:"oa/log/commentSave",method:"post",data:t})}function c(t){return Object(a.a)({url:"oa/log/delete",method:"post",data:t})}function r(t){return Object(a.a)({url:"oa/log/commentDel",method:"post",data:t})}function d(t){return Object(a.a)({url:"oa/log/setread",method:"post",data:t})}},S3Kq:function(t,e,i){"use strict";var a=i("GQeE"),s=i.n(a),n=i("sCIN"),o={name:"Emoji",data:function(){return{emojiData:n.a,pannels:["表情","自然","物品","地点","符号"],activeIndex:0}},computed:{emojis:function(){var t=this;return this.pannels.map(function(e){return s()(t.emojiData[e])})}},created:function(){},methods:{changeActive:function(t){this.activeIndex=t},getPureName:function(t){return t.replace(/:/g,"")},selectItem:function(t){this.$emit("select",t)}}},l=(i("e8nH"),i("KHd+")),c=Object(l.a)(o,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"emoji"},[i("ul",{staticClass:"emoji-controller"},t._l(t.pannels,function(e,a){return i("li",{key:a,class:{active:a===t.activeIndex},on:{click:function(e){t.changeActive(a)}}},[t._v("\n      "+t._s(e)+"\n    ")])})),t._v(" "),i("ul",{staticClass:"emoji-container"},t._l(t.emojis,function(e,a){return a===t.activeIndex?i("li",{key:a,staticStyle:{padding:"0"}},[t._v("\n      "+t._s(e)+"--"+t._s(a)+"\n      "),t._l(e,function(e,a){return i("a",{key:a,attrs:{href:"javascript:;"},on:{click:function(i){t.selectItem(e)}}},[i("span",{staticClass:"emoji-item",class:"sprite-"+t.getPureName(e),attrs:{title:e}})])})],2):t._e()}))])},[],!1,null,"1d108da0",null);c.options.__file="emoji.vue";e.a=c.exports},SE13:function(t,e,i){"use strict";var a=i("mX3o"),s=i("UcQx"),n=i("6zBA"),o=i("7Qib"),l={name:"RelativeProduct",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-f93ad2")]).then(i.bind(null,"uMjE"))}},mixins:[a.a],props:{id:[String,Number],detail:{type:Object,default:function(){return{}}},crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,productId:"",totalInfo:{total_price:"0.00",discount_rate:"0.00"},formatterRules:{}}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"name",width:"200",label:"产品名称"}),this.fieldList.push({prop:"category_id",width:"200",label:"产品类别"}),this.fieldList.push({prop:"unit",width:"200",label:"单位"}),this.fieldList.push({prop:"price",width:"200",label:"标准价格"}),this.fieldList.push({prop:"sales_price",width:"200",label:"售价"}),this.fieldList.push({prop:"num",width:"200",label:"数量"}),this.fieldList.push({prop:"discount",width:"200",label:"折扣（%）"}),this.fieldList.push({prop:"subtotal",width:"200",label:"合计"}),this.formatterRules.category_id={type:"crm",formatter:function(t){return t||""}}},getDetail:function(){var t=this;this.loading=!0,this.getRequest()(this.getParams()).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list,t.totalInfo.total_price=Object(o.h)(e.data.total_price),t.totalInfo.discount_rate=e.data.discount_rate}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},getRequest:function(){return"business"==this.crmType?s.e:"contract"==this.crmType?n.f:void 0},getParams:function(){return"business"==this.crmType?{business_id:this.id}:"contract"==this.crmType?{contract_id:this.id}:void 0},fieldFormatter:function(t,e,i){if(["sales_price","price","subtotal"].includes(e.property))return Object(o.h)(i);var a=this.formatterRules[e.property];return a?"crm"===a.type?e.property?a.formatter(t[e.property+"_info"]):"":a.formatter(t[e.property]):t[e.property]},handleRowClick:function(t,e,i){this.productId=t.product_id,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}}}},c=(i("NOHc"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}}),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})),t._v(" "),i("flexbox",{staticClass:"handle-footer"},[i("div",{staticClass:"discount-title"},[t._v("整单折扣（%）："),i("span",{staticClass:"discount-title-value"},[t._v(t._s(t.totalInfo.discount_rate))])]),t._v(" "),i("div",{staticClass:"total-info"},[t._v("已选中产品："),i("span",{staticClass:"info-yellow"},[t._v(t._s(t.list.length))]),t._v(" 种  总金额："),i("span",{staticClass:"info-yellow"},[t._v(t._s(t.totalInfo.total_price))]),t._v(" 元")])]),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.productId,"crm-type":"product"},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"919b877a",null);r.options.__file="RelativeProduct.vue";e.a=r.exports},SoCr:function(t,e,i){},SvQs:function(t,e,i){},Ty3d:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjFFNjYzOUQ1QzBBNDExRThBNDkyQjIyMjQ0OUUzOEZGIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjFFNjYzOUQ2QzBBNDExRThBNDkyQjIyMjQ0OUUzOEZGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MUU2NjM5RDNDMEE0MTFFOEE0OTJCMjIyNDQ5RTM4RkYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MUU2NjM5RDRDMEE0MTFFOEE0OTJCMjIyNDQ5RTM4RkYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4LTq2QAAAAuElEQVR42mL8n55+jIGBwZKBNPAfiC8B8VsgfgPEz4F4JRAfZwQa+J+BOuAvEPOxIAkwkuA6EDACYmEgVgXiaUD8GYi/sVDgovNQ+guUvgciWPC4AB3g8oESlL6Ly0BGEl2qiOxCJipEhjKUvk8tAwl6mdwwvEeNMGQDYmkg/gPEj6jhZSWoGY+hhlJsoCJy+FEjDFHCjxphqIhuIKVeVkFOg+gu/E9GEcaAHoYgF56gQuKGexkgwACeYSfmOSaQxAAAAABJRU5ErkJggg=="},UEWd:function(t,e,i){"use strict";var a=i("7Qib"),s=i("KTTK"),n={name:"MixAdd",components:{CrmRelative:i("mkuN").a},props:{showRelativeBusiness:{type:Boolean,default:!1},showRelativeContacts:{type:Boolean,default:!1},id:[String,Number],crmType:{type:String,default:""}},data:function(){return{content:"",inputAutosize:{minRows:1,maxRows:6},barItems:[{img:i("S1Xc"),title:"图片",type:"img",data:"image/*"},{img:i("rl4O"),title:"附件",type:"file",data:"*.*"}],imgFiles:[],files:[],business:[],contacts:[],showRelativeType:""}},computed:{},mounted:function(){this.showRelativeBusiness&&this.barItems.push({img:i("i91G"),title:"关联商机",type:"business",show:!1}),this.showRelativeContacts&&this.barItems.push({img:i("OPCT"),title:"关联联系人",type:"contacts",show:!1}),this.$on("submit-info",function(){this.$emit("mixadd-info",{content:this.content,files:this.files,images:this.imgFiles,business:this.business,contacts:this.contacts})})},beforeDestroy:function(){this.$off("submit-info")},methods:{resetInfo:function(){this.content="",this.imgFiles=[],this.files=[],this.business=[],this.contacts=[],this.showRelativeType=""},checkRelativeInfos:function(t){"business"==this.showRelativeType?this.business=t.data:"contacts"==this.showRelativeType&&(this.contacts=t.data)},barClick:function(t){"business"==t.type?(this.showRelativeType=t.type,t.show=!0):"contacts"==t.type&&(this.showRelativeType=t.type,t.show=!0)},uploadFile:function(t){for(var e=this,i=t.target.files,n=this,o=function(o){var l=i[o];(c={}).module_id=e.id,c.module="crm_"+e.crmType,"image/*"==t.target.accept?c["img[]"]=l:"*.*"==t.target.accept&&(c["file[]"]=l),Object(s.f)(c).then(function(e){e.data.forEach(function(e,i){e.size=Object(a.c)(l.size),"image/*"==t.target.accept?n.imgFiles.push(e):"*.*"==t.target.accept&&(e.icon=Object(a.f)(l),n.files.push(e))})}).catch(function(){})},l=0;l<i.length;l++){var c;o(l)}t.target.value=""},deleteAllImg:function(){this.imgFiles=[]},deleteImgOrFile:function(t,e,i){var a=this;Object(s.d)({save_name:e.save_name,module_id:this.id,module:"crm_"+this.crmType}).then(function(e){"image"==t?a.imgFiles.splice(i,1):a.files.splice(i,1),a.$message.success(e.data)}).catch(function(){})},mouseImgOver:function(t,e){t.showDelete=!0,this.$set(this.imgFiles,e,t)},mouseImgLeave:function(t,e){t.showDelete=!1,this.$set(this.imgFiles,e,t)},inputFocus:function(){var t=this;this.inputAutosize={minRows:3,maxRows:6},this.$nextTick(function(){t.$refs.textarea.resizeTextarea()})}}},o=(i("eDCH"),i("KHd+")),l=Object(o.a)(n,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mix-container"},[a("div",{staticClass:"i-cont"},[a("el-input",{ref:"textarea",attrs:{autosize:t.inputAutosize,type:"textarea",clearable:"",resize:"none",placeholder:"请输入内容"},on:{focus:t.inputFocus},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1),t._v(" "),t.imgFiles.length>0?a("section",{staticClass:"img-cont"},[a("flexbox",{attrs:{wrap:"wrap"}},[t._l(t.imgFiles,function(e,i){return a("div",{key:i,staticClass:"img-item",style:{"background-image":"url("+e.path+")"},on:{mouseover:function(a){t.mouseImgOver(e,i)},mouseleave:function(a){t.mouseImgLeave(e,i)}}},[e.showDelete?a("div",{staticClass:"img-delete",on:{click:function(a){t.deleteImgOrFile("image",e,i)}}},[t._v("×")]):t._e()])}),t._v(" "),a("div",{staticClass:"img-item-add"},[a("input",{staticClass:"img-item-iput",attrs:{type:"file",accept:"image/*",multiple:""},on:{change:t.uploadFile}})])],2),t._v(" "),a("div",{staticClass:"img-bar",on:{click:t.deleteAllImg}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.files.length>0?a("section",{staticClass:"file-cont"},[a("flexbox",{staticClass:"f-header"},[a("img",{staticClass:"f-logo",attrs:{src:i("rl4O")}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v("附件")])]),t._v(" "),a("div",{staticClass:"f-body"},t._l(t.files,function(e,i){return a("flexbox",{key:i,staticClass:"f-item"},[a("img",{staticClass:"f-img",attrs:{src:e.icon}}),t._v(" "),a("div",{staticClass:"f-name"},[t._v(t._s(e.name+"("+e.size+")"))]),t._v(" "),a("div",{staticClass:"close-button",on:{click:function(a){t.deleteImgOrFile("file",e,i)}}},[t._v("×")])])})),t._v(" "),a("div",{staticClass:"img-bar",on:{click:function(e){t.files=[]}}},[t._v("全部删除")])],1):t._e(),t._v(" "),t.business.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("i91G")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("商机")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.business,function(e,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.business.splice(i,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),t.contacts.length>0?a("section",{staticClass:"c-cont"},[a("flexbox",{staticClass:"c-header"},[a("img",{staticClass:"c-logo",attrs:{src:i("OPCT")}}),t._v(" "),a("div",{staticClass:"c-name"},[t._v("联系人")])]),t._v(" "),a("div",{staticClass:"c-body"},[a("flexbox",{attrs:{wrap:"wrap"}},t._l(t.contacts,function(e,i){return a("flexbox",{key:i,staticClass:"c-item"},[a("div",{staticClass:"c-item-name"},[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"c-item-close",on:{click:function(e){t.contacts.splice(i,1)}}},[t._v("×")])])}))],1)],1):t._e(),t._v(" "),a("flexbox",{staticClass:"bar-cont"},[t._l(t.barItems,function(e,i){return["img"==e.type||"file"==e.type?a("flexbox",{key:i,staticClass:"bar-item",nativeOn:{click:function(i){t.barClick(e)}}},[a("input",{staticClass:"bar-input",attrs:{accept:e.data,type:"file",multiple:""},on:{change:t.uploadFile}}),t._v(" "),a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])]):a("el-popover",{key:i,attrs:{placement:"bottom",width:"700","popper-class":"no-padding-popover",trigger:"click"},model:{value:e.show,callback:function(i){t.$set(e,"show",i)},expression:"item.show"}},[a("crm-relative",{ref:"crmrelative",refInFor:!0,attrs:{show:e.show,radio:!1,action:{type:"condition",data:{form_type:"customer",customer_id:t.id}},"selected-data":"business"==e.type?{business:t.business}:{contacts:t.contacts},"crm-type":e.type},on:{close:function(t){e.show=!1},changeCheckout:t.checkRelativeInfos}}),t._v(" "),a("flexbox",{staticClass:"bar-item",attrs:{slot:"reference"},nativeOn:{click:function(i){t.barClick(e)}},slot:"reference"},[a("img",{staticClass:"bar-img",attrs:{src:e.img}}),t._v(" "),a("div",{staticClass:"bar-title"},[t._v(t._s(e.title))])])],1)]})],2)],1)},[],!1,null,"c3bfd986",null);l.options.__file="MixAdd.vue";e.a=l.exports},UHbi:function(t,e,i){"use strict";var a=i("sAYG");i.n(a).a},YIul:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA3M0VDREE4MzQxMjExRTlBOUM4RkI4NUQ3N0YxNjM2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA3M0VDREE5MzQxMjExRTlBOUM4RkI4NUQ3N0YxNjM2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDczRUNEQTYzNDEyMTFFOUE5QzhGQjg1RDc3RjE2MzYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDczRUNEQTczNDEyMTFFOUE5QzhGQjg1RDc3RjE2MzYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5bXoyPAAAEJklEQVR42uxYS0hUYRQ+585tmNGZ0dLGpEW6K3qAQSEtAntQWUQPiLIiWvSiiDYtxKhF5So3vR+bIlOjBwVmQZTRImyRRhEILZIo1ElrdGYaG+/cv/P/d2QcZ+70X8epFv5w9XIf53xzHt//nYuMMfgflwL/6ZoEZnWpSVfe4b9FtICZAJNYLH+XAnrgIGi+7aj1zIFonwv0oBF9xaWDrTDI1BmdoHrrQXFfQP8N3aoPTOrKNBEjQCpEfVcx3LEDtJ4pcjmZMcycZfVg8+4lgJpsxKSBsbxtSzHc1gKRT7mGQy8w1woARxmwKbMAbPn0EPmNfgPUegGG3gIGWwG0bsOAvTTEnOWVOND4csKAMc+mIxh8WkfpUwSgqXsJVIVE7zAC9xzwx1UC6KPH3TpzrTyCg/fPZQyMeTZUY6C5lkeD5SwBNr2GHORYKxg9DNhfRyCfkUcVmHtdDQ4+qB03MJa3dTUGHraQYWSezcAKDvJXxtluFL3vlwAH7pAJB6MfTGltemIGTElT6HYMv74rQOVWJIOKfAS6b/KyRgBuAwx/Ht1nwKYdAG4L2BBy29yHdYKN+i6LQuc1VXg0KVKK7zRgTzUgFXlSqw80UHQuA/obx94xbJFNYZs63BIwzlOCEvg5FToozuRnXMuN9PTV0b9I/AYVOfobDBDuNSk8Oily+wyY4Y4qwYnSEdMDhwRPqUUEYJkZfQBwmhj+QkDq4zGhOgL2y3jPsSD1uzydZFv44L6kgWm+KsPAMvNip+7SYykmbuKpobR2AIZexKKyPx2vx2zHfUkBI4KcI06cZekbzTGX6GS9KHaF00H/uVg0qQpshenfjdkmX7PlNnFR+N9cwoG91FyWdB8mdn8fvzD0If7DflwTBzjmg158NnU6yTYavtwWamxkQ87LUCqkUcdKfqIvqYjJkPmYSCifKozrpa1ZFIpcuggvA9nTXbo/0ZdUxGzTgxD1ezDSBcxZKFdjYyJnNId5jSF1ccxXgHxJEqxa1ClOwu3Zq7FwR6IvqYip3lv0dzGGWomP9qTksoxrjJNv4BH31WChxtznufIkZgYOLhuL5ZSDPvNaF/m6KE+wpNFJDjcYW8wVoaeyMwp5T5nJbXN1QRod7CUhsSn3nUlfL7FCB8c8K7De0HF9XMMICcVKUprNXD9lLhQTVpCORVSXnZaFoqGrmlqYe9UJvmHj4D3A3mOU1p+ZguIaaUtKUFYmcRx8eJK51x7nchh/vgLl625qiOd/Tu2InKZnKeojz/NIbSBQjydsrhRpDbfdgUhXTtL4Zi8Ztff5gRMzcAk0anxjno09rOBwxZ8iZXmuTBx422ng7ZUceIto4F2YvYE3CaAeOEAduxO17tkQ7c9N/ERQEGJqMf9EcJN46pIUoIkA9jc+quDkF8VJYFlevwUYANgN636rXd4YAAAAAElFTkSuQmCC"},Yytf:function(t,e,i){"use strict";var a=i("ovzS");i.n(a).a},Z4QE:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAUCAYAAACAl21KAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRENzNGNkQ1QzBBNDExRThCOENDODNGQjI4NEIxRjI1IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRENzNGNkQ2QzBBNDExRThCOENDODNGQjI4NEIxRjI1Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEQ3M0Y2RDNDMEE0MTFFOEI4Q0M4M0ZCMjg0QjFGMjUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEQ3M0Y2RDRDMEE0MTFFOEI4Q0M4M0ZCMjg0QjFGMjUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7hKX9iAAABEElEQVR42syTPQrCQBCFN9FW9ACClxAsxMo7CAo2ggh6AzEoGlCPkNreM1j4g5ewUbBLERELf9/CW4jBVUlAHPiy2Zm3j9khMe6NxlYIkRbRYmfiYYvoYUsjB0yZWIA4MD4Qp1bwrGNyU5ftgTywvujAonbHs0IZuaAKrqADCm9MCtRcecb1G8mYgTGIgQlIvTBJsRajdqYKZkDYBWuQ4eyC4bAmNT1/IWh0ARXggRKo+Wo15jxqzu+MZGxAk+99X37AtUXNUxj4IHVDvSuNZi8+dRQqdEYJrgfN/msjlb9p9r+/2v/NSM0iCXJRZrQHK3ayBKOwV5MfXxEM2UWZ+WOYYZ9AG2TBnP/YWCd+CDAAvc87sue7fHUAAAAASUVORK5CYII="},ZlMj:function(t,e,i){"use strict";var a=i("NiH4");i.n(a).a},ZmKI:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjVEMENBMDgzREQ3QjExRTg5RTFCQ0E4MUY5MTVGRTBFIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjVEMENBMDg0REQ3QjExRTg5RTFCQ0E4MUY5MTVGRTBFIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NUQwQ0EwODFERDdCMTFFODlFMUJDQTgxRjkxNUZFMEUiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NUQwQ0EwODJERDdCMTFFODlFMUJDQTgxRjkxNUZFMEUiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz778+BDAAABaklEQVR42mL8//8/w2AETAyDFAxah7FgE/x18RpdHcGmr0Wcw5gOnaRv8GBxGPlRycLyD0j+x4tZmP/RP439+cNIWM1fRqqmMVLAP0sjBgZWVqonB7wO+y8usoPx3UdXYOgwMSDKO5RQYDp+jli7/iMng/+iQgsZn79KIisqGd9+cGX4/RvZUchpjHDJzML8H0cyYGJ8/S6B/DT29y9Y/p+dOVbDoaGHG//5i2E+3CwCaRS/w5BDigmi9L+slBap6QWoRwPZDKom/v/8vAyM7z8yMD5+dpVUhwH1QMwQ4KN+cfFfTYnhv5AAKG2RnsWYmcF6/6sq0qC4YGdj+K+jzkCvtsho62J4N3sI+oaM6gZrWThiQoxU348m/iGb+KkR1aOJfzTxjzpsaCV+ZmBn4u9fRpr0zCFmkxdiwKbwRZw9HYqCg/n/fxHBNWSHGOPb94Y0iac/fxkYX74ZmmmMcXREcdRhNAYAAQYARx5zm8Kgo+0AAAAASUVORK5CYII="},"aQg/":function(t,e,i){"use strict";var a=i("FyfS"),s=i.n(a),n=i("d0bK"),o=i("Op00"),l=i("KzkL"),c=i("7Qib"),r={name:"TaskLog",components:{TaskCell:o.a,Particulars:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-3458")]).then(i.bind(null,"+Gvz"))}},mixins:[n.a],props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[]}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(l.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"task"}).then(function(e){var i=!0,a=!1,n=void 0;try{for(var o,l=s()(e.data.list);!(i=(o=l.next()).done);i=!0){var c=o.value;5==c.dataInfo.status&&(c.dataInfo.checked=!0)}}catch(t){a=!0,n=t}finally{try{!i&&l.return&&l.return()}finally{if(a)throw n}}t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},taskCellHandle:function(t){var e=this;"view"==t.type&&this.showDetailView(t.data.item,t.data.index,function(){e.$nextTick(function(){document.body.appendChild(e.$refs.taskShade),e.$refs.taskShade.style.zIndex=Object(c.g)(),e.$refs.taskShade.addEventListener("click",e.handleDocumentClick,!1)})})},handleDocumentClick:function(t){t.stopPropagation(),this.$refs.taskShade==t.target&&(this.taskDetailShow=!1)}}},d=(i("hSY+"),i("KHd+")),u=Object(d.a)(r,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("task-cell",{key:a,attrs:{data:e.dataInfo,"data-index":a},on:{"on-handle":t.taskCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),t.taskDetailShow?i("div",{ref:"taskShade",staticClass:"full-container"},[i("particulars",{staticClass:"d-view",attrs:{id:t.taskID,"detail-index":t.detailIndex},on:{"on-handle":t.detailHandle,close:t.closeBtn}})],1):t._e()])},[],!1,null,"2aafd5d8",null);u.options.__file="TaskLog.vue";e.a=u.exports},bmHb:function(t,e,i){"use strict";var a=i("3hkp");i.n(a).a},cHM3:function(t,e,i){},cXmQ:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU0RDkwNTI0QzBBNDExRThCNzBGQ0FBMTIxNTc0RUIzIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU0RDkwNTI1QzBBNDExRThCNzBGQ0FBMTIxNTc0RUIzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTREOTA1MjJDMEE0MTFFOEI3MEZDQUExMjE1NzRFQjMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTREOTA1MjNDMEE0MTFFOEI3MEZDQUExMjE1NzRFQjMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6YDg1HAAABGElEQVR42rTSsUsCYRjHcQ1R1Cn8Gxwb2hoVV5saHA0crKVBBAdLBWkpQkRpC8Fo1sG5vfb+Arcagq5SQbi+jzzCy+Ed3VkPfIb3fe9+9/C8F7bL5ZDPusEJFrqew4qE/FcVKRSNvfhOgCAbJTwaex9BgqSyOMBU15YzSNY9nHuEHGKCLvbwjE9zRlEMcIQYvtBxhBRwj2vUdS+P1rqjBMbYRxpD43bWdYwHXBkhUm84k452tdU4MnjVl2a41euVD/VxiQvH4KXCEjTS2eTwbjxwim/c6XkbDbfBSVANLzKwDddc0c6WaHpdowQ9ufwrq5Yd83CtoP/RVkG20enGIM8H/HY0/6ugxX/PKOI3yHI5T/426EeAAQDnkTjB4JNlHQAAAABJRU5ErkJggg=="},cYid:function(t,e,i){"use strict";var a=i("mX3o"),s=i("EgJF"),n=i("6zBA"),o=i("7Qib"),l={name:"RelativeContract",components:{CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},CRMCreateView:s.default},mixins:[a.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1},detail:{type:Object,default:function(){return{}}}},data:function(){return{nopermission:!1,list:[],fieldList:[],tableHeight:"400px",showFullDetail:!1,isCreate:!1,contractId:"",createActionInfo:{type:"relative",crmType:this.crmType,data:{}}}},computed:{},watch:{id:function(t){this.list=[],this.getDetail()}},mounted:function(){this.getDetail()},activated:function(){},deactivated:function(){},methods:{getFieldList:function(){this.fieldList.push({prop:"num",width:"200",label:"合同编号"}),this.fieldList.push({prop:"name",width:"200",label:"合同名称"}),this.fieldList.push({prop:"customer_id",width:"200",label:"客户名称"}),this.fieldList.push({prop:"money",width:"200",label:"合同金额"}),this.fieldList.push({prop:"start_time",width:"200",label:"开始日期"}),this.fieldList.push({prop:"end_time",width:"200",label:"结束日期"}),this.fieldList.push({prop:"check_status",width:"200",label:"状态"})},getDetail:function(){var t=this;this.loading=!0;var e={pageType:"all"};e[this.crmType+"_id"]=this.id,Object(n.e)(e).then(function(e){0==t.fieldList.length&&t.getFieldList(),t.nopermission=!1,t.loading=!1,t.list=e.data.list}).catch(function(e){102==e.code&&(t.nopermission=!0),t.loading=!1})},fieldFormatter:function(t,e,i){return"customer_id"===e.property?t.customer_id_info.name:"check_status"===e.property?this.getStatusName(t.check_status):["money"].includes(e.property)?Object(o.h)(i):t[e.property]},getStatusName:function(t){return t>5?"":["待审核","审核中","审核通过","已拒绝","已撤回","未提交"][t]},handleRowClick:function(t,e,i){this.contractId=t.contract_id,this.showFullDetail=!0},headerRowStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},cellStyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return{textAlign:"center"}},createClick:function(){"business"==this.crmType?(this.createActionInfo.data.customer=this.detail.customer_id_info,this.createActionInfo.data.business=this.detail):"customer"==this.crmType&&(this.createActionInfo.data.customer=this.detail),this.isCreate=!0},createSaveSuccess:function(){this.getDetail()}}},c=(i("9Aba"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"empty",rawName:"v-empty",value:t.nopermission,expression:"nopermission"}],staticClass:"rc-cont",attrs:{"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"}},[t.isSeas?t._e():i("flexbox",{staticClass:"rc-head",attrs:{direction:"row-reverse"}},[i("el-button",{staticClass:"rc-head-item",attrs:{type:"primary"},nativeOn:{click:function(e){return t.createClick(e)}}},[t._v("新建合同\n    ")])],1),t._v(" "),i("el-table",{staticStyle:{width:"100%",border:"1px solid #E6E6E6"},attrs:{data:t.list,height:t.tableHeight,"header-cell-style":t.headerRowStyle,"cell-style":t.cellStyle,stripe:""},on:{"row-click":t.handleRowClick}},t._l(t.fieldList,function(e,a){return i("el-table-column",{key:a,attrs:{prop:e.prop,formatter:t.fieldFormatter,label:e.label,"show-overflow-tooltip":""}})})),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,id:t.contractId,"crm-type":"contract"},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:t.createActionInfo,"crm-type":"contract"},on:{"save-success":t.createSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"13591d48",null);r.options.__file="RelativeContract.vue";e.a=r.exports},cr3f:function(t,e,i){"use strict";var a=i("ejyP");i.n(a).a},d0bK:function(t,e,i){"use strict";e.a={components:{},data:function(){return{taskID:"",detailIndex:-1,taskDetailShow:!1}},mounted:function(){},methods:{closeBtn:function(){this.taskDetailShow=!1},showDetailView:function(t,e,i){this.taskID=t.task_id,this.detailIndex=e,this.taskDetailShow=!0,i&&i()},detailHandle:function(t){if(0==t.index||t.index)if("title-check"==t.type)this.$set(this.list[t.index],"checked",t.value);else if("delete"==t.type)this.list.splice(t.index,1);else if("change-stop-time"==t.type){parseInt(t.value)+86399>new Date(new Date).getTime()/1e3?this.list[t.index].is_end=!1:this.list[t.index].is_end=!0,this.list[t.index].stop_time=t.value}else if("change-priority"==t.type)this.list[t.index].priority=t.value.id;else if("change-name"==t.type)this.list[t.index].task_name=t.value;else if("change-comments"==t.type){var e=this.list[t.index].commentcount;"add"==t.value?this.list[t.index].commentcount=e+1:this.list[t.index].commentcount=e-1}else"change-sub-task"==t.type&&(this.list[t.index].subdonecount=t.value.subdonecount,this.list[t.index].subcount=t.value.allcount-t.value.subdonecount)}},deactivated:function(){}}},dcF1:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjQxMThCRDhBREQ3QjExRThBN0VEQjdCNzMzQTBBRThGIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjQxMThCRDhCREQ3QjExRThBN0VEQjdCNzMzQTBBRThGIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NDExOEJEODhERDdCMTFFOEE3RURCN0I3MzNBMEFFOEYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NDExOEJEODlERDdCMTFFOEE3RURCN0I3MzNBMEFFOEYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5KvTRiAAAEVklEQVR42uxYWWxMYRQ+d6Y1MzWdVvclrVLt1NSkQRAhKqgXe0KIPSSWVGKNRCLxIuLNC4l4EYklEk+IxJsQQQmKqqVRo1NaS1t0aGd6W9/5/XdyO51wa26ZByf5/L8z595+/9n+M6P09fVRPIqF4lTillhCbU/3PyVw7Ob1AboTlVVx7LFBno4PkgqsBMYD5YAbeAXw0V063QtgT/W0GTeGjBgIWXkB1gKOKCYTJPQyGbiGZ89h9QM+4CSIdpnpsZ3AZt4kWq2U6nCQJzuHRjiSsE+iJy1v6b6/iXr7t557QAWwSqcbB1SbSWwT/7Og3EuFqSMGfDilsIjcmdnka2+jrp4Q3Wt6w+osSWQekAbsB+abRgyhsGEpSbBYqCAKKU3Yi6mOfOKGLYkVIGycZy9kKjCxAjP7mF0YKhZSDBgriiLCzVsQSuYNCKpYvup1ZhATyc4eMypWJWxr06mDUXQxERNVpPb1GiamK4JQlLQJmUIMYRGhNHrXc46F1B6xBQK6dpOs18VMLKSqXPaU6XQaIsY55rSJs3BK3tHlWJNeFxMxmaj5VuTXrDGlQqf29lLNGx997voetgsEg3TL10jdPcJTVFXqRrGIUpmAd+RKs9UyjKxLirVdfNPCIytNEKh92yyaKvcvp80mdJ8CAers7gapsrDnZPyPACu09DOap8rDUNfv+lgDlmIr/tCqiZPInpBIV57Vkb+jo58d3wJLvBXU/LmDrj6v19Ts1pHATOC8DOVNhHa6GdPFIuCuitM/aXknPLfQ46XZJW4qSkujXFeK8NzSivHkSEykh81+7TnOpUKQ+IB1tyR1FJhlSufHi+twqm3Y3q5t9iuj0tIpJ9lFZVnZAnp52tpCrZ3cR+k9MAfPduLZDXxrSd0+6IKmTbB4WQ3nCnvtUt1jet3WNsCmqaOdrr9q0P67W5KqklNJWDcUo/Ve4GxQVUXiRwoXBFcspwgInJbq7fJK0+vMJSZ70VkDphcN6mInxpMrMEebyX4jG2E7yYDuz5MfLyvBsgZYxxWm6VPsjqhjj69dbJcw8CzfGO3yGtLrjgPnEIFvg+pjeDgFy3JgPTBV07vsdirNzBKVGI0YC98GdWgp9a2tYmCUwmX6Ehgtvy8IU+CUJFkfrY/1IwZS3GMua6MO96zi9AwaizE6z5ViOAxcBA0fP4i+1/L1i/4jfne6/sCQw9xGIolFhnIHk+I+5c3NI+5Z2lU0GOG71Q3PMj4GOoUXGYjpXHxcJr9NbZEj+y7mAjRGTX54q4jnc37pvLHlImx/QipSMoY7qbK4hEp/NuNhwAHkVy2wFfszmu5XVcmGljEZmWTH1WK2TC4YSdafE8dqOMEj1QfkZMuTh2cAMRhyTvHVQd6cvCH5Zs3F48kRExCH4aDsjY0yjGFdZLtYxl7nzYVHD/7GLwDcOiJn4sXyTr2jD2U1/XvhOB/q5zG4dEo8/dojWP7/RfE/sSGWHwIMACM4hbqavbEwAAAAAElFTkSuQmCC"},e8nH:function(t,e,i){"use strict";var a=i("KgBu");i.n(a).a},eDCH:function(t,e,i){"use strict";var a=i("QUdC");i.n(a).a},ejyP:function(t,e,i){},fjtK:function(t,e,i){},fmM0:function(t,e,i){},g1FD:function(t,e,i){},gE9n:function(t,e,i){},gKxd:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjNCNkYxMEM3REQ3QjExRThCREZDQTU0QjkwQkExRDRCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjNCNkYxMEM4REQ3QjExRThCREZDQTU0QjkwQkExRDRCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6M0I2RjEwQzVERDdCMTFFOEJERkNBNTRCOTBCQTFENEIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6M0I2RjEwQzZERDdCMTFFOEJERkNBNTRCOTBCQTFENEIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4nlTOdAAADj0lEQVR42uxYW0iTYRh+N21Hl4d5njp1Wp4K1KzMivDCm4qomyDLoqAIr6IQuuomIrrppiC6iaDsrovoqtsoNMMQFGPq1Jxlm3nKhjq39by//zwwl/8c3xDyhWffv3/ftz17j8+mCgQCtBVNTVvUtiyx+GjfoN/ti+p8UVrcf+KxBy/b+EslAeeASqAc2A3YgVtnGmreR0NMFWlVghD7/jHQBOjDbPMDrwAnMAw8A9G5SEK5GY/dAK5Jh+PUlGDUU74llUxYTUYdOUZcZB/8ofYHAo2rzlQAzaJDeZUf6qp3UYY5MeTFsiIL5WWbacw9TQveRfrq+M63TwglhjBqsRTHqdWUnpIYdl+CQUdFVh1xmsjEckX3MZ10SK0ilUpBAmNTfLyUQ6rX7zpMIonpl4gpP6Ze+QZakcSkyvJHUMmrqt4rjBiqUCd/mmJSiz5pMvCBP8KILfr8n3lN2mlU1iQRRr1OI10C7UKIoSI5eS2c+FXl+Utd1B+g3oFRmvXMr8R63ks9fU7yLi7N0Jo9tmCeVaEADCLahYfkoHBjZeu2j1D/t59oqm6pfxngnW6Qmv7tIc/cAkgVyq6TgylqJMFr/Vhs7LWGur2k0cRT25c+ck3MrNnHE+BoTSmNT85Qe9dA8PYHjKXDotTFKaCDQ+hwuiTP8QSoriigzLQkMiclSJ47dqCMtCDdNzQWPPcIqBc9xPdjaYPXVEf2lUhk1rOh0XHq7BnkSxd7Gd6aFarHWhoPfsLykL32sdOOmTgVssf1a4a6eoeDT2+GIyVCWrcArVx5Dqc7VNWiIHx+Vj70FKRexEzzw2vcC1oVbH0TMwUrK9f6oCbbwK6gd7ngtQ5hxECoGMsF4CKQF7xv1GvXkT3L904zQI4nxhNWtSDpiboqQYZF11ngElC7mkxulpms2alkNKwvGngaDKKlDKM6WTDKNg08Z5Ig2PuvqgxLDKQ4XG+DUod7liUjhayQ0anJyqUVF8Ho2KTU9yam1hTnfZC7vRlinLgnU9CnbLnplJWevDyKNms8qriKh0ASH7uAWyUopEHFVQlSPKWP8+g5VFkshS1aUmyJJgNVllql94Ox7LgTabu4zq/lZJpJsyPqH+shVmqzSPIcdh5OKFNEDBs5py7zdSFCKMK4eApy0viSE+yuohwDsSa5cmJlTKAWuda+USibKbbGMb0XtbqI1b89qu1/FLeJCba/AgwAMmk8bakbmIIAAAAASUVORK5CYII="},gYEL:function(t,e,i){},gd5k:function(t,e,i){"use strict";var a=i("Fpl1"),s=i("+zsY"),n=i("KzkL"),o=i("ExMk"),l={name:"ExamineLog",components:{ExamineCell:a.a,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},ExamineHandle:function(){return i.e("chunk-2cf3").then(i.bind(null,"QhmF"))},ExamineCreateView:s.a},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],rowID:"",showExamineHandle:!1,isCreate:!1,createAction:{type:"save"},createInfo:{},showFullDetail:!1,detailCRMType:""}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"examine"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;"edit"==t.type?(t.data.item.title=t.data.item.category_name,this.createInfo=t.data.item,this.createAction={type:"update",id:t.data.item.examine_id,data:t.data.item},this.isCreate=!0):"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(o.c)({id:t.data.item.examine_id}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"withdraw"==t.type?(this.rowID=t.data.item.examine_id,this.showExamineHandle=!0):"view"==t.type?(this.detailCRMType="examine",this.rowID=t.data.item.examine_id,this.showFullDetail=!0):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"_id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)}}},c=(i("hSjU"),i("KHd+")),r=Object(c.a)(l,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("examine-cell",{key:a,attrs:{data:e.dataInfo},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),i("examine-handle",{attrs:{show:t.showExamineHandle,id:t.rowID,"examine-type":"oa_examine",status:"2"},on:{close:function(e){t.showExamineHandle=!1},save:t.refreshList}}),t._v(" "),t.isCreate?i("examine-create-view",{attrs:{category_id:t.createInfo.category_id,category_title:t.createInfo.title,action:t.createAction},on:{"save-success":t.refreshList,"hiden-view":function(e){t.isCreate=!1}}}):t._e(),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}})],1)},[],!1,null,"1cf8abec",null);r.options.__file="ExamineLog.vue";e.a=r.exports},"hSY+":function(t,e,i){"use strict";var a=i("htha");i.n(a).a},hSjU:function(t,e,i){"use strict";var a=i("gYEL");i.n(a).a},htha:function(t,e,i){},hwcE:function(t,e,i){},i68b:function(t,e,i){"use strict";var a=i("QbLZ"),s=i.n(a),n=i("KzkL"),o=i("L2JU");e.a={data:function(){return{followTypes:[],followType:""}},computed:s()({},Object(o.b)(["oa"]),{showOAPermission:function(){return this.oa}}),created:function(){this.getFollowLogType()},methods:{getFollowLogType:function(){var t=this;this.loading=!0,Object(n.s)().then(function(e){t.loading=!1,t.followTypes=e.data.map(function(t){return{type:t,name:t}}),t.followType=e.data.length>0?e.data[0]:""}).catch(function(){t.loading=!1})}},deactivated:function(){}}},i91G:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjU2RjI0NjM0RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjU2RjI0NjM1RTA5QjExRTg4QTE5QjM2OEE1QUE5MUZBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTZGMjQ2MzJFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTZGMjQ2MzNFMDlCMTFFODhBMTlCMzY4QTVBQTkxRkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4H2LzoAAAAnklEQVR42mI8c+YMA7WAsbExAxMDlQGygSuA+B8Q/8eD/0HV4QQsSOwwNAtwAZChEcS4kJFIXzES62WqhyFdDESOqH1ocjuwRRQLAQPxRZQHEvsvLKKYKIkAbD5FNvA/kZr/ExuGq5HC6wiauo1I4bWa2IQdDsXYgP+gTTZUN5DYiPpHbDqERRQjAUtXE2sgvojCnnD///8/uCMFIMAAVWsql9WKpTgAAAAASUVORK5CYII="},ixqQ:function(t,e,i){"use strict";var a=i("hwcE");i.n(a).a},kHDV:function(t,e,i){"use strict";var a=i("5Og4");i.n(a).a},l7zd:function(t,e,i){},m8oD:function(t,e,i){"use strict";var a=i("Bs8Y");i.n(a).a},migV:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJGNkIxREZBNDE2NTExRTlBQkY1RjdBNzY2QThDRUY2IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJGNkIxREZCNDE2NTExRTlBQkY1RjdBNzY2QThDRUY2Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkY2QjFERjg0MTY1MTFFOUFCRjVGN0E3NjZBOENFRjYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkY2QjFERjk0MTY1MTFFOUFCRjVGN0E3NjZBOENFRjYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7u8NAUAAABfklEQVR42qSVsUoDQRCG5y5imfo0gk0C9la+RYQY4gOENNokkOALCBqIFlrlBYJBjfgaimCbKxSUpE4phDg/zJLd2wmnuR9+WHZmv9ud25sLFo0GKdpkl8UH7G32D/uL/cZ+ZD/JnKMNBXbIvmQXlYfsiY/ZMbvDfrCTQmucY19IQpHShZx7WZPTdnjObtP/ZdZ07B1W1oTZ0IoBojZXTrhQIGq1iPJ5fynmEEOOq2uwADxi7zihWo2oVCJqNl0oxphDDDmu8IRqKFfDVb9PNJ0SRdESamCYQww5vsoB38MPHuyqR7MBkBn3ekSzmQb8xA4jtcxYgIVmp+kwaCvUbnsWAThRI8kjJ2uqawLgeyoMx7SPvxr6AuDIm67X/Zola4ocXyMAh9JFlhoMiMZj/wUYKGLIcfUNViDtC5f7LuP7qAJovmXsspsB1hWG077O2DdrwG5lrdcP5+xT6RrxH0CxlOpE1q7s2Giaz5KM7r0vH74p/Kv8AobaR/ErwAAhLXvaJ0ohPQAAAABJRU5ErkJggg=="},n9Qq:function(t,e,i){},ovzS:function(t,e,i){},p46I:function(t,e,i){},ppJE:function(t,e,i){"use strict";var a=i("vG5h"),s=i("Ew9n"),n=i("F03V"),o=i("UEWd"),l=i("QJC7"),c=i("8KPp"),r=i("gd5k"),d=i("aQg/"),u=i("y9lt"),m=i("KzkL"),h=i("7Qib"),p=i("i68b"),f={name:"CustomerFollow",components:{MixAdd:o.a,RecordLog:l.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},mixins:[p.a],props:{id:[String,Number],crmType:{type:String,default:""},isSeas:{type:Boolean,default:!1}},data:function(){return{sendLoading:!1,next_time:"",is_event:!1,logType:"record"}},computed:{logTypes:function(){return this.oa?[{type:"record",name:"跟进记录"},{type:"log",name:"日志"},{type:"examine",name:"审批"},{type:"task",name:"任务"},{type:"schedule",name:"日程"}]:[{type:"record",name:"跟进记录"}]},componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},watch:{},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.is_event||this.next_time){var i={};i.types="crm_"+this.crmType,i.types_id=this.id,i.content=t.content,i.category=this.followType;var a=t.images.map(function(t,e,i){return t.file_id}),s=t.files.map(function(t,e,i){return t.file_id}),n=t.business.map(function(t,e,i){return t.business_id}),o=t.contacts.map(function(t,e,i){return t.contacts_id});i.file_id=a.concat(s),i.business_ids=n,i.contacts_ids=o,this.next_time&&(i.is_event=this.is_event?1:0,i.next_time=Object(h.d)(this.next_time)),this.sendLoading=!0,Object(m.l)(i).then(function(t){e.sendLoading=!1,e.$message.success(t.data),e.$refs.mixadd.resetInfo(),e.is_event=!1,e.next_time="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("请选择下次联系时间")}}},v=(i("6ENb"),i("KHd+")),g=Object(v.a)(f,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"f-container"},[t.isSeas?t._e():i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{"crm-type":t.crmType,id:t.id,"show-relative-business":!0,"show-relative-contacts":!0},on:{"mixadd-info":t.submitInfo}}),t._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[t._v("记录类型")]),t._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"请选择"))]),t._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,a){return i("el-dropdown-item",{key:a,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("div",{staticClass:"se-name"},[t._v("下次联系时间")]),t._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{"default-value":new Date,editable:!1,type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.next_time,callback:function(e){t.next_time=e},expression:"next_time"}}),t._v(" "),t.showOAPermission?i("el-checkbox",{model:{value:t.is_event,callback:function(e){t.is_event=e},expression:"is_event"}},[t._v("添加到日程提醒")]):t._e(),t._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("发布")])],1)],1),t._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){t.logTabsClick(e,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):t._e()])})),t._v(" "),i("keep-alive",[i(t.componentsName,{tag:"component",attrs:{id:t.id,"crm-type":t.crmType}})],1)],1)])},[],!1,null,"4f588198",null);g.options.__file="CustomerFollow.vue";var b=g.exports,y=i("U05J"),w=i("/U9q"),_=i("5j45"),C=i("cYid"),A=i("+NTD"),I=i("C+sD"),D=i("8DbX"),x=i("DUlf"),k=i("EgJF"),R=i("4+0Q"),T={name:"CustomerDetail",components:{SlideView:s.a,CustomerFollow:b,CRMDetailHead:n.a,CRMBaseInfo:y.a,RelativeContacts:w.a,RelativeBusiness:_.a,RelativeContract:C.a,RelativeReturnMoney:A.a,RelativeFiles:I.a,RelativeHandle:D.a,RelativeTeam:x.a,CRMCreateView:k.default},mixins:[R.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"customer",detailData:{},headDetails:[{title:"客户级别",value:""},{title:"成交状态",value:""},{title:"负责人",value:""},{title:"更新时间",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"customer-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"contacts"==this.tabCurrentName?"relative-contacts":"team"==this.tabCurrentName?"relative-team":"business"==this.tabCurrentName?"relative-business":"contract"==this.tabCurrentName?"relative-contract":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":"operationlog"==this.tabCurrentName?"relative-handle":""},tabnames:function(){var t=[];return t.push({label:"跟进记录",name:"followlog"}),this.crm.customer&&this.crm.customer.read&&t.push({label:"基本信息",name:"basicinfo"}),this.crm.contacts&&this.crm.contacts.index&&t.push({label:"联系人",name:"contacts"}),t.push({label:"相关团队",name:"team"}),this.crm.business&&this.crm.business.index&&t.push({label:"商机",name:"business"}),this.crm.contract&&this.crm.contract.index&&t.push({label:"合同",name:"contract"}),this.crm.receivables&&this.crm.receivables.index&&t.push({label:"回款信息",name:"returnedmoney"}),t.push({label:"附件",name:"file"}),t.push({label:"操作记录",name:"operationlog"}),t},isSeasDetail:function(){return this.detailData&&this.detailData.hasOwnProperty("is_pool")?1==this.detailData.is_pool:this.isSeas}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(a.l)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.level,t.headDetails[1].value=e.data.deal_status,t.headDetails[2].value=t.isSeasDetail?"- -":e.data.owner_user_id_info?e.data.owner_user_id_info.realname:"",t.headDetails[3].value=e.data.update_time}).catch(function(e){e&&102==e.code&&(t.hasRequestAuth=!1),t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.getDetial()}}},E=(i("Yytf"),Object(v.a)(T,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"},on:{"side-close":t.hideView}},[t.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{"is-seas":t.isSeasDetail,detail:t.detailData,"head-details":t.headDetails,id:t.id,"crm-type":"customer"},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return i("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(t.tabName,{tag:"component",attrs:{detail:t.detailData,id:t.id,"is-seas":t.isSeasDetail,"crm-type":"customer"}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:t.id},"crm-type":"customer"},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"5c0d4d52",null));E.options.__file="CustomerDetail.vue";e.a=E.exports},rNzn:function(t,e,i){"use strict";var a=i("gE9n");i.n(a).a},rWf7:function(t,e,i){},rl4O:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjUzM0EzN0E0RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjUzM0EzN0E1RTA5QjExRTg4MTZEOEM2ODYxNjE5QjM3Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NTMzQTM3QTJFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NTMzQTM3QTNFMDlCMTFFODgxNkQ4QzY4NjE2MTlCMzciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7neeY0AAABL0lEQVR42syUv0tCURSA1Vzam5ya+h8ag5DG3GpqqsAiwVFoECJc+jGpCFZrLTpFUjQ7PPwjClxyiCY3+y6cB5fLud0rOXjhG965j++de865L5skSWaRK5dZ8JpHmIUG/MAA1v4jNLIWVKAO6/CmSWOFO3AAJbiCLVjVpLHCV9iAF3ke+6S5wDFr8Az78Ons29LHkNDImnAO3/AAZeU9I+3AZhrI/9EAU7Nd6egIbuEJJk5tL2RPzVCTpfGZ0qieZF/TMvTJzmT+TqzsbFnZ/pidYUORHcKNzF87JHMzPJXUB1ZsBY6gGyNzhUM4lhEYS6ztqZkqc4+8B1N4h4LSgH5I5gq/YFuRprL7kEwbm4kjrYrsLkbmuymp9AMu4VpGZhZz6fOeuJEWl+KP/SvAAHR5UyjSji44AAAAAElFTkSuQmCC"},sAYG:function(t,e,i){},tgh5:function(t,e,i){"use strict";var a=i("NUF6");i.n(a).a},toL5:function(t,e,i){"use strict";var a=i("g1FD");i.n(a).a},u7bZ:function(t,e,i){},uKQN:function(t,e,i){"use strict";var a=i("7Qib"),s={name:"TimeTypeSelect",props:{defaultType:Object},data:function(){return{selectType:{label:"本年",value:"year"},showTypePopover:!1,showCustomContent:!1,sureCustomContent:!1,startTime:"",endTime:"",typeOptions:[{label:"今天",value:"today"},{label:"昨天",value:"yesterday"},{label:"本周",value:"week"},{label:"上周",value:"lastWeek"},{label:"本月",value:"month"},{label:"上月",value:"lastMonth"},{label:"本季度",value:"quarter"},{label:"上季度",value:"lastQuarter"},{label:"本年",value:"year"},{label:"去年",value:"lastYear"}]}},computed:{iconClass:function(){return this.showTypePopover?"arrow-up":"arrow-down"},typeShowValue:function(){return this.sureCustomContent?this.startTime||this.endTime?(this.startTime||"")+"-"+(this.endTime||""):"":this.selectType.label}},mounted:function(){this.defaultType?this.selectType=this.defaultType:this.$emit("change",{type:"default",value:this.selectType.value})},methods:{typeSelectClick:function(t){this.showTypePopover=!1,this.sureCustomContent=!1,this.showCustomContent=!1,this.selectType=t,this.$emit("change",{type:"default",value:this.selectType.value})},customSureClick:function(){this.startTime&&this.endTime&&(this.sureCustomContent=!0,this.showTypePopover=!1,this.$emit("change",{type:"custom",startTime:Object(a.d)(this.startTime),endTime:Object(a.d)(this.endTime)}))}}},n=(i("ubXe"),i("KHd+")),o=Object(n.a)(s,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-popover",{attrs:{placement:"bottom",width:"200","popper-class":"no-padding-popover",trigger:"click"},model:{value:t.showTypePopover,callback:function(e){t.showTypePopover=e},expression:"showTypePopover"}},[i("div",{staticClass:"type-popper"},[i("div",{staticClass:"type-content"},[t._l(t.typeOptions,function(e,a){return i("div",{key:a,staticClass:"type-content-item",class:{selected:t.selectType.value==e.value&&!t.showCustomContent},on:{click:function(i){t.typeSelectClick(e)}}},[i("div",{staticClass:"mark"}),t._v(t._s(e.label)+"\n      ")])}),t._v(" "),i("div",{staticClass:"type-content-item",class:{selected:t.showCustomContent},on:{click:function(e){t.showCustomContent=!0}}},[i("div",{staticClass:"mark"}),t._v("自定义\n      ")])],2),t._v(" "),t.showCustomContent?i("div",{staticClass:"type-content-custom"},[i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" "),i("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),i("el-button",{on:{click:t.customSureClick}},[t._v("确定")])],1):t._e()]),t._v(" "),i("el-input",{staticClass:"type-select",attrs:{slot:"reference",readonly:!0,placeholder:"请选择选择"},slot:"reference",model:{value:t.typeShowValue,callback:function(e){t.typeShowValue=e},expression:"typeShowValue"}},[i("i",{class:["el-input__icon","el-icon-"+t.iconClass],attrs:{slot:"suffix"},slot:"suffix"})])],1)},[],!1,null,"7314d766",null);o.options.__file="index.vue";e.a=o.exports},ubXe:function(t,e,i){"use strict";var a=i("u7bZ");i.n(a).a},wktz:function(t,e,i){"use strict";var a=i("SoCr");i.n(a).a},woiz:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjhGQTE4Q0EzRjM4ODExRThCNjlDOEQxMEUxMzYwREE0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjhGQTE4Q0E0RjM4ODExRThCNjlDOEQxMEUxMzYwREE0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6OEZBMThDQTFGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6OEZBMThDQTJGMzg4MTFFOEI2OUM4RDEwRTEzNjBEQTQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4R34ZtAAABfUlEQVR42pzUPUsDQRDG8eTQVBZiQhqxU6KoWKiFhaAQ21gqQcXGTxDFSsRKBOMXsBGi+NLFlBYighbmClGLgFZiE1+wECGd/4HnZDmSIA78uNzN7LC3t5touVyOhKINS5jGIDrwgTsUsYsvd4AXapBFBaPIoxdRXfN6XlHdb7Q4v9exgAz8UPNXlGQYJ+jBhtskqwZjqEaah6+6azxh39MabGPmDw2CqKp+B+3WZBHnCFb4UuqFm7P6M8x5WoNCqDjaZBZuzsZlbE36nVlYjDdpEM7dYsBmksBb5H/xjrinHwknUUOswaCY8kHEbbw1uceIk3jWHqgX9vzFuR/CgzU5xbyTONTGqxdroY9g44rWZA+Tzmw20Ykj9KFVV7vvwpbqrH4q2Gx2mFZUlMQ30jojJeVLuk8rn1R9Dp/Btj9AN660E329Ur3XsrNzrNcqhA+gHaZHrdGF1sbX549r+rOYwKq9RqO/AptRCjdY1n9ITV8wp02ZchtY/AgwAM3YV79CKIEGAAAAAElFTkSuQmCC"},"wu/m":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkJFRDI1M0Q1NDE2NTExRTk4NTFFODEzNjdCN0UzRTFCIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkJFRDI1M0Q2NDE2NTExRTk4NTFFODEzNjdCN0UzRTFCIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QkVEMjUzRDM0MTY1MTFFOTg1MUU4MTM2N0I3RTNFMUIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QkVEMjUzRDQ0MTY1MTFFOTg1MUU4MTM2N0I3RTNFMUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4ZL3N5AAABQklEQVR42mJ0O3ueAQtgA+IAKLYEYikg/gXET4AYpGE9EG+EiqEAFiyGBQJxFxCrYLFEA4ojgfgOEJcD8TpkRUxIbGYg7oQqUGEgDEBq1kL1MGNzYRsQlzGQDmB6ypFdGEKmYciGhsAMBIVNPz7VvWqqYEwATACZBfJyKBDL4FOpw8NNjCulgTiMCZo0qAUCQAaaUtFAE5CXJbCFGTZv7jQygLOvfPnKUHzrNroSSSZsqZ0YwIhDHOTC50DMiyyIbjPMZe7nLhCy5znIhZeoGIZnQAZuoKKBG0AGroaWIjgBKAKuAjEB8BRkFgs0UoqAeBUulVhiExsoBOKfsLwMcmU3BV7thpqBUnxVAvEUMgybCtWLUR7+BeJcaKlxhwiD7kDLgRyoXpwlNqjQ3AxVDCq9jaEZHxbwZ6FVwGpsmQIgwAD7IEenGBpwRwAAAABJRU5ErkJggg=="},wzRw:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjRCRjg3MzVCREQ3QjExRThCOUEyRjhCMUJDMDQ5ODZDIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjRCRjg3MzVDREQ3QjExRThCOUEyRjhCMUJDMDQ5ODZDIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NEJGODczNTlERDdCMTFFOEI5QTJGOEIxQkMwNDk4NkMiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NEJGODczNUFERDdCMTFFOEI5QTJGOEIxQkMwNDk4NkMiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4w2ix1AAADFklEQVR42uxYWWsTURQ+k3UymTaZJmlrE7eipS+iUNGq0Jc++z8EwV3wxYL4IlZFBF/8L76IC6gvIohYaYs13SbbZJlJJsv4nbFFYmKb1iZWzYHLvcM9d+bL+c53ziWCZVm0G81Bu9S6wLrA/ltgrvePnu46UEcuTP7DVIYODkqBaOihT5EXXKLHFJwOy+F01Nw+b0lS5HnsPYCP3FFg+OgdbTGpafHkRSOdj1WKptuq1qhWrQllo+TR0/n92LucXUql4Ht3Szm2zSg5SnnjNT46xs8ev0jBaIikvh5yix4iQSAAo0IyRwBOZqHohu91ORKY8Mq+ieTcstkWYKWC8SKvamOCQ6DwoSFSYhGAqfdhsDyUvWHKxJOkzsQJZ05i6xnG+I5TGYyFb+dXtXEGFT06jA83gqozRA9nbF8+w+BA670dBQYKRbz4Bq8jiBRT16qxb+Rw1F4X1OylzQTRFFjfgYERuT/w0iN5DfxKiwdo0Y1MfqZSKrvsnGL6thpt5CGfrZhlJ94zvSVgCPN05mviI+g6Zeol0apZxAMJ7IPKYuzDebMhfRvQivfbS9MonW05+RkU1HON1/5wLyn7+knsley9YlYnyB40aCQPKNsuMX5QqmIu66WBloCBvtHMgnrVzqXhQc6n+hxRZHtYtRqSePvlD4XXnqvliqslKvELnnBh5Ej9DKqODcfvNQtWJhunB3cIsUdKQbW3fgkMBfO4nT+gr1PGgSjmdAU5PSX3B583pbJcNH08r+dUO21k8tganVXKLadI/bxI+dXMGa6RAHnzj9/HnG4nBVGgQ8N7vgtM0883UIkeZ6yrr9MWGForIXox2AAMzfUtz+kvq50PndC4+hExyXsOKrEKiSyl5lY6iovro934JTHdACw1v/KhZ1C5z+vE7BLF380SKj0rp32qrFTBkEqJmUX7WQxIj5tWfr4zofoLueX0FURO4Oh1ynBXe7OuyKaq5JYEpYyiib9CEy8KgtBWQL6AX0WZmMKt5cSmF0XQ+gnT6U5EytAK9mjQQ/ffni6wLrAusL8c2DcBBgBfbT0qlx9TDwAAAABJRU5ErkJggg=="},"xfX+":function(t,e,i){"use strict";var a=i("6zBA"),s=i("Ew9n"),n=i("F03V"),o=i("UEWd"),l=i("QJC7"),c=i("8KPp"),r=i("gd5k"),d=i("aQg/"),u=i("y9lt"),m=i("KzkL"),h=i("7Qib"),p=i("i68b"),f={name:"ContractFollow",components:{MixAdd:o.a,RecordLog:l.a,JournalLog:c.a,ExamineLog:r.a,TaskLog:d.a,ScheduleLog:u.a},mixins:[p.a],props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{sendLoading:!1,next_time:"",is_event:!1,logType:"record"}},computed:{logTypes:function(){return this.oa?[{type:"record",name:"跟进记录"},{type:"log",name:"日志"},{type:"examine",name:"审批"},{type:"task",name:"任务"},{type:"schedule",name:"日程"}]:[{type:"record",name:"跟进记录"}]},componentsName:function(){return"record"==this.logType?"RecordLog":"log"==this.logType?"JournalLog":"examine"==this.logType?"ExamineLog":"task"==this.logType?"TaskLog":"schedule"==this.logType?"ScheduleLog":""}},watch:{},mounted:function(){},activated:function(){},deactivated:function(){},methods:{handleTypeDrop:function(t){this.followType=t},logTabsClick:function(t,e){this.logType=t.type},sendInfo:function(){this.$refs.mixadd.$emit("submit-info")},submitInfo:function(t){var e=this;if(!this.is_event||this.next_time){var i={};i.types="crm_"+this.crmType,i.types_id=this.id,i.content=t.content,i.category=this.followType;var a=t.images.map(function(t,e,i){return t.file_id}),s=t.files.map(function(t,e,i){return t.file_id});i.file_id=a.concat(s),this.next_time&&(i.is_event=this.is_event?1:0,i.next_time=Object(h.d)(this.next_time)),this.sendLoading=!0,Object(m.l)(i).then(function(t){e.sendLoading=!1,e.$message.success(t.data),e.$refs.mixadd.resetInfo(),e.is_event=!1,e.next_time="",e.$bus.emit("follow-log-refresh",{type:"record-log"})}).catch(function(){e.sendLoading=!1})}else this.$message.error("请选择下次联系时间")}}},v=(i("6jE7"),i("KHd+")),g=Object(v.a)(f,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"f-container"},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sendLoading,expression:"sendLoading"}]},[i("mix-add",{ref:"mixadd",attrs:{"crm-type":t.crmType,id:t.id},on:{"mixadd-info":t.submitInfo}}),t._v(" "),i("flexbox",{staticClass:"se-section"},[i("div",{staticClass:"se-name"},[t._v("记录类型")]),t._v(" "),i("el-dropdown",{staticStyle:{"margin-right":"20px"},attrs:{trigger:"click"},on:{command:t.handleTypeDrop}},[i("flexbox",{staticClass:"se-select"},[i("div",{staticClass:"se-select-name"},[t._v(t._s(t.followType?t.followType:"请选择"))]),t._v(" "),i("i",{staticClass:"el-icon-arrow-down el-icon--right",staticStyle:{color:"#ccc"}})]),t._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.followTypes,function(e,a){return i("el-dropdown-item",{key:a,attrs:{command:e.type}},[t._v(t._s(e.name))])}))],1),t._v(" "),i("div",{staticClass:"se-name"},[t._v("下次联系时间")]),t._v(" "),i("el-date-picker",{staticClass:"se-datepicker",attrs:{"default-value":new Date,editable:!1,type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:t.next_time,callback:function(e){t.next_time=e},expression:"next_time"}}),t._v(" "),t.showOAPermission?i("el-checkbox",{model:{value:t.is_event,callback:function(e){t.is_event=e},expression:"is_event"}},[t._v("添加到日程提醒")]):t._e(),t._v(" "),i("el-button",{staticClass:"se-send",attrs:{type:"primary"},nativeOn:{click:function(e){return t.sendInfo(e)}}},[t._v("发布")])],1)],1),t._v(" "),i("div",{staticClass:"log-cont"},[i("flexbox",{staticStyle:{"border-bottom":"1px solid #E6E6E6"}},t._l(t.logTypes,function(e,a){return i("flexbox",{key:a,staticStyle:{width:"auto"},nativeOn:{click:function(i){t.logTabsClick(e,a)}}},[i("div",{staticClass:"log-tabs-item",style:{color:t.logType==e.type?"#F18C70":"#777"}},[t._v(t._s(e.name))]),t._v(" "),t.logTypes.length-1!=a?i("div",{staticClass:"log-tabs-line"}):t._e()])})),t._v(" "),i("keep-alive",[i(t.componentsName,{tag:"component",attrs:{id:t.id,"crm-type":t.crmType}})],1)],1)])},[],!1,null,"1f0129cc",null);g.options.__file="ContractFollow.vue";var b=g.exports,y=i("U05J"),w=i("8DbX"),_=i("DUlf"),C=i("SE13"),A=i("+NTD"),I=i("C+sD"),D=i("3biH"),x=i("EgJF"),k=i("4+0Q"),R={name:"ContractDetail",components:{SlideView:s.a,CRMDetailHead:n.a,ContractFollow:b,CRMBaseInfo:y.a,RelativeHandle:w.a,RelativeTeam:_.a,RelativeProduct:C.a,RelativeReturnMoney:A.a,RelativeFiles:I.a,ExamineInfo:D.a,CRMCreateView:x.default},mixins:[k.a],props:{id:[String,Number],listenerIDs:{type:Array,default:function(){return["crm-main-container"]}},noListenerIDs:{type:Array,default:function(){return[]}},noListenerClass:{type:Array,default:function(){return["el-table__body"]}}},data:function(){return{loading:!1,crmType:"contract",isRefresh:!0,detailData:{},headDetails:[{title:"合同编号",value:""},{title:"客户名称",value:""},{title:"合同金额（元）",value:""},{title:"下单时间",value:""},{title:"回款金额（元）",value:""},{title:"负责人",value:""}],tabCurrentName:"followlog",isCreate:!1}},computed:{tabName:function(){return"followlog"==this.tabCurrentName?"contract-follow":"basicinfo"==this.tabCurrentName?"c-r-m-base-info":"team"==this.tabCurrentName?"relative-team":"contract"==this.tabCurrentName?"relative-contract":"operationlog"==this.tabCurrentName?"relative-handle":"product"==this.tabCurrentName?"relative-product":"returnedmoney"==this.tabCurrentName?"relative-return-money":"file"==this.tabCurrentName?"relative-files":""},tabnames:function(){var t=[];return t.push({label:"跟进记录",name:"followlog"}),this.crm.contract&&this.crm.contract.read&&t.push({label:"基本信息",name:"basicinfo"}),this.crm.product&&this.crm.product.index&&t.push({label:"产品",name:"product"}),this.crm.receivables&&this.crm.receivables.index&&t.push({label:"回款信息",name:"returnedmoney"}),t.push({label:"相关团队",name:"team"}),t.push({label:"附件",name:"file"}),t.push({label:"操作记录",name:"operationlog"}),t}},mounted:function(){},methods:{getDetial:function(){var t=this;this.loading=!0,Object(a.g)({id:this.id}).then(function(e){t.loading=!1,t.detailData=e.data,t.headDetails[0].value=e.data.num,t.headDetails[1].value=e.data.customer_id_info?e.data.customer_id_info.name:"",t.headDetails[2].value=t.moneyFormat(e.data.money),t.headDetails[3].value="0000-00-00"==e.data.order_date?"":e.data.order_date,t.headDetails[4].value=t.moneyFormat(e.data.receivablesMoney.doneMoney),t.headDetails[5].value=e.data.owner_user_id_info?e.data.owner_user_id_info.realname:""}).catch(function(e){e&&102==e.code&&(t.hasRequestAuth=!1),t.loading=!1})},hideView:function(){this.$emit("hide-view")},handleClick:function(t,e){},editSaveSuccess:function(){this.$emit("handle",{type:"save-success"}),this.isRefresh=!this.isRefresh,this.getDetial()},examineCellHandle:function(t){t&&this.getDetial()}}},T=(i("m8oD"),Object(v.a)(R,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("slide-view",{directives:[{name:"empty",rawName:"v-empty",value:!t.canShowDetail,expression:"!canShowDetail"}],attrs:{"listener-ids":t.listenerIDs,"no-listener-ids":t.noListenerIDs,"no-listener-class":t.noListenerClass,"body-style":{padding:0,height:"100%"},"xs-empty-icon":"nopermission","xs-empty-text":"暂无权限"},on:{"side-close":t.hideView}},[t.canShowDetail?i("flexbox",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"d-container",attrs:{direction:"column",align:"stretch"}},[i("c-r-m-detail-head",{attrs:{detail:t.detailData,"head-details":t.headDetails,id:t.id,"crm-type":"contract"},on:{handle:t.detailHeadHandle,close:t.hideView}}),t._v(" "),i("div",{staticClass:"examine-info"},[i("examine-info",{staticClass:"examine-info-border",attrs:{id:t.id,refresh:t.isRefresh,flow_id:t.detailData.flow_id,"examine-type":"crm_contract"},on:{"on-handle":t.examineCellHandle}})],1),t._v(" "),i("div",{staticClass:"tabs"},[i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.tabCurrentName,callback:function(e){t.tabCurrentName=e},expression:"tabCurrentName"}},t._l(t.tabnames,function(t,e){return i("el-tab-pane",{key:e,attrs:{label:t.label,name:t.name}})}))],1),t._v(" "),i("div",{staticClass:"t-loading-content",attrs:{id:"follow-log-content"}},[i("keep-alive",[i(t.tabName,{tag:"component",attrs:{detail:t.detailData,id:t.id,"crm-type":"contract"}})],1)],1)],1):t._e(),t._v(" "),t.isCreate?i("c-r-m-create-view",{attrs:{action:{type:"update",id:t.id},"crm-type":"contract"},on:{"save-success":t.editSaveSuccess,"hiden-view":function(e){t.isCreate=!1}}}):t._e()],1)},[],!1,null,"2de3ab41",null));T.options.__file="ContractDetail.vue";e.a=T.exports},y4JV:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTggKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMwMDM5QTNCNDE2NTExRTk5ODY1RTZGN0EwMzg2MEE4IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMwMDM5QTNDNDE2NTExRTk5ODY1RTZGN0EwMzg2MEE4Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzAwMzlBMzk0MTY1MTFFOTk4NjVFNkY3QTAzODYwQTgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzAwMzlBM0E0MTY1MTFFOTk4NjVFNkY3QTAzODYwQTgiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5ZqqPOAAAB00lEQVR42mJ0O3ueAQtgA+IAKLYEYikg/gXET4AYpGE9EG+EiqEAFiyGBQJxFxCrYLFEA4ojgfgOEJcD8TpkRUxIbGYg7oQqUGEgDEBq1kL1MGNzYRsQlzGQDmB6ypFdGEKmYciGhsAMBIVNPwPlYALILJCBoUAsQwUDpYE4jAmaNEgCMuzsDHO0NBh61DDiLgBkoCkphqlycTH0qqsyyHJwMPz69x9d2gRkoARGYAA1TNdUZxBjY0MRN+TlZehWVWEQYGFhOP7xI0PjvfvoWiWZsKV2kMVKnJwM/UCDFTg5wGK2AgIMLSpKDJzMTAw7375jaLr3gOHnv38YPmAEZr2bQFoNWZCTiYmhVkmRwZiPl+HL378MO968ZQgSE2VgYmRkWPXyFcO8p88Y/mMPkYcgF15CF/0OtLnu7j2Gg+8/MPAwMzOEiIsxMAINm/XkKcNc3IaBwBmQgRuwyfz5/5+h/f4DhvWvXoNd2f3gEcNaIJsA2ADyMijk71IhLT4FYmVYpBRRIWEXAvFPWF5eDcTdFBjWDTUDpfiqBOIpZBg2FaoXozz8C8S50FLjDhEG3YGWAzlQvThLbFChuRmqGFR6G0MzPizgz0KrgNXYMgVAgAEAQ6R42TeJ/UsAAAAASUVORK5CYII="},y9lt:function(t,e,i){"use strict";var a=i("FyfS"),s=i.n(a),n=i("KzkL"),o={name:"FollowScheduleCell",components:{},filters:{getRemindtypeText:function(t){switch(t){case 0:return"无";case 1:return"准时提醒";case 2:return"5分钟前";case 3:return"15分钟前";case 4:return"30分钟前";case 5:return"一个小时前";case 6:return"二个小时前";case 7:return"一天前";case 8:return"二天前";case 9:return"一周前"}return""}},props:{data:Object},data:function(){return{}},computed:{},mounted:function(){},methods:{checkRelatedDetail:function(t,e){this.$emit("on-handle",{type:"related-detail",data:{type:t,item:e}})},handleCommand:function(t){this.$emit("on-handle",{type:t,data:{item:this.data}})}}},l=(i("UHbi"),i("KHd+")),c=Object(l.a)(o,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fl-c"},[a("flexbox",{staticClass:"fl-h"},[a("div",{directives:[{name:"photo",rawName:"v-photo",value:t.data.create_user_info,expression:"data.create_user_info"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(t.data.create_user_info.thumb_img),expression:"$options.filters.filterUserLazyImg(data.create_user_info.thumb_img)",arg:"background-image"}],key:t.data.create_user_info.thumb_img,staticClass:"div-photo fl-h-img"}),t._v(" "),a("div",{staticClass:"fl-h-b"},[a("div",{staticClass:"fl-h-name"},[t._v(t._s(t.data.create_user_info.realname))]),t._v(" "),a("div",{staticClass:"fl-h-time"},[t._v(t._s(t._f("filterTimestampToFormatTime")(t.data.create_time)))])]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("i",{staticClass:"el-icon-arrow-down el-icon-more",staticStyle:{color:"#CDCDCD"}}),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"edit"}},[t._v("编辑")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"delete"}},[t._v("删除")])],1)],1)],1),t._v(" "),a("div",{staticClass:"fl-b"},[a("div",[a("div",{staticClass:"state-color",style:{"background-color":t.data.color?t.data.color:"#fff"}}),t._v(t._s(t.data.title)+"\n    ")]),t._v(" "),a("div",{staticClass:"fl-b-des"},[a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("参与人：")]),t._v(" "),a("div",{staticClass:"owner-list"},t._l(t.data.ownerList,function(e,i){return a("span",{key:i},[a("el-tooltip",{attrs:{placement:"bottom",effect:"light","popper-class":"tooltip-change-border"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("span",[t._v(t._s(e.realname))])]),t._v(" "),a("div",{directives:[{name:"photo",rawName:"v-photo",value:e,expression:"k"},{name:"lazy",rawName:"v-lazy:background-image",value:t.$options.filters.filterUserLazyImg(e.thumb_img),expression:"$options.filters.filterUserLazyImg(k.thumb_img)",arg:"background-image"}],key:e.thumb_img,staticClass:"div-photo header-circle"})])],1)}))]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("开始时间：")]),t._v(" "),a("div",[t._v(t._s(t._f("moment")(t.data.start_time,"YYYY-MM-DD HH:mm:ss")))])]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("结束时间：")]),t._v(" "),a("div",[t._v(t._s(t._f("moment")(t.data.end_time,"YYYY-MM-DD HH:mm:ss")))])]),t._v(" "),a("flexbox",{staticClass:"fl-b-des-item"},[a("div",{staticClass:"fl-b-des-item-name"},[t._v("备注：")]),t._v(" "),a("div",[t._v(t._s(t.data.remark))])])],1),t._v(" "),t.data.contactsList.length>0||t.data.customerList.length>0||t.data.businessList.length>0||t.data.contractList.length>0?a("div",{staticClass:"related-business"},[a("div",{staticClass:"label"},[t._v("关联业务")]),t._v(" "),t._l(t.data.contactsList,function(e,s){return a("p",{key:"contacts"+s,on:{click:function(i){t.checkRelatedDetail("contacts",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        联系人-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.customerList,function(e,s){return a("p",{key:"customer"+s,on:{click:function(i){t.checkRelatedDetail("customer",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        客户-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.businessList,function(e,s){return a("p",{key:"business"+s,on:{click:function(i){t.checkRelatedDetail("business",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        商机-"+t._s(e.name)+"\n      ")])}),t._v(" "),t._l(t.data.contractList,function(e,s){return a("p",{key:"contract"+s,on:{click:function(i){t.checkRelatedDetail("contract",e)}}},[a("img",{attrs:{src:i("AFlK"),alt:""}}),t._v("\n        合同-"+t._s(e.name)+"\n      ")])})],2):t._e()])],1)},[],!1,null,"9d312f0a",null);c.options.__file="FollowScheduleCell.vue";var r=c.exports,d=i("Dh/N"),u=i("BuGm"),m=i("7Qib"),h={name:"ScheduleLog",components:{FollowScheduleCell:r,CRMFullScreenDetail:function(){return Promise.all([i.e("chunk-11a6"),i.e("chunk-e347"),i.e("chunk-f93a")]).then(i.bind(null,"uMjE"))},CreateSchedule:u.default},props:{id:[String,Number],crmType:{type:String,default:""}},data:function(){return{loading:!1,loadMoreLoading:!0,isPost:!1,page:1,list:[],showFullDetail:!1,detailCRMType:"",rowID:"",showDialog:!1,formData:{checkList:[]},newtext:""}},computed:{},watch:{id:function(t){this.refreshList()}},mounted:function(){var t=this,e=document.getElementById("follow-log-content");e.onscroll=function(){var i=e.scrollTop+e.clientHeight-e.scrollHeight;Math.abs(i)<10&&1==t.loadMoreLoading&&(t.isPost?t.loadMoreLoading=!1:(t.isPost=!0,t.page++,t.getList()))},this.getList()},activated:function(){},deactivated:function(){},methods:{getList:function(){var t=this;this.loading=!0,Object(n.k)({page:this.page,limit:10,types:"crm_"+this.crmType,types_id:this.id,by:"event"}).then(function(e){t.list=t.list.concat(e.data.list),e.data.list.length<10?t.loadMoreLoading=!1:t.loadMoreLoading=!0,t.loading=!1,t.isPost=!1}).catch(function(){t.isPost=!1,t.loading=!1})},refreshList:function(){this.page=1,this.list=[],this.getList()},examineCellHandle:function(t){var e=this;if("edit"==t.type){this.newText="编辑日程";var i=t.data.item;i.start_time=Object(m.e)(i.start_time),i.end_time=Object(m.e)(i.end_time),i.owner_user_ids=[];var a=!0,n=!1,o=void 0;try{for(var l,c=s()(i.ownerList);!(a=(l=c.next()).done);a=!0){var r=l.value;i.owner_user_ids.push(r.owner_id)}}catch(t){n=!0,o=t}finally{try{!a&&c.return&&c.return()}finally{if(n)throw o}}this.formData=i,this.showDialog=!0}else"delete"==t.type?this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(d.b)({event_id:t.data.item.event_id}).then(function(t){e.refreshList(),e.$message({type:"success",message:"删除成功!"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})}):"related-detail"==t.type&&(this.rowID=t.data.item[t.data.type+"_id"],this.detailCRMType=t.data.type,this.showFullDetail=!0)},onSubmit:function(t,e){this.refreshList(),"创建日程"==this.newText?(this.$message.success("新建成功"),this.showDialog=!1):(this.$message.success("编辑成功"),this.showDialog=!1)}}},p=(i("2P4K"),Object(l.a)(h,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},[i("div",{directives:[{name:"empty",rawName:"v-empty",value:0===t.list.length,expression:"list.length === 0"}]},[i("div",{staticClass:"log-items"},[t._l(t.list,function(e,a){return i("follow-schedule-cell",{key:a,attrs:{data:e.dataInfo},on:{"on-handle":t.examineCellHandle}})}),t._v(" "),i("div",{staticClass:"load"},[i("el-button",{attrs:{loading:t.loadMoreLoading,type:"text"}},[t._v(t._s(t.loadMoreLoading?"加载更多":"没有更多了"))])],1)],2)]),t._v(" "),i("c-r-m-full-screen-detail",{attrs:{visible:t.showFullDetail,"crm-type":t.detailCRMType,id:t.rowID},on:{"update:visible":function(e){t.showFullDetail=e}}}),t._v(" "),t.showDialog?i("create-schedule",{attrs:{text:t.newText,"form-data":t.formData,"append-to-body":!0},on:{onSubmit:t.onSubmit,closeDialog:function(e){t.showDialog=!1}}}):t._e()],1)},[],!1,null,"50a649f8",null));p.options.__file="ScheduleLog.vue";e.a=p.exports},zBZy:function(t,e,i){"use strict";var a=i("GJP/");i.n(a).a},"zxr/":function(t,e,i){}}]);